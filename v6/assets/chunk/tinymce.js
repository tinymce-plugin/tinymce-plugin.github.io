var w6=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},I8={exports:{}};(function(x0){(function(){var Od=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},N0=function(e){return["undefined","boolean","number","string","function","xml","null"].indexOf(e)!==-1},_0=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},A0=function(e,t){return er(function(n,s){return e.eq(t(n),t(s))})},er=function(e){return{eq:e}},R0=er(function(e,t){return e===t}),T0=R0,$d=function(e){return er(function(t,n){if(t.length!==n.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},P0=function(e,t){return A0($d(e),function(n){return _0(n,t)})},Ld=function(e){return er(function(t,n){var s=Object.keys(t),o=Object.keys(n);if(!P0(T0).eq(s,o))return!1;for(var r=s.length,a=0;a<r;a++){var i=s[a];if(!e.eq(t[i],n[i]))return!1}return!0})},kl=er(function(e,t){if(e===t)return!0;var n=Od(e),s=Od(t);return n!==s?!1:N0(n)?e===t:n==="array"?$d(kl).eq(e,t):n==="object"?Ld(kl).eq(e,t):!1});const D0=Object.getPrototypeOf,Id=(e,t,n)=>{var s;return n(e,t.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},B0=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&Id(e,String,(n,s)=>s.isPrototypeOf(n))?"string":t},xl=e=>t=>B0(t)===e,Nl=e=>t=>typeof t===e,Fd=e=>t=>e===t,ba=(e,t)=>Ot(e)&&Id(e,t,(n,s)=>D0(n)===s),ne=xl("string"),Ot=xl("object"),Md=e=>ba(e,Object),Ge=xl("array"),tr=Fd(null),Ss=Nl("boolean"),kt=Fd(void 0),xt=e=>e==null,oe=e=>!xt(e),_e=Nl("function"),yn=Nl("number"),ao=(e,t)=>{if(Ge(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},me=()=>{},ws=(e,t)=>(...n)=>e(t.apply(null,n)),Ud=(e,t)=>n=>e(t(n)),F=e=>()=>e,bt=e=>e,O0=(e,t)=>e===t;function V(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const _l=e=>t=>!e(t),$0=e=>()=>{throw new Error(e)},Al=e=>e(),nr=e=>{e()},Le=F(!1),je=F(!0);class d{constructor(t,n){this.tag=t,this.value=n}static some(t){return new d(!0,t)}static none(){return d.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?d.some(t(this.value)):d.none()}bind(t){return this.tag?t(this.value):d.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:d.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t!=null?t:"Called getOrDie on None")}static from(t){return oe(t)?d.some(t):d.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}d.singletonNone=new d(!1);const Rl=Array.prototype.slice,L0=Array.prototype.indexOf,I0=Array.prototype.push,zd=(e,t)=>L0.call(e,t),F0=(e,t)=>{const n=zd(e,t);return n===-1?d.none():d.some(n)},De=(e,t)=>zd(e,t)>-1,Me=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},Ee=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const r=e[o];s[o]=t(r,o)}return s},B=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},Hd=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},sr=(e,t)=>{const n=[],s=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];(t(a,o)?n:s).push(a)}return{pass:n,fail:s}},re=(e,t)=>{const n=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];t(r,s)&&n.push(r)}return n},Ca=(e,t,n)=>(Hd(e,(s,o)=>{n=t(n,s,o)}),n),$t=(e,t,n)=>(B(e,(s,o)=>{n=t(n,s,o)}),n),Vd=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++){const r=e[s];if(t(r,s))return d.some(r);if(n(r,s))break}return d.none()},Ye=(e,t)=>Vd(e,t,Le),or=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return d.some(n)}return d.none()},Wd=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!Ge(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);I0.apply(t,e[n])}return t},Un=(e,t)=>Wd(Ee(e,t)),io=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},rr=e=>{const t=Rl.call(e,0);return t.reverse(),t},Tl=(e,t)=>re(e,n=>!De(t,n)),Pl=(e,t)=>{const n={};for(let s=0,o=e.length;s<o;s++){const r=e[s];n[String(r)]=t(r,s)}return n},ar=(e,t)=>{const n=Rl.call(e,0);return n.sort(t),n},Dl=(e,t)=>t>=0&&t<e.length?d.some(e[t]):d.none(),Lt=e=>Dl(e,0),lo=e=>Dl(e,e.length-1),Nt=_e(Array.from)?Array.from:e=>Rl.call(e),co=(e,t)=>{for(let n=0;n<e.length;n++){const s=t(e[n],n);if(s.isSome())return s}return d.none()},M0=(e,t)=>{const n=[],s=_e(t)?o=>Me(n,r=>t(r,o)):o=>De(n,o);for(let o=0,r=e.length;o<r;o++){const a=e[o];s(a)||n.push(a)}return n},Xt=Object.keys,U0=Object.hasOwnProperty,Pe=(e,t)=>{const n=Xt(e);for(let s=0,o=n.length;s<o;s++){const r=n[s],a=e[r];t(a,r)}},ir=(e,t)=>z0(e,(n,s)=>({k:s,v:t(n,s)})),z0=(e,t)=>{const n={};return Pe(e,(s,o)=>{const r=t(s,o);n[r.k]=r.v}),n},Bl=e=>(t,n)=>{e[n]=t},jd=(e,t,n,s)=>{const o={};return Pe(e,(r,a)=>{(t(r,a)?n:s)(r,a)}),o},H0=(e,t)=>{const n={},s={};return jd(e,t,Bl(n),Bl(s)),{t:n,f:s}},lr=(e,t)=>{const n={};return jd(e,t,Bl(n),me),n},Ol=(e,t)=>{const n=[];return Pe(e,(s,o)=>{n.push(t(s,o))}),n},$l=e=>Ol(e,bt),Te=(e,t)=>fe(e,t)?d.from(e[t]):d.none(),fe=(e,t)=>U0.call(e,t),uo=(e,t)=>fe(e,t)&&e[t]!==void 0&&e[t]!==null,V0=(e,t,n=kl)=>Ld(n).eq(e,t),qd=e=>{const t={};return B(e,n=>{t[n]={}}),Xt(t)},Ll=Array.isArray,W0=e=>{if(Ll(e))return e;{const t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t}},cr=(e,t,n)=>{let s,o;if(!e)return!1;if(n=n||e,e.length!==void 0){for(s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e)===!1)return!1}else for(s in e)if(fe(e,s)&&t.call(n,e[s],s,e)===!1)return!1;return!0},Il=(e,t)=>{const n=[];return cr(e,(s,o)=>{n.push(t(s,o,e))}),n},fo=(e,t)=>{const n=[];return cr(e,(s,o)=>{(!t||t(s,o,e))&&n.push(s)}),n},Kd=(e,t)=>{if(e){for(let n=0,s=e.length;n<s;n++)if(e[n]===t)return n}return-1},ya=(e,t,n,s)=>{let o=kt(n)?e[0]:n;for(let r=0;r<e.length;r++)o=t.call(s,o,e[r],r);return o},Gd=(e,t,n)=>{let s,o;for(s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e))return s;return-1},ts=e=>e[e.length-1],ks=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},j0=(e,t,n,s)=>{const o=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),i=a||s("(pointer:coarse)"),l=o||!r&&a&&s("(min-device-width:768px)"),c=r||a&&!l,u=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,f=!c&&!l&&!u;return{isiPad:F(o),isiPhone:F(r),isTablet:F(l),isPhone:F(c),isTouch:F(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:F(u),isDesktop:F(f)}},q0=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},K0=(e,t)=>{const n=q0(e,t);if(!n)return{major:0,minor:0};const s=o=>Number(t.replace(n,"$"+o));return Fl(s(1),s(2))},G0=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?Yd():K0(e,n)},Yd=()=>Fl(0,0),Fl=(e,t)=>({major:e,minor:t}),ur={nu:Fl,detect:G0,unknown:Yd},Y0=(e,t)=>co(t.brands,n=>{const s=n.brand.toLowerCase();return Ye(e,o=>{var r;return s===((r=o.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(o=>({current:o.name,version:ur.nu(parseInt(n.version,10),0)}))}),Xd=(e,t)=>{const n=String(t).toLowerCase();return Ye(e,s=>s.search(n))},X0=(e,t)=>Xd(e,t).map(n=>{const s=ur.detect(n.versionRegexes,t);return{current:n.name,version:s}}),Q0=(e,t)=>Xd(e,t).map(n=>{const s=ur.detect(n.versionRegexes,t);return{current:n.name,version:s}}),Z0=(e,t)=>e.substring(t),Qd=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,J0=(e,t)=>st(e,t)?Z0(e,t.length):e,ft=(e,t)=>e.indexOf(t)!==-1,st=(e,t)=>Qd(e,t,0),Zd=(e,t)=>Qd(e,t,e.length-t.length),Ml=e=>t=>t.replace(e,""),mo=Ml(/^\s+|\s+$/g),ew=Ml(/^\s+/g),Jd=Ml(/\s+$/g),zn=e=>e.length>0,va=e=>!zn(e),tw=(e,t)=>t<=0?"":new Array(t+1).join(e),nw=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?d.none():d.some(n)},Ul=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Hn=e=>t=>ft(t,e),sw=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>ft(e,"edge/")&&ft(e,"chrome")&&ft(e,"safari")&&ft(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ul],search:e=>ft(e,"chrome")&&!ft(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>ft(e,"msie")||ft(e,"trident")},{name:"Opera",versionRegexes:[Ul,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Hn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Hn("firefox")},{name:"Safari",versionRegexes:[Ul,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(ft(e,"safari")||ft(e,"mobile/"))&&ft(e,"applewebkit")}],ow=[{name:"Windows",search:Hn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>ft(e,"iphone")||ft(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Hn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Hn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Hn("linux"),versionRegexes:[]},{name:"Solaris",search:Hn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Hn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Hn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],em={browsers:F(sw),oses:F(ow)},tm="Edge",nm="Chromium",sm="IE",om="Opera",rm="Firefox",am="Safari",rw=()=>im({current:void 0,version:ur.unknown()}),im=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isEdge:s(tm),isChromium:s(nm),isIE:s(sm),isOpera:s(om),isFirefox:s(rm),isSafari:s(am)}},lm={unknown:rw,nu:im,edge:F(tm),chromium:F(nm),ie:F(sm),opera:F(om),firefox:F(rm),safari:F(am)},cm="Windows",um="iOS",fm="Android",dm="Linux",mm="macOS",gm="Solaris",pm="FreeBSD",hm="ChromeOS",aw=()=>bm({current:void 0,version:ur.unknown()}),bm=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isWindows:s(cm),isiOS:s(um),isAndroid:s(fm),isMacOS:s(mm),isLinux:s(dm),isSolaris:s(gm),isFreeBSD:s(pm),isChromeOS:s(hm)}},Cm={unknown:aw,nu:bm,windows:F(cm),ios:F(um),android:F(fm),linux:F(dm),macos:F(mm),solaris:F(gm),freebsd:F(pm),chromeos:F(hm)},iw={detect:(e,t,n)=>{const s=em.browsers(),o=em.oses(),r=t.bind(l=>Y0(s,l)).orThunk(()=>X0(s,e)).fold(lm.unknown,lm.nu),a=Q0(o,e).fold(Cm.unknown,Cm.nu),i=j0(a,r,e,n);return{browser:r,os:a,deviceType:i}}},lw=e=>window.matchMedia(e).matches;let cw=ks(()=>iw.detect(navigator.userAgent,d.from(navigator.userAgentData),lw));const xs=()=>cw(),uw=navigator.userAgent,zl=xs(),vn=zl.browser,En=zl.os,Ns=zl.deviceType,fw=uw.indexOf("Windows Phone")!==-1,Se={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:vn.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!vn.isIE(),windowsPhone:fw,browser:{current:vn.current,version:vn.version,isChromium:vn.isChromium,isEdge:vn.isEdge,isFirefox:vn.isFirefox,isIE:vn.isIE,isOpera:vn.isOpera,isSafari:vn.isSafari},os:{current:En.current,version:En.version,isAndroid:En.isAndroid,isChromeOS:En.isChromeOS,isFreeBSD:En.isFreeBSD,isiOS:En.isiOS,isLinux:En.isLinux,isMacOS:En.isMacOS,isSolaris:En.isSolaris,isWindows:En.isWindows},deviceType:{isDesktop:Ns.isDesktop,isiPad:Ns.isiPad,isiPhone:Ns.isiPhone,isPhone:Ns.isPhone,isTablet:Ns.isTablet,isTouch:Ns.isTouch,isWebView:Ns.isWebView}},dw=/^\s*|\s*$/g,ym=e=>e==null?"":(""+e).replace(dw,""),vm=(e,t)=>t?t==="array"&&Ll(e)?!0:typeof e===t:e!==void 0,mw=(e,t,n)=>{let s;for(e=e||[],t=t||",",typeof e=="string"&&(e=e.split(t)),n=n||{},s=e.length;s--;)n[e[s]]={};return n},gw=fe,pw=(e,...t)=>{for(let n=0;n<t.length;n++){const s=t[n];for(const o in s)if(fe(s,o)){const r=s[o];r!==void 0&&(e[o]=r)}}return e},Em=function(e,t,n,s){s=s||this,e&&(n&&(e=e[n]),cr(e,(o,r)=>{if(t.call(s,o,r,n)===!1)return!1;Em(o,t,n,s)}))},D={trim:ym,isArray:Ll,is:vm,toArray:W0,makeMap:mw,each:cr,map:Il,grep:fo,inArray:Kd,hasOwn:gw,extend:pw,walk:Em,resolve:(e,t)=>{let n,s;for(t=t||window,e=e.split("."),n=0,s=e.length;n<s&&(t=t[e[n]],!!t);n++);return t},explode:(e,t)=>!e||vm(e,"array")?e:Il(e.split(t||","),ym),_addCacheSuffix:e=>{const t=Se.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},go=(e,t,n=O0)=>e.exists(s=>n(s,t)),hw=e=>{const t=[],n=s=>{t.push(s)};for(let s=0;s<e.length;s++)e[s].each(n);return t},_t=(e,t,n)=>e.isSome()&&t.isSome()?d.some(n(e.getOrDie(),t.getOrDie())):d.none(),bw=(e,t,n,s)=>e.isSome()&&t.isSome()&&n.isSome()?d.some(s(e.getOrDie(),t.getOrDie(),n.getOrDie())):d.none(),Hl=(e,t)=>e?d.some(t):d.none();typeof window!="undefined"||Function("return this;")();const Sm=8,wm=9,km=11,fr=1,xm=3,Be=e=>e.dom.nodeName.toLowerCase(),Nm=e=>e.dom.nodeType,Ea=e=>t=>Nm(t)===e,Cw=e=>Nm(e)===Sm||Be(e)==="#comment",Qt=Ea(fr),Ut=Ea(xm),yw=Ea(wm),vw=Ea(km),_m=e=>t=>Qt(t)&&Be(t)===e,Am=(e,t,n)=>{if(ne(n)||Ss(n)||yn(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},ot=(e,t,n)=>{Am(e.dom,t,n)},Sn=(e,t)=>{const n=e.dom;Pe(t,(s,o)=>{Am(n,o,s)})},zt=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},po=(e,t)=>d.from(zt(e,t)),dr=(e,t)=>{const n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},rt=(e,t)=>{e.dom.removeAttribute(t)},Ew=e=>{const t=e.dom.attributes;return t==null||t.length===0},Rm=e=>$t(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Vl=(e,t)=>{const n=zt(e,t);return n===void 0||n===""?[]:n.split(" ")},Sw=(e,t,n)=>{const o=Vl(e,t).concat([n]);return ot(e,t,o.join(" ")),!0},ww=(e,t,n)=>{const s=re(Vl(e,t),o=>o!==n);return s.length>0?ot(e,t,s.join(" ")):rt(e,t),!1},mr=e=>e.dom.classList!==void 0,Tm=e=>Vl(e,"class"),Pm=(e,t)=>Sw(e,"class",t),Dm=(e,t)=>ww(e,"class",t),kw=(e,t)=>De(Tm(e),t)?Dm(e,t):Pm(e,t),gr=(e,t)=>{mr(e)?e.dom.classList.add(t):Pm(e,t)},Bm=e=>{(mr(e)?e.dom.classList:Tm(e)).length===0&&rt(e,"class")},Sa=(e,t)=>{mr(e)?e.dom.classList.remove(t):Dm(e,t),Bm(e)},xw=(e,t)=>{const n=mr(e)?e.dom.classList.toggle(t):kw(e,t);return Bm(e),n},Wl=(e,t)=>mr(e)&&e.dom.classList.contains(t),pr=e=>e.style!==void 0&&_e(e.style.getPropertyValue),Nw=(e,t)=>{const s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return hr(s.childNodes[0])},_w=(e,t)=>{const s=(t||document).createElement(e);return hr(s)},Aw=(e,t)=>{const s=(t||document).createTextNode(e);return hr(s)},hr=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},C={fromHtml:Nw,fromTag:_w,fromText:Aw,fromDom:hr,fromPoint:(e,t,n)=>d.from(e.dom.elementFromPoint(t,n)).map(hr)},Om=(e,t)=>{const n=[],s=r=>(n.push(r),t(r));let o=t(e);do o=o.bind(s);while(o.isSome());return n},wn=(e,t)=>{const n=e.dom;if(n.nodeType!==fr)return!1;{const s=n;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},$m=e=>e.nodeType!==fr&&e.nodeType!==wm&&e.nodeType!==km||e.childElementCount===0,Rw=(e,t)=>{const n=t===void 0?document:t.dom;return $m(n)?[]:Ee(n.querySelectorAll(e),C.fromDom)},Tw=(e,t)=>{const n=t===void 0?document:t.dom;return $m(n)?d.none():d.from(n.querySelector(e)).map(C.fromDom)},Ae=(e,t)=>e.dom===t.dom,Vn=(e,t)=>{const n=e.dom,s=t.dom;return n===s?!1:n.contains(s)},Lm=e=>C.fromDom(e.dom.ownerDocument),ns=e=>yw(e)?e:Lm(e),Pw=e=>C.fromDom(ns(e).dom.documentElement),Im=e=>C.fromDom(ns(e).dom.defaultView),Zt=e=>d.from(e.dom.parentNode).map(C.fromDom),Dw=e=>d.from(e.dom.parentElement).map(C.fromDom),Bw=(e,t)=>{const n=_e(t)?t:Le;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const r=s.parentNode,a=C.fromDom(r);if(o.push(a),n(a)===!0)break;s=r}return o},Ow=e=>{const t=n=>re(n,s=>!Ae(e,s));return Zt(e).map(at).map(t).getOr([])},_s=e=>d.from(e.dom.previousSibling).map(C.fromDom),br=e=>d.from(e.dom.nextSibling).map(C.fromDom),Fm=e=>rr(Om(e,_s)),Mm=e=>Om(e,br),at=e=>Ee(e.dom.childNodes,C.fromDom),wa=(e,t)=>{const n=e.dom.childNodes;return d.from(n[t]).map(C.fromDom)},Um=e=>wa(e,0),jl=e=>wa(e,e.dom.childNodes.length-1),zm=e=>e.dom.childNodes.length,$w=e=>{const t=e.dom.head;if(t==null)throw new Error("Head is not available yet");return C.fromDom(t)},Hm=e=>vw(e)&&oe(e.dom.host),Vm=_e(Element.prototype.attachShadow)&&_e(Node.prototype.getRootNode),Lw=F(Vm),As=Vm?e=>C.fromDom(e.dom.getRootNode()):ns,ql=e=>Hm(e)?e:$w(ns(e)),Iw=e=>{const t=As(e);return Hm(t)?d.some(t):d.none()},Fw=e=>C.fromDom(e.dom.host),Wm=e=>{if(Lw()&&oe(e.target)){const t=C.fromDom(e.target);if(Qt(t)&&Mw(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return Lt(n)}}return d.from(e.target)},Mw=e=>oe(e.dom.shadowRoot),ho=e=>{const t=Ut(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return Iw(C.fromDom(t)).fold(()=>n.body.contains(t),Ud(ho,Fw))},jm=(e,t,n)=>{if(!ne(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);pr(e)&&e.style.setProperty(t,n)},Uw=(e,t)=>{pr(e)&&e.style.removeProperty(t)},qm=(e,t,n)=>{const s=e.dom;jm(s,t,n)},ka=(e,t)=>{const n=e.dom;Pe(t,(s,o)=>{jm(n,o,s)})},kn=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o===""&&!ho(e)?Km(n,t):o},Km=(e,t)=>pr(e)?e.style.getPropertyValue(t):"",xa=(e,t)=>{const n=e.dom,s=Km(n,t);return d.from(s).filter(o=>o.length>0)},Gm=e=>{const t={},n=e.dom;if(pr(n))for(let s=0;s<n.style.length;s++){const o=n.style.item(s);t[o]=n.style[o]}return t},Ym=(e,t)=>{const n=e.dom;Uw(n,t),go(po(e,"style").map(mo),"")&&rt(e,"style")},zw=e=>e.dom.offsetWidth,Jt=(e,t)=>{Zt(e).each(s=>{s.dom.insertBefore(t.dom,e.dom)})},ss=(e,t)=>{br(e).fold(()=>{Zt(e).each(o=>{qe(o,t)})},s=>{Jt(s,t)})},Xm=(e,t)=>{Um(e).fold(()=>{qe(e,t)},s=>{e.dom.insertBefore(t.dom,s.dom)})},qe=(e,t)=>{e.dom.appendChild(t.dom)},Hw=(e,t)=>{Jt(e,t),qe(t,e)},Vw=(e,t)=>{B(t,(n,s)=>{const o=s===0?e:t[s-1];ss(o,n)})},Rs=(e,t)=>{B(t,n=>{qe(e,n)})},Cr=e=>{e.dom.textContent="",B(at(e),t=>{Fe(t)})},Fe=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},Ts=e=>{const t=at(e);t.length>0&&Vw(e,t),Fe(e)},Ww=(e,t)=>{const s=(t||document).createElement("div");return s.innerHTML=e,at(C.fromDom(s))},jw=e=>Ee(e,C.fromDom),Qm=e=>e.dom.innerHTML,Kl=(e,t)=>{const s=Lm(e).dom,o=C.fromDom(s.createDocumentFragment()),r=Ww(t,s);Rs(o,r),Cr(e),qe(e,o)},qw=e=>{const t=C.fromTag("div"),n=C.fromDom(e.dom.cloneNode(!0));return qe(t,n),Qm(t)},Kw=(e,t,n,s,o,r,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:r,raw:a}),Gw=e=>{const t=C.fromDom(Wm(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),o=ws(s,n);return Kw(t,e.clientX,e.clientY,n,s,o,e)},Yw=(e,t)=>n=>{e(n)&&t(Gw(n))},Xw=(e,t,n,s,o)=>{const r=Yw(n,s);return e.dom.addEventListener(t,r,o),{unbind:V(Zw,e,t,r,o)}},Qw=(e,t,n,s)=>Xw(e,t,n,s,!1),Zw=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},Zm=(e,t)=>({left:e,top:t,translate:(s,o)=>Zm(e+s,t+o)}),bo=Zm,Jw=e=>{const t=e.getBoundingClientRect();return bo(t.left,t.top)},Na=(e,t)=>e!==void 0?e:t!==void 0?t:0,ek=e=>{const t=e.dom.ownerDocument,n=t.body,s=t.defaultView,o=t.documentElement;if(n===e.dom)return bo(n.offsetLeft,n.offsetTop);const r=Na(s==null?void 0:s.pageYOffset,o.scrollTop),a=Na(s==null?void 0:s.pageXOffset,o.scrollLeft),i=Na(o.clientTop,n.clientTop),l=Na(o.clientLeft,n.clientLeft);return Gl(e).translate(a-l,r-i)},Gl=e=>{const t=e.dom,s=t.ownerDocument.body;return s===t?bo(s.offsetLeft,s.offsetTop):ho(e)?Jw(t):bo(0,0)},Yl=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return bo(n,s)},Jm=(e,t,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(e,t)},eg=(e,t)=>{xs().browser.isSafari()&&_e(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},tk=e=>{const t=e===void 0?window:e;return xs().browser.isFirefox()?d.none():d.from(t.visualViewport)},tg=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),ng=e=>{const t=e===void 0?window:e,n=t.document,s=Yl(C.fromDom(n));return tk(t).fold(()=>{const o=t.document.documentElement,r=o.clientWidth,a=o.clientHeight;return tg(s.left,s.top,r,a)},o=>tg(Math.max(o.pageLeft,s.left),Math.max(o.pageTop,s.top),o.width,o.height))},Ps=e=>t=>!!t&&t.nodeType===e,_a=e=>!!e&&!Object.getPrototypeOf(e),Z=Ps(1),en=e=>{const t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const s=n.nodeName.toLowerCase();return De(t,s)}return!1}},Aa=(e,t)=>{const n=t.toLowerCase().split(" ");return s=>{if(Z(s))for(let o=0;o<n.length;o++){const r=s.ownerDocument.defaultView.getComputedStyle(s,null);if((r?r.getPropertyValue(e):null)===n[o])return!0}return!1}},sg=e=>t=>Z(t)&&t.hasAttribute(e),nk=(e,t)=>n=>Z(n)&&n.getAttribute(e)===t,Ds=e=>Z(e)&&e.hasAttribute("data-mce-bogus"),sk=e=>Z(e)&&e.getAttribute("data-mce-bogus")==="all",yr=e=>Z(e)&&e.tagName==="TABLE",og=e=>t=>!!(Z(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),Xl=en(["textarea","input"]),M=Ps(3),ok=Ps(4),rk=Ps(7),Ql=Ps(8),Zl=Ps(9),Jl=Ps(11),Ue=en(["br"]),rg=en(["img"]),xn=og("true"),Oe=og("false"),Ra=en(["td","th"]),Nn=en(["video","audio","object","embed"]),ak=xs().browser,ag=e=>Ye(e,Qt),ik=e=>ak.isFirefox()&&Be(e)==="table"?ag(at(e)).filter(t=>Be(t)==="caption").bind(t=>ag(Mm(t)).map(n=>{const s=n.dom.offsetTop,o=t.dom.offsetTop,r=t.dom.offsetHeight;return s<=o?-r:0})).getOr(0):0,ig=(e,t)=>e.children&&De(e.children,t),lk=(e,t,n)=>{let s=0,o=0;const r=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&kn(C.fromDom(e),"position")==="static"){const i=t.getBoundingClientRect();return s=i.left+(r.documentElement.scrollLeft||e.scrollLeft)-r.documentElement.clientLeft,o=i.top+(r.documentElement.scrollTop||e.scrollTop)-r.documentElement.clientTop,{x:s,y:o}}let a=t;for(;a&&a!==n&&a.nodeType&&!ig(a,n);){const i=a;s+=i.offsetLeft||0,o+=i.offsetTop||0,a=i.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!ig(a,n);)s-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=ik(C.fromDom(t))}return{x:s,y:o}};var lg=(e,t,n,s,o)=>e(n,s)?d.some(n):_e(o)&&o(n)?d.none():t(n,s,o);const Co=(e,t,n)=>{let s=e.dom;const o=_e(n)?n:Le;for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s);if(t(r))return d.some(r);if(o(r))break}return d.none()},yo=(e,t,n)=>lg((o,r)=>r(o),Co,e,t,n),ck=(e,t)=>{const n=e.dom;return n.parentNode?uk(C.fromDom(n.parentNode),s=>!Ae(e,s)&&t(s)):d.none()},uk=(e,t)=>{const n=o=>t(C.fromDom(o));return Ye(e.dom.childNodes,n).map(C.fromDom)},fk=(e,t)=>{const n=s=>{for(let o=0;o<s.childNodes.length;o++){const r=C.fromDom(s.childNodes[o]);if(t(r))return d.some(r);const a=n(s.childNodes[o]);if(a.isSome())return a}return d.none()};return n(e.dom)},vr=(e,t,n)=>Co(e,s=>wn(s,t),n),Er=(e,t)=>Tw(t,e),Bs=(e,t,n)=>lg((o,r)=>wn(o,r),vr,e,t,n),cg=(e,t={})=>{let n=0;const s={},o=C.fromDom(e),r=ns(o),a=t.maxLoadTime||5e3,i=p=>{t.referrerPolicy=p},l=p=>{qe(ql(o),p)},c=p=>{const b=ql(o);Er(b,"#"+p).each(Fe)},u=p=>Te(s,p).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),f=p=>new Promise((b,y)=>{let E;const S=D._addCacheSuffix(p),x=u(S);s[S]=x,x.count++;const _=(q,z)=>{B(q,nr),x.status=z,x.passed=[],x.failed=[],E&&(E.onload=null,E.onerror=null,E=null)},j=()=>_(x.passed,2),A=()=>_(x.failed,3),T=(q,z)=>{q()||(Date.now()-Q<a?setTimeout(z):A())},$=()=>{T(()=>{const q=e.styleSheets;let z=q.length;for(;z--;){const Ce=q[z].ownerNode;if(Ce&&Ce.id===E.id)return j(),!0}return!1},$)};if(b&&x.passed.push(b),y&&x.failed.push(y),x.status===1)return;if(x.status===2){j();return}if(x.status===3){A();return}x.status=1;const L=C.fromTag("link",r.dom);Sn(L,{rel:"stylesheet",type:"text/css",id:x.id});const Q=Date.now();t.contentCssCors&&ot(L,"crossOrigin","anonymous"),t.referrerPolicy&&ot(L,"referrerpolicy",t.referrerPolicy),E=L.dom,E.onload=$,E.onerror=A,l(L),ot(L,"href",S)}),m=p=>Promise.allSettled(Ee(p,y=>f(y).then(F(y)))).then(y=>{const E=sr(y,S=>S.status==="fulfilled");return E.fail.length>0?Promise.reject(Ee(E.fail,S=>S.reason)):Ee(E.pass,S=>S.value)}),g=p=>{const b=D._addCacheSuffix(p);Te(s,b).each(y=>{--y.count===0&&(delete s[b],c(y.id))})};return{load:f,loadAll:m,unload:g,unloadAll:p=>{B(p,b=>{g(b)})},_setReferrerPolicy:i}},ug=(()=>{const e=new WeakMap;return{forElement:(n,s)=>{const r=As(n).dom;return d.from(e.get(r)).getOrThunk(()=>{const a=cg(r,s);return e.set(r,a),a})}}})();class Ve{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,s,o){let r,a;if(t){if(!o&&t[n])return t[n];if(t!==this.rootNode){if(r=t[s],r)return r;for(a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(r=a[s],r)return r}}}findPreviousNode(t,n){let s,o,r;if(t){if(s=t.previousSibling,this.rootNode&&s===this.rootNode)return;if(s){if(!n){for(r=s.lastChild;r;r=r.lastChild)if(!r.lastChild)return r}return s}if(o=t.parentNode,o&&o!==this.rootNode)return o}}}const dk=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],mk=["td","th"],gk=["thead","tbody","tfoot"],pk=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],hk=["h1","h2","h3","h4","h5","h6"],bk=["li","dd","dt"],Ck=["ul","ol","dl"],yk=["pre","script","textarea","style"],vk=["pre"].concat(hk),os=e=>{let t;return n=>(t=t||Pl(e,je),fe(t,Be(n)))},sn=os(dk),Ek=e=>Be(e)==="table",ec=e=>Qt(e)&&!sn(e),vo=e=>Qt(e)&&Be(e)==="br",Sk=os(pk),tc=os(Ck),Sr=os(bk),wk=os(gk),Ta=os(mk),Pa=os(yk),kk=os(vk),xk=e=>kk(e)||ec(e),fg=(e,t,n)=>vr(e,t,n).isSome(),wr="\uFEFF",it="\xA0",dg=e=>e===wr,Nk=e=>e.replace(/\uFEFF/g,""),tt=wr,Da=dg,rs=Nk,_k=Z,Eo=M,So=e=>(Eo(e)&&(e=e.parentNode),_k(e)&&e.hasAttribute("data-mce-caret")),wo=e=>Eo(e)&&Da(e.data),Ht=e=>So(e)||wo(e),mg=e=>e.firstChild!==e.lastChild||!Ue(e.firstChild),Ak=(e,t)=>{const s=e.ownerDocument.createTextNode(tt),o=e.parentNode;if(t){const r=e.previousSibling;if(Eo(r)){if(Ht(r))return r;if(Oa(r))return r.splitText(r.data.length-1)}o.insertBefore(s,e)}else{const r=e.nextSibling;if(Eo(r)){if(Ht(r))return r;if(Ba(r))return r.splitText(1),r}e.nextSibling?o.insertBefore(s,e.nextSibling):o.appendChild(s)}return s},nc=e=>{const t=e.container();return M(t)?t.data.charAt(e.offset())===tt||e.isAtStart()&&wo(t.previousSibling):!1},sc=e=>{const t=e.container();return M(t)?t.data.charAt(e.offset()-1)===tt||e.isAtEnd()&&wo(t.nextSibling):!1},Rk=()=>{const e=document.createElement("br");return e.setAttribute("data-mce-bogus","1"),e},Tk=(e,t,n)=>{const o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(Rk());const r=t.parentNode;return n?r.insertBefore(o,t):t.nextSibling?r.insertBefore(o,t.nextSibling):r.appendChild(o),o},Ba=e=>Eo(e)&&e.data[0]===tt,Oa=e=>Eo(e)&&e.data[e.data.length-1]===tt,Pk=e=>{const t=e.getElementsByTagName("br"),n=t[t.length-1];Ds(n)&&n.parentNode.removeChild(n)},oc=e=>e&&e.hasAttribute("data-mce-caret")?(Pk(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,gg=e=>So(e.startContainer),pg=xn,Dk=Oe,Bk=Ue,Ok=M,$k=en(["script","style","textarea"]),hg=en(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Lk=en(["table"]),Ik=Ht,tn=e=>Ik(e)?!1:Ok(e)?!$k(e.parentNode):hg(e)||Bk(e)||Lk(e)||rc(e),Fk=e=>Z(e)&&e.getAttribute("unselectable")==="true",rc=e=>Fk(e)===!1&&Dk(e),Mk=(e,t)=>{for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(rc(e))return!1;if(pg(e))return!0}return!0},Uk=e=>rc(e)?$t(Nt(e.getElementsByTagName("*")),(t,n)=>t||pg(n),!1)!==!0:!1,zk=e=>hg(e)||Uk(e),bg=(e,t)=>tn(e)&&Mk(e,t),Hk=/^[ \t\r\n]*$/,Os=e=>Hk.test(e),Vk=e=>" \f	\v".indexOf(e)!==-1,Cg=e=>e===`
`||e==="\r",Wk=(e,t)=>t<e.length&&t>=0?Cg(e[t]):!1,yg=(e,t=4,n=!0,s=!0)=>{const o=tw(" ",t),r=e.replace(/\t/g,o);return $t(r,(i,l)=>Vk(l)||l===it?i.pcIsSpace||i.str===""&&n||i.str.length===r.length-1&&s||Wk(r,i.str.length+1)?{pcIsSpace:!1,str:i.str+it}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:Cg(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},jk=(e,t)=>{const n=C.fromDom(t),s=C.fromDom(e);return fg(s,"pre,code",V(Ae,n))},qk=(e,t)=>M(e)&&Os(e.data)&&jk(e,t)===!1,Kk=e=>Z(e)&&e.nodeName==="A"&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),$a=(e,t)=>tn(e)&&qk(e,t)===!1||Kk(e)||Gk(e),Gk=sg("data-mce-bookmark"),Yk=sg("data-mce-bogus"),Xk=nk("data-mce-bogus","all"),Qk=(e,t)=>{let n=0;if($a(e,e))return!1;{let s=e.firstChild;if(!s)return!0;const o=new Ve(s,e);do{if(t){if(Xk(s)){s=o.next(!0);continue}if(Yk(s)){s=o.next();continue}}if(Ue(s)){n++,s=o.next();continue}if($a(s,e))return!1;s=o.next()}while(s);return n<=1}},Xe=(e,t=!0)=>Qk(e.dom,t),Zk=e=>e.nodeName.toLowerCase()==="span",vg=(e,t)=>oe(e)&&($a(e,t)||ec(C.fromDom(e))),Jk=(e,t)=>{const n=new Ve(e,t).prev(!1),s=new Ve(e,t).next(!1),o=kt(n)||vg(n,t),r=kt(s)||vg(s,t);return o&&r},Eg=e=>Zk(e)&&e.getAttribute("data-mce-type")==="bookmark",ex=(e,t)=>M(e)&&e.data.length>0&&Jk(e,t),tx=e=>Z(e)?e.childNodes.length>0:!1,nx=e=>Jl(e)||Zl(e),ac=(e,t,n)=>{const s=n||t;if(Z(t)&&Eg(t))return t;const o=t.childNodes;for(let r=o.length-1;r>=0;r--)ac(e,o[r],s);if(Z(t)){const r=t.childNodes;r.length===1&&Eg(r[0])&&t.parentNode.insertBefore(r[0],t)}return!nx(t)&&!$a(t,s)&&!tx(t)&&!ex(t,s)&&e.remove(t),t},sx=D.makeMap,La=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ia=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ox=/[<>&\"\']/g,rx=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,ax={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"},$s={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},ix={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},lx=e=>{const t=C.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},Sg=(e,t)=>{let n,s,o;const r={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)s=String.fromCharCode(parseInt(e[n],t)),$s[s]||(o="&"+e[n+1]+";",r[s]=o,r[o]=s);return r}},ic=Sg("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),wg=(e,t)=>e.replace(t?La:Ia,n=>$s[n]||n),cx=e=>(""+e).replace(ox,t=>$s[t]||t),kg=(e,t)=>e.replace(t?La:Ia,n=>n.length>1?"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";":$s[n]||"&#"+n.charCodeAt(0)+";"),lc=(e,t,n)=>(n=n||ic,e.replace(t?La:Ia,s=>$s[s]||n[s]||s)),as={encodeRaw:wg,encodeAllRaw:cx,encodeNumeric:kg,encodeNamed:lc,getEncodeFunc:(e,t)=>{const n=Sg(t)||ic,s=(a,i)=>a.replace(i?La:Ia,l=>$s[l]!==void 0?$s[l]:n[l]!==void 0?n[l]:l.length>1?"&#"+((l.charCodeAt(0)-55296)*1024+(l.charCodeAt(1)-56320)+65536)+";":"&#"+l.charCodeAt(0)+";"),o=(a,i)=>lc(a,i,n),r=sx(e.replace(/\+/g,","));return r.named&&r.numeric?s:r.named?t?o:lc:r.numeric?kg:wg},decode:e=>e.replace(rx,(t,n)=>n?(n.charAt(0).toLowerCase()==="x"?n=parseInt(n.substr(1),16):n=parseInt(n,10),n>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(n&1023))):ax[n]||String.fromCharCode(n)):ix[t]||ic[t]||lx(t))},is={},ux={},ko=D.makeMap,lt=D.each,cc=D.extend,xg=D.explode,fx=D.inArray,nt=(e,t)=>(e=D.trim(e),e?e.split(t||" "):[]),Ng=(e,t)=>{const n=ko(e," ",ko(e.toUpperCase()," "));return cc(n,t)},_g=e=>Ng("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),dx=e=>{const t={};let n,s,o,r,a,i;const l=(u,f="",m="")=>{const g=nt(m),h=nt(u);let p=h.length;for(;p--;){const b=nt([n,f].join(" "));t[h[p]]={attributes:Pl(b,()=>({})),attributesOrder:b,children:Pl(g,F(ux))}}},c=(u,f)=>{const m=nt(u),g=nt(f);let h=m.length;for(;h--;){const p=t[m[h]];for(let b=0,y=g.length;b<y;b++)p.attributes[g[b]]={},p.attributesOrder.push(g[b])}};return is[e]?is[e]:(n="id accesskey class dir lang style tabindex title role",s="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"&&(n+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",s+=" article aside details dialog figure main header footer hgroup section nav",o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),e!=="html5-strict"&&(n+=" xml:lang",i="acronym applet basefont big font strike tt",o=[o,i].join(" "),lt(nt(i),u=>{l(u,"",o)}),a="center dir isindex noframes",s=[s,a].join(" "),r=[s,o].join(" "),lt(nt(a),u=>{l(u,"",r)})),r=r||[s,o].join(" "),l("html","manifest","head body"),l("head","","base command link meta noscript script style title"),l("title hr noscript br"),l("base","href target"),l("link","href rel media hreflang type sizes hreflang"),l("meta","name http-equiv content charset"),l("style","media type scoped"),l("script","src async defer type charset"),l("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",r),l("address dt dd div caption","",r),l("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",o),l("blockquote","cite",r),l("ol","reversed start type","li"),l("ul","","li"),l("li","value",r),l("dl","","dt dd"),l("a","href target rel media hreflang type",o),l("q","cite",o),l("ins del","cite datetime",r),l("img","src sizes srcset alt usemap ismap width height"),l("iframe","src name width height",r),l("embed","src type width height"),l("object","data type typemustmatch name usemap form width height",[r,"param"].join(" ")),l("param","name value"),l("map","name",[r,"area"].join(" ")),l("area","alt coords shape href target rel media hreflang type"),l("table","border","caption colgroup thead tfoot tbody tr"+(e==="html4"?" col":"")),l("colgroup","span","col"),l("col","span"),l("tbody thead tfoot","","tr"),l("tr","","td th"),l("td","colspan rowspan headers",r),l("th","colspan rowspan headers scope abbr",r),l("form","accept-charset action autocomplete enctype method name novalidate target",r),l("fieldset","disabled form name",[r,"legend"].join(" ")),l("label","form for",o),l("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),l("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",e==="html4"?r:o),l("select","disabled form multiple name required size","option optgroup"),l("optgroup","disabled label","option"),l("option","disabled label selected value"),l("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),l("menu","type label",[r,"li"].join(" ")),l("noscript","",r),e!=="html4"&&(l("wbr"),l("ruby","",[o,"rt rp"].join(" ")),l("figcaption","",r),l("mark rt rp summary bdi","",o),l("canvas","width height",r),l("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[r,"track source"].join(" ")),l("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[r,"track source"].join(" ")),l("picture","","img source"),l("source","src srcset type media sizes"),l("track","kind src srclang label default"),l("datalist","",[o,"option"].join(" ")),l("article section nav aside main header footer","",r),l("hgroup","","h1 h2 h3 h4 h5 h6"),l("figure","",[r,"figcaption"].join(" ")),l("time","datetime",o),l("dialog","open",r),l("command","type label icon disabled checked radiogroup command"),l("output","for form name",o),l("progress","value max",o),l("meter","value min max low high optimum",o),l("details","open",[r,"summary"].join(" ")),l("keygen","autofocus challenge disabled form keytype name")),e!=="html5-strict"&&(c("script","language xml:space"),c("style","xml:space"),c("object","declare classid code codebase codetype archive standby align border hspace vspace"),c("embed","align name hspace vspace"),c("param","valuetype type"),c("a","charset name rev shape coords"),c("br","clear"),c("applet","codebase archive code object alt name width height align hspace vspace"),c("img","name longdesc align border hspace vspace"),c("iframe","longdesc frameborder marginwidth marginheight scrolling align"),c("font basefont","size color face"),c("input","usemap align"),c("select"),c("textarea"),c("h1 h2 h3 h4 h5 h6 div p legend caption","align"),c("ul","type compact"),c("li","type"),c("ol dl menu dir","compact"),c("pre","width xml:space"),c("hr","align noshade size width"),c("isindex","prompt"),c("table","summary width frame rules cellspacing cellpadding align bgcolor"),c("col","width align char charoff valign"),c("colgroup","width align char charoff valign"),c("thead","align char charoff valign"),c("tr","align char charoff valign bgcolor"),c("th","axis align char charoff valign nowrap bgcolor width height"),c("form","accept"),c("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),c("tfoot","align char charoff valign"),c("tbody","align char charoff valign"),c("area","nohref"),c("body","background bgcolor text link vlink alink")),e!=="html4"&&(c("input button select textarea","autofocus"),c("input textarea","placeholder"),c("a","download"),c("link script img","crossorigin"),c("img","loading"),c("iframe","sandbox seamless allowfullscreen loading")),e!=="html4"&&B([t.video,t.audio],u=>{delete u.children.audio,delete u.children.video}),lt(nt("a form meter progress dfn"),u=>{t[u]&&delete t[u].children[u]}),delete t.caption.children.table,delete t.script,is[e]=t,t)},uc=(e,t)=>{let n;return e&&(n={},typeof e=="string"&&(e={"*":e}),lt(e,(s,o)=>{n[o]=n[o.toUpperCase()]=t==="map"?ko(s,/[, ]/):xg(s,/[, ]/)})),n},ls=e=>{var t;const n={},s={};let o=[];const r={},a={},i=(te,ee,ye)=>{let ve=e[te];return ve?ve=ko(ve,/[, ]/,ko(ve.toUpperCase(),/[, ]/)):(ve=is[te],ve||(ve=Ng(ee,ye),is[te]=ve)),ve};e=e||{};const l=(t=e.schema)!==null&&t!==void 0?t:"html5",c=dx(l);e.verify_html===!1&&(e.valid_elements="*[*]");const u=uc(e.valid_styles),f=uc(e.invalid_styles,"map"),m=uc(e.valid_classes,"map"),g=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),h=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),p=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),b=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),y="td th iframe video audio object script code",E=i("non_empty_elements",y+" pre",p),S=i("move_caret_before_on_enter_elements",y+" table",p),x=i("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),_=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",x),j=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp");lt("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),te=>{a[te]=new RegExp("</"+te+"[^>]*>","gi")});const A=te=>new RegExp("^"+te.replace(/([?+*])/g,".$1")+"$"),T=te=>{let ee,ye,ve,He,xe,de,Ne,ct,ut,et,gn,St,gt,Gt,vs,Fn,Mn,pn;const oo=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,Es=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,Yt=/[*?+]/;if(te){const hn=nt(te,",");for(n["@"]&&(Fn=n["@"].attributes,Mn=n["@"].attributesOrder),ee=0,ye=hn.length;ee<ye;ee++)if(xe=oo.exec(hn[ee]),xe){if(Gt=xe[1],ut=xe[2],vs=xe[3],ct=xe[5],St={},gt=[],de={attributes:St,attributesOrder:gt},Gt==="#"&&(de.paddEmpty=!0),Gt==="-"&&(de.removeEmpty=!0),xe[4]==="!"&&(de.removeEmptyAttrs=!0),Fn&&(Pe(Fn,(ro,bn)=>{St[bn]=ro}),gt.push.apply(gt,Mn)),ct){for(ct=nt(ct,"|"),ve=0,He=ct.length;ve<He;ve++)if(xe=Es.exec(ct[ve]),xe){if(Ne={},gn=xe[1],et=xe[2].replace(/[\\:]:/g,":"),Gt=xe[3],pn=xe[4],gn==="!"&&(de.attributesRequired=de.attributesRequired||[],de.attributesRequired.push(et),Ne.required=!0),gn==="-"){delete St[et],gt.splice(fx(gt,et),1);continue}Gt&&(Gt==="="&&(de.attributesDefault=de.attributesDefault||[],de.attributesDefault.push({name:et,value:pn}),Ne.defaultValue=pn),Gt==="~"&&(de.attributesForced=de.attributesForced||[],de.attributesForced.push({name:et,value:pn}),Ne.forcedValue=pn),Gt==="<"&&(Ne.validValues=ko(pn,"?"))),Yt.test(et)?(de.attributePatterns=de.attributePatterns||[],Ne.pattern=A(et),de.attributePatterns.push(Ne)):(St[et]||gt.push(et),St[et]=Ne)}}!Fn&&ut==="@"&&(Fn=St,Mn=gt),vs&&(de.outputName=ut,n[vs]=de),Yt.test(ut)?(de.pattern=A(ut),o.push(de)):n[ut]=de}}},$=te=>{o=[],B(Xt(n),ee=>{delete n[ee]}),T(te),lt(c,(ee,ye)=>{s[ye]=ee.children})},L=te=>{const ee=/^(~)?(.+)$/;te&&(is.text_block_elements=is.block_elements=null,lt(nt(te,","),ye=>{const ve=ee.exec(ye),He=ve[1]==="~",xe=He?"span":"div",de=ve[2];if(s[de]=s[xe],r[de]=xe,E[de.toUpperCase()]={},E[de]={},He||(_[de.toUpperCase()]={},_[de]={}),!n[de]){let Ne=n[xe];Ne=cc({},Ne),delete Ne.removeEmptyAttrs,delete Ne.removeEmpty,n[de]=Ne}lt(s,(Ne,ct)=>{Ne[xe]&&(s[ct]=Ne=cc({},s[ct]),Ne[de]=Ne[xe])})}))},Q=te=>{const ee=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;is[l]=null,te&&lt(nt(te,","),ye=>{const ve=ee.exec(ye);let He,xe;ve&&(xe=ve[1],xe?He=s[ve[2]]:He=s[ve[2]]={"#comment":{}},He=s[ve[2]],lt(nt(ve[3],"|"),de=>{xe==="-"?delete He[de]:He[de]={}}))})},q=te=>{let ee=n[te],ye;if(ee)return ee;for(ye=o.length;ye--;)if(ee=o[ye],ee.pattern.test(te))return ee};e.valid_elements?$(e.valid_elements):(lt(c,(te,ee)=>{n[ee]={attributes:te.attributes,attributesOrder:te.attributesOrder},s[ee]=te.children}),lt(nt("strong/b em/i"),te=>{const ee=nt(te,"/");n[ee[1]].outputName=ee[0]}),lt(j,(te,ee)=>{n[ee]&&(e.padd_empty_block_inline_children&&(n[ee].paddInEmptyBlock=!0),n[ee].removeEmpty=!0)}),lt(nt("ol ul blockquote a table tbody"),te=>{n[te]&&(n[te].removeEmpty=!0)}),lt(nt("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),te=>{n[te].paddEmpty=!0}),lt(nt("span"),te=>{n[te].removeEmptyAttrs=!0})),L(e.custom_elements),Q(e.valid_children),T(e.extended_valid_elements),Q("+ol[ul|ol],+ul[ul|ol]"),lt({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(te,ee)=>{n[ee]&&(n[ee].parentsRequired=nt(te))}),e.invalid_elements&&lt(xg(e.invalid_elements),te=>{n[te]&&delete n[te]}),q("span")||T("span[!data-mce-type|*]");const z=F(u),pe=F(f),Ce=F(m),ke=F(b),ze=F(_),O=F(x),Y=F(j),ue=F(Object.seal(p)),le=F(h),We=F(E),U=F(S),J=F(g),K=F(Object.seal(a)),I=(te,ee)=>{const ye=s[te.toLowerCase()];return!!(ye&&ye[ee.toLowerCase()])},ce=(te,ee)=>{let ye,ve;const He=q(te);if(He)if(ee){if(He.attributes[ee])return!0;if(ye=He.attributePatterns,ye){for(ve=ye.length;ve--;)if(ye[ve].pattern.test(ee))return!0}}else return!0;return!1},ge=F(r);return{type:l,children:s,elements:n,getValidStyles:z,getValidClasses:Ce,getBlockElements:ze,getInvalidStyles:pe,getVoidElements:ue,getTextBlockElements:O,getTextInlineElements:Y,getBoolAttrs:ke,getElementRule:q,getSelfClosingElements:le,getNonEmptyElements:We,getMoveCaretBeforeOnEnterElements:U,getWhitespaceElements:J,getSpecialElements:K,isValidChild:I,isValid:ce,getCustomElements:ge,addValidElements:T,setValidElements:$,addCustomElements:L,addValidChildren:Q}},fc=(e,t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/;let r;const a={};let i,l;const c=wr;e=e||{},t&&(i=t.getValidStyles(),l=t.getInvalidStyles());const u=(`\\" \\' \\; \\: ; : `+c).split(" ");for(r=0;r<u.length;r++)a[u[r]]=c+r,a[c+r]=u[r];const f={parse:m=>{const g={};let h,p,b,y;const E=e.url_converter,S=e.url_converter_scope||f,x=(q,z,pe)=>{const Ce=g[q+"-top"+z];if(!Ce)return;const ke=g[q+"-right"+z];if(!ke)return;const ze=g[q+"-bottom"+z];if(!ze)return;const O=g[q+"-left"+z];if(!O)return;const Y=[Ce,ke,ze,O];for(r=Y.length-1;r--&&Y[r]===Y[r+1];);r>-1&&pe||(g[q+z]=r===-1?Y[0]:Y.join(" "),delete g[q+"-top"+z],delete g[q+"-right"+z],delete g[q+"-bottom"+z],delete g[q+"-left"+z])},_=q=>{let z=g[q],pe;if(!!z){for(z=z.split(" "),pe=z.length;pe--;)if(z[pe]!==z[0])return!1;return g[q]=z[0],!0}},j=(q,z,pe,Ce)=>{!_(z)||!_(pe)||!_(Ce)||(g[q]=g[z]+" "+g[pe]+" "+g[Ce],delete g[z],delete g[pe],delete g[Ce])},A=q=>(y=!0,a[q]),T=(q,z)=>(y&&(q=q.replace(/\uFEFF[0-9]/g,pe=>a[pe])),z||(q=q.replace(/\\([\'\";:])/g,"$1")),q),$=q=>String.fromCharCode(parseInt(q.slice(1),16)),L=q=>q.replace(/\\[0-9a-f]+/gi,$),Q=(q,z,pe,Ce,ke,ze)=>{if(ke=ke||ze,ke)return ke=T(ke),"'"+ke.replace(/\'/g,"\\'")+"'";if(z=T(z||pe||Ce),!e.allow_script_urls){const O=z.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(O)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(O))return""}return E&&(z=E.call(S,z,"style")),"url('"+z.replace(/\'/g,"\\'")+"')"};if(m){for(m=m.replace(/[\u0000-\u001F]/g,""),m=m.replace(/\\[\"\';:\uFEFF]/g,A).replace(/\"[^\"]+\"|\'[^\']+\'/g,q=>q.replace(/[;:]/g,A));h=s.exec(m);)if(s.lastIndex=h.index+h[0].length,p=h[1].replace(o,"").toLowerCase(),b=h[2].replace(o,""),p&&b){if(p=L(p),b=L(b),p.indexOf(c)!==-1||p.indexOf('"')!==-1||!e.allow_script_urls&&(p==="behavior"||/expression\s*\(|\/\*|\*\//.test(b)))continue;p==="font-weight"&&b==="700"?b="bold":(p==="color"||p==="background-color")&&(b=b.toLowerCase()),b=b.replace(n,Q),g[p]=y?T(b,!0):b}x("border","",!0),x("border","-width"),x("border","-color"),x("border","-style"),x("padding",""),x("margin",""),j("border","border-width","border-style","border-color"),g.border==="medium none"&&delete g.border,g["border-image"]==="none"&&delete g["border-image"]}return g},serialize:(m,g)=>{let h="";const p=y=>{let E;const S=i[y];if(S)for(let x=0,_=S.length;x<_;x++)y=S[x],E=m[y],E&&(h+=(h.length>0?" ":"")+y+": "+E+";")},b=(y,E)=>{let S=l["*"];return S&&S[y]?!1:(S=l[E],!(S&&S[y]))};return g&&i?(p("*"),p(g)):Pe(m,(y,E)=>{y&&(!l||b(E,g))&&(h+=(h.length>0?" ":"")+E+": "+y+";")}),h}};return f},mx={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},gx=e=>e instanceof Event||_e(e.initEvent),px=e=>e.isDefaultPrevented===je||e.isDefaultPrevented===Le,hx=e=>xt(e.preventDefault)||gx(e),Ag=(e,t)=>{const n=t!=null?t:{};for(const s in e)fe(mx,s)||(n[s]=e[s]);return oe(n.composedPath)&&(n.composedPath=()=>e.composedPath()),n},dc=(e,t,n,s)=>{var o;const r=Ag(t,s);return r.type=e,xt(r.target)&&(r.target=(o=r.srcElement)!==null&&o!==void 0?o:n),hx(t)&&(r.preventDefault=()=>{r.defaultPrevented=!0,r.isDefaultPrevented=je,_e(t.preventDefault)&&t.preventDefault()},r.stopPropagation=()=>{r.cancelBubble=!0,r.isPropagationStopped=je,_e(t.stopPropagation)&&t.stopPropagation()},r.stopImmediatePropagation=()=>{r.isImmediatePropagationStopped=je,r.stopPropagation()},px(r)||(r.isDefaultPrevented=r.defaultPrevented===!0?je:Le,r.isPropagationStopped=r.cancelBubble===!0?je:Le,r.isImmediatePropagationStopped=Le)),r},bx="mce-data-",Cx=/^(?:mouse|contextmenu)|click/,mc=(e,t,n,s)=>{e.addEventListener?e.addEventListener(t,n,s||!1):e.attachEvent&&e.attachEvent("on"+t,n)},Fa=(e,t,n,s)=>{e.removeEventListener?e.removeEventListener(t,n,s||!1):e.detachEvent&&e.detachEvent("on"+t,n)},yx=e=>oe(e)&&Cx.test(e.type),xo=(e,t)=>{const n=dc(e.type,e,document,t);if(yx(e)&&kt(e.pageX)&&!kt(e.clientX)){const s=n.target.ownerDocument||document,o=s.documentElement,r=s.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},vx=(e,t,n)=>{const s=e.document,o={type:"ready"};if(n.domLoaded){t(o);return}const r=()=>s.readyState==="complete"||s.readyState==="interactive"&&s.body,a=()=>{Fa(e,"DOMContentLoaded",a),Fa(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};r()?a():mc(e,"DOMContentLoaded",a),n.domLoaded||mc(e,"load",a)};class Ls{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=bx+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,s,o){const r=this;let a,i,l,c,u,f,m;const g=window,h=b=>{r.executeHandlers(xo(b||g.event),a)};if(!t||t.nodeType===3||t.nodeType===8)return;t[r.expando]?a=t[r.expando]:(a=r.count++,t[r.expando]=a,r.events[a]={}),o=o||t;const p=n.split(" ");for(l=p.length;l--;){if(c=p[l],f=h,u=m=!1,c==="DOMContentLoaded"&&(c="ready"),r.domLoaded&&c==="ready"&&t.readyState==="complete"){s.call(o,xo({type:c}));continue}r.hasMouseEnterLeave||(u=r.mouseEnterLeave[c],u&&(f=b=>{const y=b.currentTarget;let E=b.relatedTarget;if(E&&y.contains)E=y.contains(E);else for(;E&&E!==y;)E=E.parentNode;E||(b=xo(b||g.event),b.type=b.type==="mouseout"?"mouseleave":"mouseenter",b.target=y,r.executeHandlers(b,a))})),!r.hasFocusIn&&(c==="focusin"||c==="focusout")&&(m=!0,u=c==="focusin"?"focus":"blur",f=b=>{b=xo(b||g.event),b.type=b.type==="focus"?"focusin":"focusout",r.executeHandlers(b,a)}),i=r.events[a][c],i?c==="ready"&&r.domLoaded?s(xo({type:c})):i.push({func:s,scope:o}):(r.events[a][c]=i=[{func:s,scope:o}],i.fakeName=u,i.capture=m,i.nativeHandler=f,c==="ready"?vx(t,f,r):mc(t,u||c,f,m))}return t=i=null,s}unbind(t,n,s){let o,r,a,i,l;if(!t||t.nodeType===3||t.nodeType===8)return this;const c=t[this.expando];if(c){if(l=this.events[c],n){const u=n.split(" ");for(r=u.length;r--;)if(i=u[r],o=l[i],o){if(s){for(a=o.length;a--;)if(o[a].func===s){const f=o.nativeHandler,m=o.fakeName,g=o.capture;o=o.slice(0,a).concat(o.slice(a+1)),o.nativeHandler=f,o.fakeName=m,o.capture=g,l[i]=o}}(!s||o.length===0)&&(delete l[i],Fa(t,o.fakeName||i,o.nativeHandler,o.capture))}}else Pe(l,(u,f)=>{Fa(t,u.fakeName||f,u.nativeHandler,u.capture)}),l={};for(i in l)if(fe(l,i))return this;delete this.events[c];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,s){return this.dispatch(t,n,s)}dispatch(t,n,s){let o;if(!t||t.nodeType===3||t.nodeType===8)return this;const r=xo({type:n,target:t},s);do o=t[this.expando],o&&this.executeHandlers(r,o),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow;while(t&&!r.isPropagationStopped());return this}clean(t){let n,s;if(!t||t.nodeType===3||t.nodeType===8)return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName)for(this.unbind(t),s=t.getElementsByTagName("*"),n=s.length;n--;)t=s[n],t[this.expando]&&this.unbind(t);return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){const s=this.events[n],o=s&&s[t.type];if(o)for(let r=0,a=o.length;r<a;r++){const i=o[r];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}Ls.Event=new Ls;const gc=D.each,Ex=D.grep,pc="data-mce-style",kr=(e,t,n)=>{xt(n)||n===""?rt(e,t):ot(e,t,n)},Sx=(e,t,n)=>{const s=t.keep_values,o={set:(a,i,l)=>{const c=C.fromDom(a);_e(t.url_converter)&&oe(i)&&(i=t.url_converter.call(t.url_converter_scope||n(),i,l,a[0]));const u="data-mce-"+l;kr(c,u,i),kr(c,l,i)},get:(a,i)=>{const l=C.fromDom(a);return zt(l,"data-mce-"+i)||zt(l,i)}},r={style:{set:(a,i)=>{const l=C.fromDom(a);if(Ot(i)){ka(l,i);return}s&&kr(l,pc,i),rt(l,"style"),ne(i)&&ka(l,e.parse(i))},get:a=>{const i=C.fromDom(a),l=zt(i,pc)||zt(i,"style");return e.serialize(e.parse(l),Be(i))}}};return s&&(r.href=r.src=o),r},wx=(e,t)=>{const n=zt(t,"style"),s=e.serialize(e.parse(n),Be(t));kr(t,pc,s)},No=(e,t)=>{let n=0,s,o;if(e)for(s=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)o=e.nodeType,!(t&&o===3&&(o===s||!e.nodeValue.length))&&(n++,s=o);return n},kx=D.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),Rg=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Re=(e,t={})=>{const n={},s=window,o={};let r=0;const a=!0,i=!0,l=ug.forElement(C.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),c=[],u=t.schema?t.schema:ls({}),f=fc({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),m=t.ownEvents?new Ls:Ls.Event,g=u.getBlockElements(),h=v=>ne(v)?fe(g,v):Z(v)&&fe(g,v.nodeName),p=v=>v&&e&&ne(v)?e.getElementById(v):v,b=v=>{const w=p(v);return oe(w)?C.fromDom(w):null},y=(v,w,P)=>{let R;const X=b(v);if(oe(X)&&Qt(X)){const be=Sl[w];be&&be.get?R=be.get(X.dom,w):R=zt(X,w)}return oe(R)?R:P!=null?P:""},E=v=>{const w=p(v);return xt(w)?[]:w.attributes},S=(v,w,P)=>{ue(v,R=>{if(Z(R)){const X=C.fromDom(R);P===""&&(P=null);const be=zt(X,w),he=Sl[w];he&&he.set?he.set(X.dom,P,w):kr(X,w,P),be!==P&&t.onSetAttrib&&t.onSetAttrib({attrElm:X,attrName:w,attrValue:P})}})},x=(v,w)=>v.cloneNode(w),_=()=>t.root_element||e.body,j=v=>{const w=ng(v);return{x:w.x,y:w.y,w:w.width,h:w.height}},A=(v,w)=>lk(e.body,p(v),w),T=(v,w,P)=>{const R=(be,he)=>ne(be)?be:yn(be)?fe(kx,he)?be+"":be+"px":ir(be,R),X=(be,he,Bt)=>{const Cn=Rg(he);xt(Bt)||Bt===""?Ym(be,Cn):qm(be,Cn,R(Bt,Cn))};ue(v,be=>{const he=C.fromDom(be);ne(w)?X(he,w,P):Pe(w,(Bt,Cn)=>{X(he,Cn,Bt)}),t.update_styles&&wx(f,he)})},$=(v,w)=>{T(v,w)},L=(v,w,P)=>{const R=p(v);if(!(xt(R)||!Z(R)))return P?kn(C.fromDom(R),Rg(w)):(w=w.replace(/-(\D)/g,(X,be)=>be.toUpperCase()),w==="float"&&(w="cssFloat"),R.style?R.style[w]:void 0)},Q=v=>{let w,P;const R=p(v);return w=L(R,"width"),P=L(R,"height"),w.indexOf("px")===-1&&(w=0),P.indexOf("px")===-1&&(P=0),{w:parseInt(w,10)||R.offsetWidth||R.clientWidth,h:parseInt(P,10)||R.offsetHeight||R.clientHeight}},q=v=>{const w=p(v),P=A(w),R=Q(w);return{x:P.x,y:P.y,w:R.w,h:R.h}},z=(v,w)=>{if(!v)return!1;const P=Ge(v)?v:[v];return Me(P,R=>wn(C.fromDom(R),w))},pe=(v,w,P,R)=>{const X=[];let be,he=p(v);for(R=R===void 0,P=P||(_().nodeName!=="BODY"?_().parentNode:null),ne(w)&&(be=w,w==="*"?w=Z:w=Bt=>z(Bt,be));he&&!(he===P||xt(he.nodeType)||Zl(he)||Jl(he));){if(!w||w(he))if(R)X.push(he);else return[he];he=he.parentNode}return R?X:null},Ce=(v,w,P)=>{const R=pe(v,w,P,!1);return R&&R.length>0?R[0]:null},ke=(v,w,P)=>{let R=w;if(v){for(ne(w)&&(R=X=>z(X,w)),v=v[P];v;v=v[P])if(_e(R)&&R(v))return v}return null},ze=(v,w)=>ke(v,w,"nextSibling"),O=(v,w)=>ke(v,w,"previousSibling"),Y=(v,w)=>{var P,R;const X=(R=(P=p(w))!==null&&P!==void 0?P:t.root_element)!==null&&R!==void 0?R:e;return Nt(X.querySelectorAll(v))},ue=function(v,w,P){const R=P!=null?P:this,X=ne(v)?p(v):v;if(!X)return!1;if(Ge(X)&&(X.length||X.length===0)){const be=[];return gc(X,(he,Bt)=>{he&&be.push(w.call(R,ne(he)?p(he):he,Bt))}),be}else return w.call(R,X)},le=(v,w)=>{ue(v,P=>{Pe(w,(R,X)=>{S(P,X,R)})})},We=(v,w)=>{ue(v,P=>{const R=C.fromDom(P);Kl(R,w)})},U=(v,w,P,R,X)=>ue(v,be=>{const he=ne(w)?e.createElement(w):w;return oe(P)&&le(he,P),R&&(!ne(R)&&R.nodeType?he.appendChild(R):ne(R)&&We(he,R)),X?he:be.appendChild(he)}),J=(v,w,P)=>U(e.createElement(v),v,w,P,!0),K=as.decode,I=as.encodeAllRaw,ce=(v,w,P="")=>{let R="",X;R+="<"+v;for(X in w)uo(w,X)&&(R+=" "+X+'="'+I(w[X])+'"');return va(P)&&fe(u.getVoidElements(),v)?R+" />":R+">"+P+"</"+v+">"},ge=v=>{let w;const P=e.createElement("div"),R=e.createDocumentFragment();for(R.appendChild(P),v&&(P.innerHTML=v);w=P.firstChild;)R.appendChild(w);return R.removeChild(P),R},te=(v,w)=>ue(v,P=>{const R=C.fromDom(P);return w&&B(at(R),X=>{Ut(X)&&X.dom.length===0?Fe(X):Jt(R,X)}),Fe(R),R.dom}),ee=v=>ue(v,w=>{const P=w.attributes;for(let R=P.length-1;R>=0;R--)w.removeAttributeNode(P.item(R))}),ye=v=>f.parse(v),ve=(v,w)=>f.serialize(v,w),He=v=>{let w,P;if(Jn!==Re.DOM&&e===document){if(n[v])return;n[v]=!0}P=e.getElementById("mceDefaultStyles"),P||(P=e.createElement("style"),P.id="mceDefaultStyles",P.type="text/css",w=e.getElementsByTagName("head")[0],w.firstChild?w.insertBefore(P,w.firstChild):w.appendChild(P)),P.styleSheet?P.styleSheet.cssText+=v:P.appendChild(e.createTextNode(v))},xe=v=>{v||(v=""),B(v.split(","),w=>{o[w]=!0,l.load(w).catch(me)})},de=(v,w,P)=>{ue(v,R=>{if(Z(R)){const X=C.fromDom(R),be=w.split(" ");B(be,he=>{oe(P)?(P?gr:Sa)(X,he):xw(X,he)})}})},Ne=(v,w)=>{de(v,w,!0)},ct=(v,w)=>{de(v,w,!1)},ut=(v,w)=>{const P=b(v),R=w.split(" ");return io(R,X=>Wl(P,X))},et=v=>{ue(v,w=>Ym(C.fromDom(w),"display"))},gn=v=>{ue(v,w=>qm(C.fromDom(w),"display","none"))},St=v=>{const w=b(v);return go(xa(w,"display"),"none")},gt=v=>(v||"mce_")+r++,Gt=v=>{const w=b(v);return Z(w.dom)?w.dom.outerHTML:qw(w)},vs=(v,w)=>{ue(v,P=>{Z(P)&&(P.outerHTML=w)})},Fn=(v,w)=>{const P=p(w);return ue(v,R=>{const X=P.parentNode,be=P.nextSibling;return be?X.insertBefore(R,be):X.appendChild(R),R})},Mn=(v,w,P)=>ue(w,R=>(Ge(R)&&(v=v.cloneNode(!0)),P&&gc(Ex(R.childNodes),X=>{v.appendChild(X)}),R.parentNode.replaceChild(v,R))),pn=(v,w)=>{let P;return v.nodeName!==w.toUpperCase()&&(P=J(w),gc(E(v),R=>{S(P,R.nodeName,y(v,R.nodeName))}),Mn(P,v,!0)),P||v},oo=(v,w)=>{let P=v,R;for(;P;){for(R=w;R&&P!==R;)R=R.parentNode;if(P===R)break;P=P.parentNode}return!P&&v.ownerDocument?v.ownerDocument.documentElement:P},Es=v=>{if(Z(v)){const w=v.nodeName.toLowerCase()==="a"&&!y(v,"href")&&y(v,"id");if(y(v,"name")||y(v,"data-mce-bookmark")||w)return!0}return!1},Yt=(v,w)=>{let P,R,X=0;if(Es(v))return!1;if(v=v.firstChild,v){const be=new Ve(v,v.parentNode),he=u?u.getWhitespaceElements():{};w=w||(u?u.getNonEmptyElements():null);do{if(P=v.nodeType,Z(v)){const Bt=v.getAttribute("data-mce-bogus");if(Bt){v=be.next(Bt==="all");continue}if(R=v.nodeName.toLowerCase(),w&&w[R]){if(R==="br"){X++,v=be.next();continue}return!1}if(Es(v))return!1}if(P===8||P===3&&!Os(v.nodeValue)||P===3&&v.parentNode&&he[v.parentNode.nodeName]&&Os(v.nodeValue))return!1;v=be.next()}while(v)}return X<=1},hn=()=>e.createRange(),ro=(v,w,P)=>{let R=hn(),X,be,he;if(v&&w)return R.setStart(v.parentNode,No(v)),R.setEnd(w.parentNode,No(w)),X=R.extractContents(),R=hn(),R.setStart(w.parentNode,No(w)+1),R.setEnd(v.parentNode,No(v)+1),be=R.extractContents(),he=v.parentNode,he.insertBefore(ac(Jn,X),v),P?he.insertBefore(P,v):he.insertBefore(w,v),he.insertBefore(ac(Jn,be),v),te(v),P||w},bn=(v,w,P,R)=>{if(Ge(v)){let X=v.length;const be=[];for(;X--;)be[X]=bn(v[X],w,P,R);return be}else return t.collect&&(v===e||v===s)&&c.push([v,w,P,R]),m.bind(v,w,P,R||Jn)},vl=(v,w,P)=>{if(Ge(v)){let R=v.length;const X=[];for(;R--;)X[R]=vl(v[R],w,P);return X}else{if(c.length>0&&(v===e||v===s)){let R=c.length;for(;R--;){const X=c[R];v===X[0]&&(!w||w===X[1])&&(!P||P===X[2])&&m.unbind(X[0],X[1],X[2])}}return m.unbind(v,w,P)}},Pd=(v,w,P)=>m.dispatch(v,w,P),Qn=(v,w,P)=>m.dispatch(v,w,P),Zn=v=>{if(v&&Z(v)){const w=v.getAttribute("data-mce-contenteditable");return w&&w!=="inherit"?w:v.contentEditable!=="inherit"?v.contentEditable:null}else return null},Jn={doc:e,settings:t,win:s,files:o,stdMode:a,boxModel:i,styleSheetLoader:l,boundEvents:c,styles:f,schema:u,events:m,isBlock:h,root:null,clone:x,getRoot:_,getViewPort:j,getRect:q,getSize:Q,getParent:Ce,getParents:pe,get:p,getNext:ze,getPrev:O,select:Y,is:z,add:U,create:J,createHTML:ce,createFragment:ge,remove:te,setStyle:T,getStyle:L,setStyles:$,removeAllAttribs:ee,setAttrib:S,setAttribs:le,getAttrib:y,getPos:A,parseStyle:ye,serializeStyle:ve,addStyle:He,loadCSS:xe,addClass:Ne,removeClass:ct,hasClass:ut,toggleClass:de,show:et,hide:gn,isHidden:St,uniqueId:gt,setHTML:We,getOuterHTML:Gt,setOuterHTML:vs,decode:K,encode:I,insertAfter:Fn,replace:Mn,rename:pn,findCommonAncestor:oo,run:ue,getAttribs:E,isEmpty:Yt,createRng:hn,nodeIndex:No,split:ro,bind:bn,unbind:vl,fire:Qn,dispatch:Pd,getContentEditable:Zn,getContentEditableParent:v=>{const w=_();let P=null;for(;v&&v!==w&&(P=Zn(v),P===null);v=v.parentNode);return P},destroy:()=>{if(c.length>0){let v=c.length;for(;v--;){const w=c[v];m.unbind(w[0],w[1],w[2])}}Pe(o,(v,w)=>{l.unload(w),delete o[w]})},isChildOf:(v,w)=>v===w||w.contains(v),dumpRng:v=>"startContainer: "+v.startContainer.nodeName+", startOffset: "+v.startOffset+", endContainer: "+v.endContainer.nodeName+", endOffset: "+v.endOffset},Sl=Sx(f,t,F(Jn));return Jn};Re.DOM=Re(document),Re.nodeIndex=No;const xx=Re.DOM,Nx=0,_x=1,Ma=2,Tg=3;class Wn{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,s)=>{const o=xx;let r;const a=()=>{o.remove(c),r&&(r.onerror=r.onload=r=null)},i=()=>{a(),n()},l=()=>{a(),s("Failed to load script: "+t)},c=o.uniqueId();r=document.createElement("script"),r.id=c,r.type="text/javascript",r.src=D._addCacheSuffix(t),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=i,r.onerror=l,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)})}isDone(t){return this.states[t]===Ma}markDone(t){this.states[t]=Ma}add(t){const n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=Nx),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){const t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){const n=this,s=(l,c)=>{Te(n.scriptLoadedCallbacks,c).each(u=>{B(u,f=>f[l](c))}),delete n.scriptLoadedCallbacks[c]},o=l=>{const c=re(l,u=>u.status==="rejected");return c.length>0?Promise.reject(Un(c,({reason:u})=>Ge(u)?u:[u])):Promise.resolve()},r=l=>Promise.allSettled(Ee(l,c=>n.states[c]===Ma?(s("resolve",c),Promise.resolve()):n.states[c]===Tg?(s("reject",c),Promise.reject(c)):(n.states[c]=_x,n.loadScript(c).then(()=>{n.states[c]=Ma,s("resolve",c);const u=n.queue;if(u.length>0)return n.queue=[],r(u).then(o)},()=>(n.states[c]=Tg,s("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,r(l).then(c=>{n.loading=!1;const u=n.queueLoadedCallbacks.shift();return d.from(u).each(nr),o(c)})),i=qd(t);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>a(i).then(l,c))}):a(i)}}Wn.ScriptLoader=new Wn;const Qe=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},Ax=e=>Ot(e)&&fe(e,"raw"),Rx=e=>Ge(e)&&e.length>1,xr={},hc=Qe("en"),Pg=()=>Te(xr,hc.get()),on={getData:()=>ir(xr,e=>({...e})),setCode:e=>{e&&hc.set(e)},getCode:()=>hc.get(),add:(e,t)=>{let n=xr[e];n||(xr[e]=n={}),Pe(t,(s,o)=>{n[o.toLowerCase()]=s})},translate:e=>{const t=Pg().getOr({}),n=a=>_e(a)?Object.prototype.toString.call(a):s(a)?"":""+a,s=a=>a===""||a===null||a===void 0,o=a=>{const i=n(a);return Te(t,i.toLowerCase()).map(n).getOr(i)},r=a=>a.replace(/{context:\w+}$/,"");if(s(e))return"";if(Ax(e))return n(e.raw);if(Rx(e)){const a=e.slice(1),i=o(e[0]).replace(/\{([0-9]+)\}/g,(l,c)=>fe(a,c)?n(a[c]):l);return r(i)}return r(o(e))},isRtl:()=>Pg().bind(e=>Te(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>fe(xr,e)},dt=()=>{const e=[],t={},n={},s=[],o=(p,b)=>{const y=re(s,E=>E.name===p&&E.state===b);B(y,E=>E.resolve())},r=p=>fe(t,p),a=p=>fe(n,p),i=p=>{if(n[p])return n[p].instance},l=(p,b)=>{const y=on.getCode(),E=","+(b||"")+",";!y||b&&E.indexOf(","+y+",")===-1||Wn.ScriptLoader.add(t[p]+"/langs/"+y+".js")},c=(p,b)=>{dt.languageLoad!==!1&&(r(p)?l(p,b):h(p,"loaded").then(()=>l(p,b)))},u=(p,b)=>(e.push(b),n[p]={instance:b},o(p,"added"),b),f=p=>{delete t[p],delete n[p]},m=(p,b)=>ne(b)?ne(p)?{prefix:"",resource:b,suffix:""}:{prefix:p.prefix,resource:b,suffix:p.suffix}:b,g=(p,b)=>{if(t[p])return Promise.resolve();let y=ne(b)?b:b.prefix+b.resource+b.suffix;y.indexOf("/")!==0&&y.indexOf("://")===-1&&(y=dt.baseURL+"/"+y),t[p]=y.substring(0,y.lastIndexOf("/"));const E=()=>(o(p,"loaded"),Promise.resolve());return n[p]?E():Wn.ScriptLoader.add(y).then(E)},h=(p,b="added")=>b==="added"&&a(p)||b==="loaded"&&r(p)?Promise.resolve():new Promise(y=>{s.push({name:p,state:b,resolve:y})});return{items:e,urls:t,lookup:n,get:i,requireLangPack:c,add:u,remove:f,createUrl:m,load:g,waitFor:h}};dt.languageLoad=!0,dt.baseURL="",dt.PluginManager=dt(),dt.ThemeManager=dt(),dt.ModelManager=dt();const Tx=e=>{const t=Qe(d.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(d.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(d.some(i))}}},cs=()=>{const e=Tx(me);return{...e,on:n=>e.get().each(n)}},Ua=(e,t)=>{let n=null;return{cancel:()=>{tr(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{tr(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},bc=(e,t)=>{let n=null;const s=()=>{tr(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...r)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},Dg=(e,t)=>{let n=[];return B(at(e),s=>{t(s)&&(n=n.concat([s])),n=n.concat(Dg(s,t))}),n},At=(e,t)=>Rw(t,e),Nr=F("mce-annotation"),Is=F("data-mce-annotation"),_o=F("data-mce-annotation-uid"),_r=F("data-mce-annotation-active"),Ar=F("data-mce-annotation-classes"),Rr=F("data-mce-annotation-attrs"),Bg=e=>t=>Ae(t,e),Og=(e,t)=>{const n=e.selection.getRng(),s=C.fromDom(n.startContainer),o=C.fromDom(e.getBody()),r=t.fold(()=>"."+Nr(),c=>`[${Is()}="${c}"]`),a=wa(s,n.startOffset).getOr(s),i=Bs(a,r,Bg(o)),l=(c,u)=>dr(c,u)?d.some(zt(c,u)):d.none();return i.bind(c=>l(c,`${_o()}`).bind(u=>l(c,`${Is()}`).map(f=>{const m=Lg(e,u);return{uid:u,name:f,elements:m}})))},Px=e=>Qt(e)&&Wl(e,Nr()),$g=(e,t)=>dr(e,"data-mce-bogus")||fg(e,'[data-mce-bogus="all"]',Bg(t)),Lg=(e,t)=>{const n=C.fromDom(e.getBody()),s=At(n,`[${_o()}="${t}"]`);return re(s,o=>!$g(o,n))},Ig=(e,t)=>{const n=C.fromDom(e.getBody()),s=At(n,`[${Is()}="${t}"]`),o={};return B(s,r=>{if(!$g(r,n)){const a=zt(r,_o()),i=Te(o,a).getOr([]);o[a]=i.concat([r])}}),o},Dx=(e,t)=>{const n=Qe({}),s=()=>({listeners:[],previous:cs()}),o=(f,m)=>{r(f,g=>(m(g),g))},r=(f,m)=>{const g=n.get(),h=Te(g,f).getOrThunk(s),p=m(h);g[f]=p,n.set(g)},a=(f,m,g)=>{o(f,h=>{B(h.listeners,p=>p(!0,f,{uid:m,nodes:Ee(g,b=>b.dom)}))})},i=f=>{o(f,m=>{B(m.listeners,g=>g(!1,f))})},l=(f,m)=>{B(Lg(e,f),g=>{m?ot(g,_r(),"true"):rt(g,_r())})},c=bc(()=>{const f=ar(t.getNames());B(f,m=>{r(m,g=>{const h=g.previous.get();return Og(e,d.some(m)).fold(()=>{h.each(p=>{i(m),g.previous.clear(),l(p,!1)})},({uid:p,name:b,elements:y})=>{go(h,p)||(h.each(E=>l(E,!1)),a(b,p,y),g.previous.set(p),l(p,!0))}),{previous:g.previous,listeners:g.listeners}})})},30);return e.on("remove",()=>{c.cancel()}),e.on("NodeChange",()=>{c.throttle()}),{addListener:(f,m)=>{r(f,g=>({previous:g.previous,listeners:g.listeners.concat([m])}))}}},Bx=(e,t)=>{const n=Is(),s=r=>d.from(r.attr(n)).bind(t.lookup),o=r=>{var a,i;r.attr(_o(),null),r.attr(Is(),null),r.attr(_r(),null);const l=d.from(r.attr(Rr())).map(m=>m.split(",")).getOr([]),c=d.from(r.attr(Ar())).map(m=>m.split(",")).getOr([]);B(l,m=>r.attr(m,null));const u=(i=(a=r.attr("class"))===null||a===void 0?void 0:a.split(" "))!==null&&i!==void 0?i:[],f=Tl(u,[Nr()].concat(c));r.attr("class",f.length>0?f.join(" "):null),r.attr(Ar(),null),r.attr(Rr(),null)};e.serializer.addTempAttr(_r()),e.serializer.addAttributeFilter(n,r=>{for(const a of r)s(a).each(i=>{i.persistent===!1&&(a.name==="span"?a.unwrap():o(a))})})},Ox=()=>{const e={};return{register:(o,r)=>{e[o]={name:o,settings:r}},lookup:o=>Te(e,o).map(r=>r.settings),getNames:()=>Xt(e)}};let Fg=0;const Mg=e=>{const n=new Date().getTime(),s=Math.floor(Math.random()*1e9);return Fg++,e+"_"+s+Fg+String(n)},$x=(e,t)=>{B(t,n=>{gr(e,n)})},Lx=(e,t)=>{B(t,n=>{Sa(e,n)})},Ug=(e,t)=>C.fromDom(e.dom.cloneNode(t)),Ao=e=>Ug(e,!1),zg=e=>Ug(e,!0),Ix=(e,t)=>{const n=C.fromTag(t),s=Rm(e);return Sn(n,s),n},Fx=(e,t)=>{const n=Ix(e,t);ss(e,n);const s=at(e);return Rs(n,s),Fe(e),n},Hg=(e,t,n=Le)=>{const s=new Ve(e,t),o=r=>{let a;do a=s[r]();while(a&&!M(a)&&!n(a));return d.from(a).filter(M)};return{current:()=>d.from(s.current()).filter(M),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},Fs=(e,t)=>{const n=t||(a=>e.isBlock(a)||Ue(a)||Oe(a)),s=(a,i,l,c)=>{if(M(a)){const u=c(a,i,a.data);if(u!==-1)return d.some({container:a,offset:u})}return l().bind(u=>s(u.container,u.offset,l,c))};return{backwards:(a,i,l,c)=>{const u=Hg(a,c,n);return s(a,i,()=>u.prev().map(f=>({container:f,offset:f.length})),l).getOrNull()},forwards:(a,i,l,c)=>{const u=Hg(a,c,n);return s(a,i,()=>u.next().map(f=>({container:f,offset:0})),l).getOrNull()}}},Ro=Math.round,Ms=e=>e?{left:Ro(e.left),top:Ro(e.top),bottom:Ro(e.bottom),right:Ro(e.right),width:Ro(e.width),height:Ro(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},Vg=(e,t)=>(e=Ms(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),Mx=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,Wg=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,Tr=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top?!0:e.top>t.bottom?!1:Wg(t.top-e.bottom,e,t)},Pr=(e,t)=>e.top>t.bottom?!0:e.bottom<t.top?!1:Wg(t.bottom-e.top,e,t),Ux=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,zx=e=>$t(e,(t,n)=>t.fold(()=>d.some(n),s=>{const o=Math.min(n.left,s.left),r=Math.min(n.top,s.top),a=Math.max(n.right,s.right),i=Math.max(n.bottom,s.bottom);return d.some({top:r,right:a,bottom:i,left:o,width:a-o,height:i-r})}),d.none()),jg=(e,t,n)=>{const s=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-s)*(t-s)+(n-o)*(n-o))},Hx=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),Vx=(e,t,n)=>Math.min(Math.max(e,t),n),za=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},us=(e,t)=>{if(Z(e)&&e.hasChildNodes()){const n=e.childNodes,s=Vx(t,0,n.length-1);return n[s]}else return e},Wx=(e,t)=>{if(!(t<0&&Z(e)&&e.hasChildNodes()))return us(e,t)},jx=new RegExp("[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09BE\u09C1-\u09C4\u09CD\u09D7\u09E2-\u09E3\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3E\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B57\u0B62-\u0B63\u0B82\u0BBE\u0BC0\u0BCD\u0BD7\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC2\u0CC6\u0CCC-\u0CCD\u0CD5-\u0CD6\u0CE2-\u0CE3\u0D01\u0D3E\u0D41-\u0D44\u0D4D\u0D57\u0D62-\u0D63\u0DCA\u0DCF\u0DD2-\u0DD4\u0DD6\u0DDF\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u200C-\u200D\u20D0-\u20DC\u20DD-\u20E0\u20E1\u20E2-\u20E4\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u302E-\u302F\u3099-\u309A\uA66F\uA670-\uA672\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFF9E-\uFF9F]"),qg=e=>typeof e=="string"&&e.charCodeAt(0)>=768&&jx.test(e),qx=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},Kx=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},Kg=Z,Gx=tn,Gg=Aa("display","block table"),Yx=Aa("float","left right"),Dr=Kx(Kg,Gx,_l(Yx)),Xx=_l(Aa("white-space","pre pre-line pre-wrap")),Br=M,Cc=Ue,Yg=Re.nodeIndex,Ha=Wx,yc=e=>"createRange"in e?e.createRange():Re.DOM.createRng(),vc=e=>e&&/[\r\n\t ]/.test(e),Xg=e=>!!e.setStart&&!!e.setEnd,Ec=e=>{const t=e.startContainer,n=e.startOffset;if(vc(e.toString())&&Xx(t.parentNode)&&M(t)){const s=t.data;if(vc(s[n-1])||vc(s[n+1]))return!0}return!1},Qx=e=>{const t=e.ownerDocument,n=yc(t),s=t.createTextNode(it),o=e.parentNode;o.insertBefore(s,e),n.setStart(s,0),n.setEnd(s,1);const r=Ms(n.getBoundingClientRect());return o.removeChild(s),r},Zx=e=>{const t=e.startContainer,n=e.endContainer,s=e.startOffset,o=e.endOffset;if(t===n&&M(n)&&s===0&&o===1){const r=e.cloneRange();return r.setEndAfter(n),fs(r)}else return null},Qg=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,fs=e=>{let t;const n=e.getClientRects();return n.length>0?t=Ms(n[0]):t=Ms(e.getBoundingClientRect()),!Xg(e)&&Cc(e)&&Qg(t)?Qx(e):Qg(t)&&Xg(e)?Zx(e):t},Us=(e,t)=>{const n=Vg(e,t);return n.width=1,n.right=n.left+1,n},Jx=e=>{const t=[],n=a=>{a.height!==0&&(t.length>0&&Mx(a,t[t.length-1])||t.push(a))},s=(a,i)=>{const l=yc(a.ownerDocument);if(i<a.data.length){if(qg(a.data[i]))return t;if(qg(a.data[i-1])&&(l.setStart(a,i),l.setEnd(a,i+1),!Ec(l)))return n(Us(fs(l),!1)),t}i>0&&(l.setStart(a,i-1),l.setEnd(a,i),Ec(l)||n(Us(fs(l),!1))),i<a.data.length&&(l.setStart(a,i),l.setEnd(a,i+1),Ec(l)||n(Us(fs(l),!0)))},o=e.container(),r=e.offset();if(Br(o))return s(o,r),t;if(Kg(o))if(e.isAtEnd()){const a=Ha(o,r);Br(a)&&s(a,a.data.length),Dr(a)&&!Cc(a)&&n(Us(fs(a),!1))}else{const a=Ha(o,r);if(Br(a)&&s(a,0),Dr(a)&&e.isAtEnd())return n(Us(fs(a),!1)),t;const i=Ha(e.container(),e.offset()-1);Dr(i)&&!Cc(i)&&(Gg(i)||Gg(a)||!Dr(a))&&n(Us(fs(i),!1)),Dr(a)&&n(Us(fs(a),!0))}return t},N=(e,t,n)=>{const s=()=>(Br(e),t===0),o=()=>Br(e)?t>=e.data.length:t>=e.childNodes.length,r=()=>{const u=yc(e.ownerDocument);return u.setStart(e,t),u.setEnd(e,t),u},a=()=>(n||(n=Jx(N(e,t))),n),i=()=>a().length>0,l=u=>u&&e===u.container()&&t===u.offset(),c=u=>Ha(e,u?t-1:t);return{container:F(e),offset:F(t),toRange:r,getClientRects:a,isVisible:i,isAtStart:s,isAtEnd:o,isEqual:l,getNode:c}};N.fromRangeStart=e=>N(e.startContainer,e.startOffset),N.fromRangeEnd=e=>N(e.endContainer,e.endOffset),N.after=e=>N(e.parentNode,Yg(e)+1),N.before=e=>N(e.parentNode,Yg(e)),N.isAbove=(e,t)=>_t(Lt(t.getClientRects()),lo(e.getClientRects()),Tr).getOr(!1),N.isBelow=(e,t)=>_t(lo(t.getClientRects()),Lt(e.getClientRects()),Pr).getOr(!1),N.isAtStart=e=>e?e.isAtStart():!1,N.isAtEnd=e=>e?e.isAtEnd():!1,N.isTextPosition=e=>e?M(e.container()):!1,N.isElementPosition=e=>N.isTextPosition(e)===!1;const Va=(e,t)=>{M(t)&&t.data.length===0&&e.remove(t)},eN=(e,t,n)=>{t.insertNode(n),Va(e,n.previousSibling),Va(e,n.nextSibling)},tN=(e,t,n)=>{const s=d.from(n.firstChild),o=d.from(n.lastChild);t.insertNode(n),s.each(r=>Va(e,r.previousSibling)),o.each(r=>Va(e,r.nextSibling))},Sc=(e,t,n)=>{Jl(n)?tN(e,t,n):eN(e,t,n)},rn=M,Zg=Ds,Jg=Re.nodeIndex,ep=e=>{const t=e.parentNode;return Zg(t)?ep(t):t},wc=e=>e?ya(e.childNodes,(t,n)=>(Zg(n)&&n.nodeName!=="BR"?t=t.concat(wc(n)):t.push(n),t),[]):[],nN=(e,t)=>{for(;(e=e.previousSibling)&&rn(e);)t+=e.data.length;return t},tp=e=>t=>e===t,sN=e=>{let t,n;t=wc(ep(e)),n=Gd(t,tp(e),e),t=t.slice(0,n+1);const s=ya(t,(o,r,a)=>(rn(r)&&rn(t[a-1])&&o++,o),0);return t=fo(t,en([e.nodeName])),n=Gd(t,tp(e),e),n-s},np=e=>{let t;return rn(e)?t="text()":t=e.nodeName.toLowerCase(),t+"["+sN(e)+"]"},oN=(e,t,n)=>{const s=[];for(t=t.parentNode;t!==e&&!(n&&n(t));t=t.parentNode)s.push(t);return s},sp=(e,t)=>{let n,s,o=[],r,a,i;return n=t.container(),s=t.offset(),rn(n)?r=nN(n,s):(a=n.childNodes,s>=a.length?(r="after",s=a.length-1):r="before",n=a[s]),o.push(np(n)),i=oN(e,n),i=fo(i,_l(Ds)),o=o.concat(Il(i,l=>np(l))),o.reverse().join("/")+","+r},rN=(e,t,n)=>{let s=wc(e);return s=fo(s,(o,r)=>!rn(o)||!rn(s[r-1])),s=fo(s,en([t])),s[n]},aN=(e,t)=>{let n=e,s=0,o;for(;rn(n);){if(o=n.data.length,t>=s&&t<=s+o){e=n,t=t-s;break}if(!rn(n.nextSibling)){e=n,t=o;break}s+=o,n=n.nextSibling}return rn(e)&&t>e.data.length&&(t=e.data.length),N(e,t)},op=(e,t)=>{let n;if(!t)return null;const s=t.split(","),o=s[0].split("/");n=s.length>1?s[1]:"before";const r=ya(o,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),rN(a,l[1],parseInt(l[2],10))):null},e);return r?rn(r)?aN(r,parseInt(n,10)):(n==="after"?n=Jg(r)+1:n=Jg(r),N(r.parentNode,n)):null},Wa=Oe,iN=(e,t,n)=>{let s,o;for(o=e(t.data.slice(0,n)).length,s=t.previousSibling;s&&M(s);s=s.previousSibling)o+=e(s.data).length;return o},rp=(e,t,n,s,o)=>{let r=s[o?"startContainer":"endContainer"],a=s[o?"startOffset":"endOffset"];const i=[];let l,c=0;const u=e.getRoot();for(M(r)?i.push(n?iN(t,r,a):a):(l=r.childNodes,a>=l.length&&l.length&&(c=1,a=Math.max(0,l.length-1)),i.push(e.nodeIndex(l[a],n)+c));r&&r!==u;r=r.parentNode)i.push(e.nodeIndex(r,n));return i},lN=(e,t,n,s)=>{const o=t.dom,r=rp(o,e,n,s,!0),a=t.isForward(),i=gg(s)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:r,forward:a,...i};{const l=rp(o,e,n,s,!1);return{start:r,end:l,forward:a,...i}}},kc=(e,t,n)=>{let s=0;return D.each(e.select(t),o=>{if(o.getAttribute("data-mce-bogus")!=="all"){if(o===n)return!1;s++}}),s},ap=(e,t)=>{let n,s;const o=t?"start":"end";if(n=e[o+"Container"],s=e[o+"Offset"],Z(n)&&n.nodeName==="TR"){const r=n.childNodes;n=r[Math.min(t?s:s-1,r.length-1)],n&&(s=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,s))}},ip=e=>(ap(e,!0),ap(e,!1),e),lp=(e,t)=>{let n;if(Z(e)&&(e=us(e,t),Wa(e)))return e;if(Ht(e)&&(M(e)&&So(e)&&(e=e.parentNode),n=e.previousSibling,Wa(n)||(n=e.nextSibling,Wa(n))))return n},cN=e=>lp(e.startContainer,e.startOffset)||lp(e.endContainer,e.endOffset),cp=(e,t,n)=>{const s=n.getNode();let o=s?s.nodeName:null;const r=n.getRng();if(Wa(s)||o==="IMG")return{name:o,index:kc(n.dom,o,s)};const a=cN(r);return a?(o=a.tagName,{name:o,index:kc(n.dom,o,a)}):lN(e,n,t,r)},uN=e=>{const t=e.getRng();return{start:sp(e.dom.getRoot(),N.fromRangeStart(t)),end:sp(e.dom.getRoot(),N.fromRangeEnd(t)),forward:e.isForward()}},fN=e=>({rng:e.getRng(),forward:e.isForward()}),up=(e,t,n)=>{const s={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",s,"&#xFEFF;"):e.create("span",s)},fp=(e,t)=>{const n=e.dom;let s=e.getRng();const o=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if(i==="IMG")return{name:i,index:kc(n,i,a)};const c=ip(s.cloneRange());if(!r){c.collapse(!1);const f=up(n,o+"_end",t);Sc(n,c,f)}s=ip(s),s.collapse(!0);const u=up(n,o+"_start",t);return Sc(n,s,u),e.moveToBookmark({id:o,keep:!0,forward:l}),{id:o,forward:l}},dN=(e,t,n)=>t===2?cp(rs,n,e):t===3?uN(e):t?fN(e):fp(e,!1),dp=V(cp,bt,!0),mp=e=>{const t=r=>r(e),n=F(e),s=()=>o,o={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:je,isError:Le,map:r=>Ct.value(r(e)),mapError:s,bind:t,exists:t,forall:t,getOr:n,or:s,getOrThunk:n,orThunk:s,getOrDie:n,each:r=>{r(e)},toOptional:()=>d.some(e)};return o},gp=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(s,o)=>s(e),isValue:Le,isError:je,map:t,mapError:s=>Ct.error(s(e)),bind:t,exists:Le,forall:je,getOr:bt,or:bt,getOrThunk:Al,orThunk:Al,getOrDie:$0(String(e)),each:me,toOptional:d.none};return n},Ct={value:mp,error:gp,fromOption:(e,t)=>e.fold(()=>gp(t),mp)},_n={generate:e=>{if(!Ge(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return B(e,(s,o)=>{const r=Xt(s);if(r.length!==1)throw new Error("one and only one name per case");const a=r[0],i=s[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Ge(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...f)=>{if(f.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+f.length);return f[o].apply(null,l)},match:f=>{const m=Xt(f);if(t.length!==m.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+m.join(","));if(!io(t,h=>De(m,h)))throw new Error("Not all branches were specified when using match. Specified: "+m.join(", ")+`
Required: `+t.join(", "));return f[a].apply(null,l)},log:f=>{console.log(f,{constructors:t,constructor:a,params:l})}}}}),n}};_n.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const mN=e=>{const t=[],n=[];return B(e,s=>{s.fold(o=>{t.push(o)},o=>{n.push(o)})}),{errors:t,values:n}},gN=e=>e.type==="inline-command"||e.type==="inline-format",pN=e=>e.type==="block-command"||e.type==="block-format",hN=e=>ar(e,(t,n)=>t.start.length===n.start.length?0:t.start.length>n.start.length?-1:1),bN=e=>{const t=s=>Ct.error({message:s,pattern:e}),n=(s,o,r)=>{if(e.format!==void 0){let a;if(Ge(e.format)){if(!io(e.format,ne))return t(s+" pattern has non-string items in the `format` array");a=e.format}else if(ne(e.format))a=[e.format];else return t(s+" pattern has non-string `format` parameter");return Ct.value(o(a))}else return e.cmd!==void 0?ne(e.cmd)?Ct.value(r(e.cmd,e.value)):t(s+" pattern has non-string `cmd` parameter"):t(s+" pattern is missing both `format` and `cmd` parameters")};if(!Ot(e))return t("Raw pattern is not an object");if(!ne(e.start))return t("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!ne(e.end))return t("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return t("Inline pattern has empty `start` and `end` parameters");let s=e.start,o=e.end;return o.length===0&&(o=s,s=""),n("Inline",r=>({type:"inline-format",start:s,end:o,format:r}),(r,a)=>({type:"inline-command",start:s,end:o,cmd:r,value:a}))}else return e.replacement!==void 0?ne(e.replacement)?e.start.length===0?t("Replacement pattern has empty `start` parameter"):Ct.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):t("Replacement pattern has non-string `replacement` parameter"):e.start.length===0?t("Block pattern has empty `start` parameter"):n("Block",s=>({type:"block-format",start:e.start,format:s[0]}),(s,o)=>({type:"block-command",start:e.start,cmd:s,value:o}))},CN=e=>hN(re(e,pN)),pp=e=>re(e,gN),yN=e=>({inlinePatterns:pp(e),blockPatterns:CN(e)}),vN=e=>{const t=mN(Ee(e,bN));return B(t.errors,n=>console.error(n.message,n.pattern)),t.values},xc=xs().deviceType,EN=xc.isTouch(),SN=Re.DOM,wN=e=>{const t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return $t(t,(n,s)=>{const o=s.split("="),r=o[0],a=o.length>1?o[1]:r;return n[mo(r)]=mo(a),n},{})},hp=e=>ba(e,RegExp),W=e=>t=>t.options.get(e),Nc=e=>ne(e)||Ot(e),bp=(e,t="")=>n=>{const s=ne(n);if(s)if(n.indexOf("=")!==-1){const o=wN(n);return{value:Te(o,e.id).getOr(t),valid:s}}else return{value:n,valid:s};else return{valid:!1,message:"Must be a string."}},kN=e=>{const t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean"}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:bp(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:bp(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:n=>{const s=ne(n)&&zn(n);return s?{value:n,valid:s}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:n=>{const s=De(["block","linebreak","invert","default"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:n=>Ss(n)?{valid:!0,value:n}:ne(n)?{valid:!0,value:n}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:n=>{const s=n===!1||ne(n)||ao(n,ne);return s?ne(n)?{value:Ee(n.split(","),mo),valid:s}:Ge(n)?{value:n,valid:s}:n===!1?{value:[],valid:s}:{value:n,valid:s}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Rc(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:n=>{const s=ne(n)||ao(n,ne);return s?{value:Ge(n)?n:Ee(n.split(","),mo),valid:s}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:n=>{const s=Ss(n)||ne(n);return s?n===!1||xc.isiPhone()||xc.isiPad()?{value:"",valid:s}:{value:n===!0?"table,img,figure.image,div,video,iframe":n,valid:s}:{valid:!1,message:"Must be boolean or a string"}},default:!EN}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"object"}),t("service_message",{processor:"string"}),t("theme",{processor:n=>n===!1||ne(n)||_e(n),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("preview_styles",{processor:n=>{const s=n===!1||ne(n);return s?{value:n===!1?"":n,valid:s}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean"}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:"string"}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:Nc}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:Nc}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:Nc}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:n=>ne(n)||n===!0}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:n=>ao(n,Ot)||n===!1?{value:vN(n===!1?[]:n),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:n=>ao(n,hp)?{value:n,valid:!0}:hp(n)?{value:[n],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:on.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:SN.getAttrib(e.getElement(),"placeholder")})})},xN=W("iframe_attrs"),NN=W("doctype"),Cp=W("document_base_url"),_N=W("body_id"),AN=W("body_class"),yp=W("content_security_policy"),RN=W("br_in_pre"),Rt=W("forced_root_block"),zs=W("forced_root_block_attrs"),TN=W("newline_behavior"),PN=W("br_newline_selector"),DN=W("no_newline_selector"),BN=W("keep_styles"),ON=W("end_container_on_empty_block"),vp=W("automatic_uploads"),Ep=W("images_reuse_filename"),$N=W("images_replace_blob_uris"),Sp=W("icons"),LN=W("icons_url"),IN=W("images_upload_url"),FN=W("images_upload_base_path"),MN=W("images_upload_credentials"),UN=W("images_upload_handler"),zN=W("content_css_cors"),_c=W("referrer_policy"),wp=W("language"),HN=W("language_url"),kp=W("indent_use_margin"),VN=W("indentation"),WN=W("content_css"),jN=W("content_style"),xp=W("font_css"),qN=W("directionality"),KN=W("inline_boundaries_selector"),Np=W("object_resizing"),GN=W("resize_img_proportional"),YN=W("placeholder"),_p=W("event_root"),XN=W("service_message"),To=W("theme"),QN=W("theme_url"),Ac=W("model"),ZN=W("model_url"),Or=W("inline_boundaries"),JN=W("formats"),e_=W("preview_styles"),t_=W("format_empty_lines"),n_=W("custom_ui_selector"),Rc=W("inline"),s_=W("hidden_input"),o_=W("submit_patch"),r_=W("add_form_submit_trigger"),a_=W("add_unload_trigger"),i_=W("custom_undo_redo_levels"),l_=W("disable_nodechange"),Ap=W("readonly"),c_=W("content_css_cors"),ja=W("plugins"),u_=W("external_plugins"),f_=W("block_unsupported_drop"),d_=W("visual"),m_=W("visual_table_class"),Rp=W("visual_anchor_class"),g_=W("iframe_aria_text"),p_=W("setup"),h_=W("init_instance_callback"),b_=W("urlconverter_callback"),C_=W("auto_focus"),y_=W("browser_spellcheck"),v_=W("protect"),E_=W("paste_block_drop"),qa=W("paste_data_images"),S_=W("paste_preprocess"),w_=W("paste_postprocess"),k_=W("paste_webkit_styles"),x_=W("paste_remove_styles_if_webkit"),N_=W("paste_merge_formats"),__=W("smart_paste"),A_=W("paste_as_text"),R_=W("paste_tab_spaces"),T_=W("allow_html_data_urls"),Tp=W("text_patterns"),Pp=W("noneditable_class"),P_=W("editable_class"),D_=W("noneditable_regexp"),B_=e=>D.explode(e.options.get("font_size_style_values")),O_=e=>D.explode(e.options.get("font_size_classes")),$_=e=>e.options.get("encoding")==="xml",Dp=e=>D.explode(e.options.get("images_file_types")),L_=W("table_tab_navigation"),I_=Z,Bp=M,Op=e=>{const t=e.parentNode;t&&t.removeChild(e)},$p=e=>{const t=rs(e);return{count:e.length-t.length,text:t}},Lp=e=>{let t;for(;(t=e.data.lastIndexOf(tt))!==-1;)e.deleteData(t,1)},Ip=(e,t)=>(Hs(e),t),F_=(e,t)=>{const n=$p(e.data.substr(0,t.offset())),s=$p(e.data.substr(t.offset()));return(n.text+s.text).length>0?(Lp(e),N(e,t.offset()-n.count)):t},M_=(e,t)=>{const n=t.container(),s=F0(Nt(n.childNodes),e).map(o=>o<t.offset()?N(n,t.offset()-1):t).getOr(t);return Hs(e),s},U_=(e,t)=>Bp(e)&&t.container()===e?F_(e,t):Ip(e,t),z_=(e,t)=>t.container()===e.parentNode?M_(e,t):Ip(e,t),H_=(e,t)=>N.isTextPosition(t)?U_(e,t):z_(e,t),Hs=e=>{I_(e)&&Ht(e)&&(mg(e)?e.removeAttribute("data-mce-caret"):Op(e)),Bp(e)&&(Lp(e),e.data.length===0&&Op(e))},V_=Oe,W_=Nn,j_=Ra,q_="*[contentEditable=false],video,audio,embed,object",Fp=(e,t,n)=>{const s=Vg(t.getBoundingClientRect(),n);let o,r;if(e.tagName==="BODY"){const i=e.ownerDocument.documentElement;o=e.scrollLeft||i.scrollLeft,r=e.scrollTop||i.scrollTop}else{const i=e.getBoundingClientRect();o=e.scrollLeft-i.left,r=e.scrollTop-i.top}s.left+=o,s.right+=o,s.top+=r,s.bottom+=r,s.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},K_=e=>{const t=At(C.fromDom(e),q_);for(let n=0;n<t.length;n++){const s=t[n].dom;let o=s.previousSibling;if(Oa(o)){const r=o.data;r.length===1?o.parentNode.removeChild(o):o.deleteData(r.length-1,1)}o=s.nextSibling,Ba(o)&&(o.data.length===1?o.parentNode.removeChild(o):o.deleteData(0,1))}},G_=(e,t,n,s)=>{const o=cs();let r,a;const i=Rt(e),l=e.dom,c=(p,b)=>{let y;if(u(),j_(b))return null;if(n(b)){a=Tk(i,b,p);const E=Fp(t,b,p);l.setStyle(a,"top",E.top);const S=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(S,{...E}),l.add(t,S),o.set({caret:S,element:b,before:p}),p&&l.addClass(S,"mce-visual-caret-before"),f(),y=b.ownerDocument.createRange(),y.setStart(a,0),y.setEnd(a,0)}else return a=Ak(b,p),y=b.ownerDocument.createRange(),$r(a.nextSibling)?(y.setStart(a,0),y.setEnd(a,0)):(y.setStart(a,1),y.setEnd(a,1)),y;return y},u=()=>{K_(t),a&&(Hs(a),a=null),o.on(p=>{l.remove(p.caret),o.clear()}),r&&(clearInterval(r),r=void 0)},f=()=>{r=setInterval(()=>{o.on(p=>{s()?l.toggleClass(p.caret,"mce-visual-caret-hidden"):l.addClass(p.caret,"mce-visual-caret-hidden")})},500)};return{show:c,hide:u,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{o.on(p=>{const b=Fp(t,p.element,p.before);l.setStyles(p.caret,{...b})})},destroy:()=>clearInterval(r)}},Mp=()=>Se.browser.isFirefox(),$r=e=>V_(e)||W_(e),Lr=e=>$r(e)||yr(e)&&Mp(),Y_=xn,Tc=Oe,X_=Nn,Up=Aa("display","block table table-cell table-caption list-item"),zp=Ht,Hp=So,Vp=Z,Q_=tn,Po=e=>e>0,Vs=e=>e<0,Ka=(e,t)=>{let n;for(;n=e(t);)if(!Hp(n))return n;return null},Ir=(e,t,n,s,o)=>{const r=new Ve(e,s),a=Tc(e)||Hp(e);if(Vs(t)){if(a&&(e=Ka(r.prev.bind(r),!0),n(e)))return e;for(;e=Ka(r.prev.bind(r),o);)if(n(e))return e}if(Po(t)){if(a&&(e=Ka(r.next.bind(r),!0),n(e)))return e;for(;e=Ka(r.next.bind(r),o);)if(n(e))return e}return null},Z_=(e,t)=>{const n=o=>Y_(o.dom),s=o=>o.dom===t;return Co(C.fromDom(e),n,s).map(o=>o.dom).getOr(t)},ds=(e,t)=>{for(;e&&e!==t;){if(Up(e))return e;e=e.parentNode}return null},An=(e,t,n)=>ds(e.container(),n)===ds(t.container(),n),Pc=(e,t)=>{if(!t)return null;const n=t.container(),s=t.offset();return Vp(n)?n.childNodes[s+e]:null},Wp=(e,t)=>{const n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},J_=(e,t,n)=>ds(t,e)===ds(n,e),jp=(e,t,n)=>{const s=e?"previousSibling":"nextSibling";for(;n&&n!==t;){let o=n[s];if(zp(o)&&(o=o[s]),Tc(o)||X_(o)){if(J_(t,o,n))return o;break}if(Q_(o))break;n=n.parentNode}return null},Fr=V(Wp,!0),Mr=V(Wp,!1),Dc=(e,t,n)=>{let s;const o=V(jp,!0,t),r=V(jp,!1,t);let a=n.startContainer;const i=n.startOffset;if(So(a)){Vp(a)||(a=a.parentNode);const l=a.getAttribute("data-mce-caret");if(l==="before"&&(s=a.nextSibling,Lr(s)))return Fr(s);if(l==="after"&&(s=a.previousSibling,Lr(s)))return Mr(s)}if(!n.collapsed)return n;if(M(a)){if(zp(a)){if(e===1){if(s=r(a),s)return Fr(s);if(s=o(a),s)return Mr(s)}if(e===-1){if(s=o(a),s)return Mr(s);if(s=r(a),s)return Fr(s)}return n}if(Oa(a)&&i>=a.data.length-1)return e===1&&(s=r(a),s)?Fr(s):n;if(Ba(a)&&i<=1)return e===-1&&(s=o(a),s)?Mr(s):n;if(i===a.data.length)return s=r(a),s?Fr(s):n;if(i===0)return s=o(a),s?Mr(s):n}return n},qp=(e,t)=>d.from(Pc(e?0:-1,t)).filter(Tc),Ur=(e,t,n)=>{const s=Dc(e,t,n);return e===-1?N.fromRangeStart(s):N.fromRangeEnd(s)},Ga=e=>d.from(e.getNode()).map(C.fromDom),eA=e=>d.from(e.getNode(!0)).map(C.fromDom),Bc=(e,t)=>{for(;t=e(t);)if(t.isVisible())return t;return t},Ya=(e,t)=>{const n=An(e,t);return!n&&Ue(e.getNode())?!0:n};var Ke;(function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"})(Ke||(Ke={}));const tA=Oe,Rn=M,Kp=Z,Oc=Ue,Do=tn,Gp=zk,Xa=bg,nA=(e,t)=>{const n=[];for(;e&&e!==t;)n.push(e),e=e.parentNode;return n},Yp=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,Xp=(e,t)=>{if(Po(e)){if(Do(t.previousSibling)&&!Rn(t.previousSibling))return N.before(t);if(Rn(t))return N(t,0)}if(Vs(e)){if(Do(t.nextSibling)&&!Rn(t.nextSibling))return N.after(t);if(Rn(t))return N(t,t.data.length)}return Vs(e)?Oc(t)?N.before(t):N.after(t):N.before(t)},sA=(e,t)=>{const n=t.nextSibling;return n&&Do(n)?Rn(n)?N(n,0):N.before(n):$c(Ke.Forwards,N.after(t),e)},$c=(e,t,n)=>{let s,o,r,a;if(!Kp(n)||!t)return null;if(t.isEqual(N.after(n))&&n.lastChild){if(a=N.after(n.lastChild),Vs(e)&&Do(n.lastChild)&&Kp(n.lastChild))return Oc(n.lastChild)?N.before(n.lastChild):a}else a=t;const i=a.container();let l=a.offset();if(Rn(i)){if(Vs(e)&&l>0)return N(i,--l);if(Po(e)&&l<i.length)return N(i,++l);s=i}else{if(Vs(e)&&l>0&&(o=Yp(i,l-1),Do(o)))return!Gp(o)&&(r=Ir(o,e,Xa,o),r)?Rn(r)?N(r,r.data.length):N.after(r):Rn(o)?N(o,o.data.length):N.before(o);if(Po(e)&&l<i.childNodes.length&&(o=Yp(i,l),Do(o)))return Oc(o)?sA(n,o):!Gp(o)&&(r=Ir(o,e,Xa,o),r)?Rn(r)?N(r,0):N.before(r):Rn(o)?N(o,0):N.after(o);s=o||a.getNode()}if((Po(e)&&a.isAtEnd()||Vs(e)&&a.isAtStart())&&(s=Ir(s,e,je,n,!0),Xa(s,n)))return Xp(e,s);o=Ir(s,e,Xa,n);const c=ts(re(nA(i,n),tA));return c&&(!o||!c.contains(o))?(Po(e)?a=N.after(c):a=N.before(c),a):o?Xp(e,o):null},Tn=e=>({next:t=>$c(Ke.Forwards,t,e),prev:t=>$c(Ke.Backwards,t,e)}),oA=(e,t,n)=>{const s=e?N.before(n):N.after(n);return Vt(e,t,s)},rA=e=>Ue(e)?N.before(e):N.after(e),Qp=e=>N.isTextPosition(e)?e.offset()===0:tn(e.getNode()),Zp=e=>{if(N.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}else return tn(e.getNode(!0))},Jp=(e,t)=>!N.isTextPosition(e)&&!N.isTextPosition(t)&&e.getNode()===t.getNode(!0),aA=e=>!N.isTextPosition(e)&&Ue(e.getNode()),iA=(e,t,n)=>e?!Jp(t,n)&&!aA(t)&&Zp(t)&&Qp(n):!Jp(n,t)&&Qp(t)&&Zp(n),Vt=(e,t,n)=>{const s=Tn(t);return d.from(e?s.next(n):s.prev(n))},Qa=(e,t,n)=>Vt(e,t,n).bind(s=>An(n,s,t)&&iA(e,n,s)?Vt(e,t,s):d.some(s)),eh=(e,t,n,s)=>Qa(e,t,n).bind(o=>s(o)?eh(e,t,o,s):d.some(o)),Bo=(e,t)=>{const n=e?t.firstChild:t.lastChild;return M(n)?d.some(N(n,e?0:n.data.length)):n?tn(n)?d.some(e?N.before(n):rA(n)):oA(e,t,n):d.none()},Wt=V(Vt,!0),an=V(Vt,!1),yt=V(Bo,!0),Pn=V(Bo,!1),th="_mce_caret",Dn=e=>Z(e)&&e.id===th,Ws=(e,t)=>{for(;t&&t!==e;){if(t.id===th)return t;t=t.parentNode}return null},lA=e=>ne(e.start),cA=e=>fe(e,"rng"),uA=e=>fe(e,"id"),nh=e=>fe(e,"name"),sh=e=>D.isArray(e.start),Za=e=>!nh(e)&&Ss(e.forward)?e.forward:!0,oh=(e,t)=>(Z(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),fA=(e,t)=>{const n=e.createRng(),s=op(e.getRoot(),t.start);n.setStart(s.container(),s.offset());const o=op(e.getRoot(),t.end);return n.setEnd(o.container(),o.offset()),{range:n,forward:Za(t)}},dA=(e,t)=>{const n=e.ownerDocument.createTextNode(tt);e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)},mA=e=>e.hasChildNodes()===!1,gA=(e,t)=>Pn(e).fold(Le,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),rh=(e,t,n)=>mA(t)&&Ws(e,t)?(dA(t,n),!0):!1,ah=(e,t,n,s)=>{const o=n[t?"start":"end"];let r,a,i,l;const c=e.getRoot();if(o){for(i=o[0],a=c,r=o.length-1;r>=1;r--){if(l=a.childNodes,rh(c,a,s))return!0;if(o[r]>l.length-1)return rh(c,a,s)?!0:gA(a,s);a=l[o[r]]}a.nodeType===3&&(i=Math.min(o[0],a.nodeValue.length)),a.nodeType===1&&(i=Math.min(o[0],a.childNodes.length)),t?s.setStart(a,i):s.setEnd(a,i)}return!0},Lc=e=>M(e)&&e.data.length>0,ih=(e,t,n)=>{let s=e.get(n.id+"_"+t),o,r,a,i;const l=n.keep;let c,u;if(s){if(o=s.parentNode,t==="start"?(l?s.hasChildNodes()?(o=s.firstChild,r=1):Lc(s.nextSibling)?(o=s.nextSibling,r=0):Lc(s.previousSibling)?(o=s.previousSibling,r=s.previousSibling.data.length):(o=s.parentNode,r=e.nodeIndex(s)+1):r=e.nodeIndex(s),c=o,u=r):(l?s.hasChildNodes()?(o=s.firstChild,r=1):Lc(s.previousSibling)?(o=s.previousSibling,r=s.previousSibling.data.length):(o=s.parentNode,r=e.nodeIndex(s)):r=e.nodeIndex(s),c=o,u=r),!l){for(i=s.previousSibling,a=s.nextSibling,D.each(D.grep(s.childNodes),f=>{M(f)&&(f.nodeValue=f.nodeValue.replace(/\uFEFF/g,""))});s=e.get(n.id+"_"+t);)e.remove(s,!0);i&&a&&i.nodeType===a.nodeType&&M(i)&&!Se.browser.isOpera()&&(r=i.nodeValue.length,i.appendData(a.nodeValue),e.remove(a),c=i,u=r)}return d.some(N(c,u))}else return d.none()},pA=(e,t)=>{const n=e.createRng();return ah(e,!0,t,n)&&ah(e,!1,t,n)?d.some({range:n,forward:Za(t)}):d.none()},hA=(e,t)=>{const n=ih(e,"start",t),s=ih(e,"end",t);return _t(n,s.or(n),(o,r)=>{const a=e.createRng();return a.setStart(oh(e,o.container()),o.offset()),a.setEnd(oh(e,r.container()),r.offset()),{range:a,forward:Za(t)}})},bA=(e,t)=>d.from(e.select(t.name)[t.index]).map(n=>{const s=e.createRng();return s.selectNode(n),{range:s,forward:!0}}),CA=(e,t)=>{const n=e.dom;if(t){if(sh(t))return pA(n,t);if(lA(t))return d.some(fA(n,t));if(uA(t))return hA(n,t);if(nh(t))return bA(n,t);if(cA(t))return d.some({range:t.rng,forward:Za(t)})}return d.none()},yA=(e,t,n)=>dN(e,t,n),vA=(e,t)=>{CA(e,t).each(({range:n,forward:s})=>{e.setRng(n,s)})},jt=e=>Z(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",Ja=(e=>t=>e===t)(it),zr=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,Ic=e=>!zr(e)&&!Ja(e)&&!dg(e),EA=e=>({value:e}),Fc=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},SA=e=>{const t=Fc(e.red)+Fc(e.green)+Fc(e.blue);return EA(t)},wA=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,kA=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,lh=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),ch=(e,t,n,s)=>{const o=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),i=parseFloat(s);return lh(o,r,a,i)},xA=e=>{if(e==="transparent")return d.some(lh(0,0,0,0));const t=wA.exec(e);if(t!==null)return d.some(ch(t[1],t[2],t[3],"1"));const n=kA.exec(e);return n!==null?d.some(ch(n[1],n[2],n[3],n[4])):d.none()},ei=e=>xA(e).map(SA).map(t=>"#"+t.value).getOr(e),ti=e=>!!e.nodeType,NA=e=>e&&/^(IMG)$/.test(e.nodeName),uh=(e,t,n)=>{const s=n.startOffset;let o=n.startContainer;if(!(o===n.endContainer&&NA(o.childNodes[s]))&&Z(o)){const r=o.childNodes;let a;s<r.length?(o=r[s],a=new Ve(o,e.getParent(o,e.isBlock))):(o=r[r.length-1],a=new Ve(o,e.getParent(o,e.isBlock)),a.next(!0));for(let i=a.current();i;i=a.next())if(M(i)&&!Uc(i)){n.setStart(i,0),t.setRng(n);return}}},fh=(e,t,n)=>{if(e){const s=t?"nextSibling":"previousSibling";for(e=n?e:e[s];e;e=e[s])if(Z(e)||!Uc(e))return e}},Mc=(e,t)=>(ti(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]),Oo=(e,t,n)=>e.schema.isValidChild(t,n),Uc=(e,t=!1)=>{if(oe(e)&&M(e)){const n=t?e.data.replace(/ /g,"\xA0"):e.data;return Os(n)}else return!1},_A=e=>oe(e)&&M(e)&&e.length===0,jn=(e,t)=>(_e(e)?e=e(t):oe(t)&&(e=e.replace(/%(\w+)/g,(n,s)=>t[s]||n)),e),zc=(e,t)=>(e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),Hc=(e,t)=>((t==="color"||t==="backgroundColor")&&(e=ei(e)),t==="fontWeight"&&e===700&&(e="bold"),t==="fontFamily"&&(e=e.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+e),ni=(e,t,n)=>Hc(e.getStyle(t,n),n),dh=(e,t)=>{let n;return e.getParent(t,s=>(n=e.getStyle(s,"text-decoration"),n&&n!=="none")),n},si=(e,t,n)=>e.getParents(t,n,e.getRoot()),AA=(e,t)=>{const n=s=>{const o=r=>r.length>1&&r.charAt(0)==="%";return Me(["styles","attributes"],r=>Te(s,r).exists(a=>{const i=Ge(a)?a:$l(a);return Me(i,o)}))};return Me(e.formatter.get(t),n)},RA=(e,t,n)=>{const s=["inline","block","selector","attributes","styles","classes"],o=r=>lr(r,(a,i)=>Me(s,l=>l===i));return Me(e.formatter.get(t),r=>{const a=o(r);return Me(e.formatter.get(n),i=>{const l=o(i);return V0(a,l)})})},Bn=e=>uo(e,"block"),It=e=>uo(e,"selector"),Ze=e=>uo(e,"inline"),TA=e=>It(e)&&Ze(e)&&go(Te(e,"mixed"),!0),Vc=e=>It(e)&&e.expand!==!1&&!Ze(e),$o=jt,mh=si,gh=Uc,PA=Mc,DA=e=>Ue(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,ph=(e,t)=>{let n=t;for(;n;){if(Z(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},hh=(e,t,n,s)=>{const o=t.data;for(let r=n;e?r>=0:r<o.length;e?r--:r++)if(s(o.charAt(r)))return e?r+1:r;return-1},BA=(e,t,n)=>hh(e,t,n,s=>Ja(s)||zr(s)),OA=(e,t,n)=>hh(e,t,n,Ic),bh=(e,t,n,s,o,r)=>{let a;const i=e.getParent(n,e.isBlock)||t,l=(u,f,m)=>{const g=Fs(e),h=o?g.backwards:g.forwards;return d.from(h(u,f,(p,b)=>$o(p.parentNode)?-1:(a=p,m(o,p,b)),i))};return l(n,s,BA).bind(u=>r?l(u.container,u.offset+(o?-1:0),OA):d.some(u)).orThunk(()=>a?d.some({container:a,offset:o?0:a.length}):d.none())},Ch=(e,t,n,s,o)=>{M(s)&&va(s.data)&&s[o]&&(s=s[o]);const r=mh(e,s);for(let a=0;a<r.length;a++)for(let i=0;i<t.length;i++){const l=t[i];if(!(oe(l.collapsed)&&l.collapsed!==n.collapsed)&&It(l)&&e.is(r[a],l.selector))return r[a]}return s},yh=(e,t,n,s)=>{let o=n;const r=e.dom,a=r.getRoot(),i=t[0];if(Bn(i)&&(o=i.wrapper?null:r.getParent(n,i.block,a)),!o){const l=r.getParent(n,"LI,TD,TH");o=r.getParent(M(n)?n.parentNode:n,c=>c!==a&&PA(e,c),l)}if(o&&Bn(i)&&i.wrapper&&(o=mh(r,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[s]&&!r.isBlock(o[s])&&(o=o[s],!zc(o,"br")););return o||n},vh=(e,t,n,s)=>{const o=n.parentNode;return oe(n[s])?!1:o===t||xt(o)||e.isBlock(o)?!0:vh(e,t,o,s)},oi=(e,t,n,s,o)=>{let r=n;const a=o?"previousSibling":"nextSibling",i=e.getRoot();if(M(n)&&!gh(n)&&(o?s>0:s<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(r))return r;for(let l=r[a];l;l=l[a]){const c=M(l)&&!vh(e,i,l,a);if(!$o(l)&&!DA(l)&&!gh(l,c))return r}if(r===i||r.parentNode===i){n=r;break}r=r.parentNode}return n},Eh=e=>$o(e.parentNode)||$o(e),Lo=(e,t,n,s=!1)=>{let{startContainer:o,startOffset:r,endContainer:a,endOffset:i}=t;const l=e.dom,c=n[0];return Z(o)&&o.hasChildNodes()&&(o=us(o,r),M(o)&&(r=0)),Z(a)&&a.hasChildNodes()&&(a=us(a,t.collapsed?i:i-1),M(a)&&(i=a.nodeValue.length)),o=ph(l,o),a=ph(l,a),Eh(o)&&(o=$o(o)?o:o.parentNode,t.collapsed?o=o.previousSibling||o:o=o.nextSibling||o,M(o)&&(r=t.collapsed?o.length:0)),Eh(a)&&(a=$o(a)?a:a.parentNode,t.collapsed?a=a.nextSibling||a:a=a.previousSibling||a,M(a)&&(i=t.collapsed?0:a.length)),t.collapsed&&(bh(l,e.getBody(),o,r,!0,s).each(({container:m,offset:g})=>{o=m,r=g}),bh(l,e.getBody(),a,i,!1,s).each(({container:m,offset:g})=>{a=m,i=g})),(Ze(c)||c.block_expand)&&((!Ze(c)||!M(o)||r===0)&&(o=oi(l,n,o,r,!0)),(!Ze(c)||!M(a)||i===a.nodeValue.length)&&(a=oi(l,n,a,i,!1))),Vc(c)&&(o=Ch(l,n,t,o,"previousSibling"),a=Ch(l,n,t,a,"nextSibling")),(Bn(c)||It(c))&&(o=yh(e,n,o,"previousSibling"),a=yh(e,n,a,"nextSibling"),Bn(c)&&(l.isBlock(o)||(o=oi(l,n,o,r,!0)),l.isBlock(a)||(a=oi(l,n,a,i,!1)))),Z(o)&&(r=l.nodeIndex(o),o=o.parentNode),Z(a)&&(i=l.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:r,endContainer:a,endOffset:i}},Hr=(e,t,n)=>{const s=t.startOffset,o=us(t.startContainer,s),r=t.endOffset,a=us(t.endContainer,r-1),i=p=>{const b=p[0];M(b)&&b===o&&s>=b.data.length&&p.splice(0,1);const y=p[p.length-1];return r===0&&p.length>0&&y===a&&M(y)&&p.splice(p.length-1,1),p},l=(p,b,y)=>{const E=[];for(;p&&p!==y;p=p[b])E.push(p);return E},c=(p,b)=>e.getParent(p,y=>y.parentNode===b,b),u=(p,b,y)=>{const E=y?"nextSibling":"previousSibling";for(let S=p,x=S.parentNode;S&&S!==b;S=x){x=S.parentNode;const _=l(S===p?S:S[E],E);_.length&&(y||_.reverse(),n(i(_)))}};if(o===a)return n(i([o]));const f=e.findCommonAncestor(o,a);if(e.isChildOf(o,a))return u(o,f,!0);if(e.isChildOf(a,o))return u(a,f);const m=c(o,f)||o,g=c(a,f)||a;u(o,m,!0);const h=l(m===o?m:m.nextSibling,"nextSibling",g===a?g.nextSibling:g);h.length&&n(i(h)),u(a,g)},Wc=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},$A=e=>Un(e,t=>{const n=za(t);return n?[C.fromDom(n)]:[]}),LA=e=>Wc(e).length>1,IA=e=>re($A(e),Ta),FA=e=>At(e,"td[data-mce-selected],th[data-mce-selected]"),Sh=(e,t)=>{const n=FA(t);return n.length>0?n:IA(e)},Io=e=>Sh(Wc(e.selection.getSel()),C.fromDom(e.getBody())),Vr=(e,t)=>vr(e,"table",t),MA=e=>{const t=e.startContainer,n=e.startOffset;return M(t)?n===0?d.some(C.fromDom(t)):d.none():d.from(t.childNodes[n]).map(C.fromDom)},UA=e=>{const t=e.endContainer,n=e.endOffset;return M(t)?n===t.data.length?d.some(C.fromDom(t)):d.none():d.from(t.childNodes[n-1]).map(C.fromDom)},wh=e=>Um(e).fold(F([e]),t=>[e].concat(wh(t))),jc=e=>jl(e).fold(F([e]),t=>Be(t)==="br"?_s(t).map(n=>[e].concat(jc(n))).getOr([]):[e].concat(jc(t))),qc=(e,t)=>_t(MA(t),UA(t),(n,s)=>{const o=Ye(wh(e),V(Ae,n)),r=Ye(jc(e),V(Ae,s));return o.isSome()&&r.isSome()}).getOr(!1),Kc=(e,t,n,s)=>{const o=n,r=new Ve(n,o),a=lr(e.schema.getMoveCaretBeforeOnEnterElements(),(i,l)=>!De(["td","th","table"],l.toLowerCase()));do{if(M(n)&&D.trim(n.nodeValue).length!==0){s?t.setStart(n,0):t.setEnd(n,n.nodeValue.length);return}if(a[n.nodeName]){s?t.setStartBefore(n):n.nodeName==="BR"?t.setEndBefore(n):t.setEndAfter(n);return}}while(n=s?r.next():r.prev());o.nodeName==="BODY"&&(s?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},ri=e=>{const t=e.selection.getSel();return t&&t.rangeCount>0},Gc=(e,t)=>{const n=Io(e);n.length>0?B(n,s=>{const o=s.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)}):t(e.selection.getRng(),!1)},Yc=(e,t,n)=>{const s=fp(e,t);n(s),e.moveToBookmark(s)},kh=((e,t)=>{const n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return s(r).getOr("")},s=r=>e(r)?d.from(r.dom.nodeValue):d.none();return{get:n,getOption:s,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}})(Ut,"text"),Xc=e=>kh.get(e),xh=e=>kh.getOption(e),zA=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],HA=e=>Ut(e)&&Xc(e)===tt,VA=(e,t,n,s)=>Zt(t).fold(()=>"skipping",o=>s==="br"||HA(t)?"valid":Px(t)?"existing":Dn(t.dom)?"caret":Me(zA,r=>wn(t,r))?"valid-block":!Oo(e,n,s)||!Oo(e,Be(o),n)?"invalid-child":"valid"),WA=(e,t)=>{const n=Lo(e,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},Nh=(e,t,n,s,o,r)=>{const{uid:a=t,...i}=n;gr(e,Nr()),ot(e,`${_o()}`,a),ot(e,`${Is()}`,s);const{attributes:l={},classes:c=[]}=o(a,i);if(Sn(e,l),$x(e,c),r){c.length>0&&ot(e,`${Ar()}`,c.join(","));const u=Xt(l);u.length>0&&ot(e,`${Rr()}`,u.join(","))}},jA=e=>{Sa(e,Nr()),rt(e,`${_o()}`),rt(e,`${Is()}`),rt(e,`${_r()}`);const t=po(e,`${Rr()}`).map(s=>s.split(",")).getOr([]),n=po(e,`${Ar()}`).map(s=>s.split(",")).getOr([]);B(t,s=>rt(e,s)),Lx(e,n),rt(e,`${Ar()}`),rt(e,`${Rr()}`)},_h=(e,t,n,s,o)=>{const r=C.fromTag("span",e);return Nh(r,t,n,s,o,!1),r},qA=(e,t,n,s,o,r)=>{const a=[],i=_h(e.getDoc(),n,r,s,o),l=cs(),c=()=>{l.clear()},u=()=>l.get().getOrThunk(()=>{const h=Ao(i);return a.push(h),l.set(h),h}),f=h=>{B(h,m)},m=h=>{switch(VA(e,h,"span",Be(h))){case"invalid-child":{c();const b=at(h);f(b),c();break}case"valid-block":{c(),Nh(h,n,r,s,o,!0);break}case"valid":{const b=u();Hw(h,b);break}}},g=h=>{const p=Ee(h,C.fromDom);f(p)};return Hr(e.dom,t,h=>{c(),g(h)}),a},KA=(e,t,n,s)=>{e.undoManager.transact(()=>{const o=e.selection,r=o.getRng(),a=Io(e).length>0,i=Mg("mce-annotation");if(r.collapsed&&!a&&WA(e,r),o.getRng().collapsed&&!a){const l=_h(e.getDoc(),i,s,t,n.decorate);Kl(l,it),o.getRng().insertNode(l.dom),o.select(l.dom)}else Yc(o,!1,()=>{Gc(e,l=>{qA(e,l,i,t,n.decorate,s)})})})},Ah=e=>{const t=Ox();Bx(e,t);const n=Dx(e,t),s=_m("span"),o=r=>{B(r,a=>{s(a)?Ts(a):jA(a)})};return{register:(r,a)=>{t.register(r,a)},annotate:(r,a)=>{t.lookup(r).each(i=>{KA(e,r,i,a)})},annotationChanged:(r,a)=>{n.addListener(r,a)},remove:r=>{const a=e.selection.getBookmark();Og(e,d.some(r)).each(({elements:i})=>{o(i)}),e.selection.moveToBookmark(a)},removeAll:r=>{const a=e.selection.getBookmark();Pe(Ig(e,r),(i,l)=>{o(i)}),e.selection.moveToBookmark(a)},getAll:r=>{const a=Ig(e,r);return ir(a,i=>Ee(i,l=>l.dom))}}},Wr=e=>({getBookmark:V(yA,e),moveToBookmark:V(vA,e)});Wr.isBookmarkNode=jt;const Rh=(e,t,n)=>n.collapsed?!1:Me(n.getClientRects(),s=>Ux(s,e,t)),GA=(e,t)=>e.dispatch("PreProcess",t),YA=(e,t)=>e.dispatch("PostProcess",t),XA=e=>e.dispatch("remove"),QA=e=>e.dispatch("detach"),ZA=(e,t)=>e.dispatch("SwitchMode",{mode:t}),JA=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},eR=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},tR=e=>e.dispatch("PreInit"),nR=e=>e.dispatch("PostRender"),sR=e=>e.dispatch("Init"),oR=(e,t)=>e.dispatch("PlaceholderToggle",{state:t}),Th=(e,t,n)=>e.dispatch(t,n),Ph=(e,t,n,s)=>e.dispatch("FormatApply",{format:t,node:n,vars:s}),Qc=(e,t,n,s)=>e.dispatch("FormatRemove",{format:t,node:n,vars:s}),rR=(e,t)=>e.dispatch("BeforeSetContent",t),Dh=(e,t)=>e.dispatch("SetContent",t),aR=(e,t)=>e.dispatch("BeforeGetContent",t),Bh=(e,t)=>e.dispatch("GetContent",t),iR=(e,t)=>e.dispatch("AutocompleterStart",t),lR=(e,t)=>e.dispatch("AutocompleterUpdate",t),cR=e=>e.dispatch("AutocompleterEnd"),uR=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),fR=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),Oh=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),G={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||G.metaKeyPressed(e),metaKeyPressed:e=>Se.os.isMacOS()||Se.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},js="data-mce-selected",dR="table,img,figure.image,hr,video,span.mce-preview-object",$h=Math.abs,ai=Math.round,Zc={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},mR=e=>e.type==="longpress"||e.type.indexOf("touch")===0,Lh=(e,t)=>{const n=t.dom,s=t.getDoc(),o=document,r=t.getBody();let a,i,l,c,u,f,m,g,h,p,b,y,E,S,x,_,j;const A=I=>oe(I)&&(rg(I)||n.is(I,"figure.image")),T=I=>Nn(I)||n.hasClass(I,"mce-preview-object"),$=(I,ce)=>{if(mR(I)){const ge=I.touches[0];return A(I.target)&&!Rh(ge.clientX,ge.clientY,ce)}else return A(I.target)&&!Rh(I.clientX,I.clientY,ce)},L=I=>{const ce=I.target;$(I,t.selection.getRng())&&!I.isDefaultPrevented()&&t.selection.select(ce)},Q=I=>n.is(I,"figure.image")?[I.querySelector("img")]:n.hasClass(I,"mce-preview-object")&&oe(I.firstElementChild)?[I,I.firstElementChild]:[I],q=I=>{const ce=Np(t);return!ce||I.getAttribute("data-mce-resize")==="false"||I===t.getBody()?!1:n.hasClass(I,"mce-preview-object")?wn(C.fromDom(I.firstElementChild),ce):wn(C.fromDom(I),ce)},z=I=>T(I)?n.create("img",{src:Se.transparentSrc}):I.cloneNode(!0),pe=(I,ce,ge)=>{if(oe(ge)){const te=Q(I);B(te,ee=>{ee.style[ce]||!t.schema.isValid(ee.nodeName.toLowerCase(),ce)?n.setStyle(ee,ce,ge):n.setAttrib(ee,ce,""+ge)})}},Ce=(I,ce,ge)=>{pe(I,"width",ce),pe(I,"height",ge)},ke=I=>{let ce,ge,te,ee,ye;ce=I.screenX-f,ge=I.screenY-m,S=ce*c[2]+p,x=ge*c[3]+b,S=S<5?5:S,x=x<5?5:x,(A(a)||T(a))&&GN(t)!==!1?te=!G.modifierPressed(I):te=G.modifierPressed(I),te&&($h(ce)>$h(ge)?(x=ai(S*y),S=ai(x/y)):(S=ai(x/y),x=ai(S*y))),Ce(i,S,x),ee=c.startPos.x+ce,ye=c.startPos.y+ge,ee=ee>0?ee:0,ye=ye>0?ye:0,n.setStyles(l,{left:ee,top:ye,display:"block"}),l.innerHTML=S+" &times; "+x,c[2]<0&&i.clientWidth<=S&&n.setStyle(i,"left",g+(p-S)),c[3]<0&&i.clientHeight<=x&&n.setStyle(i,"top",h+(b-x)),ce=r.scrollWidth-_,ge=r.scrollHeight-j,ce+ge!==0&&n.setStyles(l,{left:ee-ce,top:ye-ge}),E||(JA(t,a,p,b,"corner-"+c.name),E=!0)},ze=()=>{const I=E;E=!1,I&&(pe(a,"width",S),pe(a,"height",x)),n.unbind(s,"mousemove",ke),n.unbind(s,"mouseup",ze),o!==s&&(n.unbind(o,"mousemove",ke),n.unbind(o,"mouseup",ze)),n.remove(i),n.remove(l),n.remove(u),O(a),I&&(eR(t,a,S,x,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},O=I=>{U();const ce=n.getPos(I,r),ge=ce.x,te=ce.y,ee=I.getBoundingClientRect(),ye=ee.width||ee.right-ee.left,ve=ee.height||ee.bottom-ee.top;a!==I&&(ue(),a=I,S=x=0);const He=t.dispatch("ObjectSelected",{target:I});q(I)&&!He.isDefaultPrevented()?Pe(Zc,(xe,de)=>{let Ne;const ct=ut=>{const et=Q(a)[0];f=ut.screenX,m=ut.screenY,p=et.clientWidth,b=et.clientHeight,y=b/p,c=xe,c.name=de,c.startPos={x:ye*xe[0]+ge,y:ve*xe[1]+te},_=r.scrollWidth,j=r.scrollHeight,u=n.add(r,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(u,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=z(a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:ge,top:te,margin:0}),Ce(i,ye,ve),i.removeAttribute(js),r.appendChild(i),n.bind(s,"mousemove",ke),n.bind(s,"mouseup",ze),o!==s&&(n.bind(o,"mousemove",ke),n.bind(o,"mouseup",ze)),l=n.add(r,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},p+" &times; "+b)};Ne=n.get("mceResizeHandle"+de),Ne&&n.remove(Ne),Ne=n.add(r,"div",{id:"mceResizeHandle"+de,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+de+"-resize; margin:0; padding:0"}),n.bind(Ne,"mousedown",ut=>{ut.stopImmediatePropagation(),ut.preventDefault(),ct(ut)}),xe.elm=Ne,n.setStyles(Ne,{left:ye*xe[0]+ge-Ne.offsetWidth/2,top:ve*xe[1]+te-Ne.offsetHeight/2})}):ue(!1)},Y=Ua(O,0),ue=(I=!0)=>{Y.cancel(),U(),a&&I&&a.removeAttribute(js),Pe(Zc,(ce,ge)=>{const te=n.get("mceResizeHandle"+ge);te&&(n.unbind(te),n.remove(te))})},le=(I,ce)=>oe(I)&&n.isChildOf(I,ce),We=I=>{if(E||t.removed||t.composing)return;const ce=I.type==="mousedown"?I.target:e.getNode(),ge=Bs(C.fromDom(ce),dR).map(ee=>ee.dom).getOrUndefined(),te=oe(ge)?n.getAttrib(ge,js,"1"):"1";if(B(n.select(`img[${js}],hr[${js}]`),ee=>{ee.removeAttribute(js)}),le(ge,r)){J();const ee=e.getStart(!0);if(le(ee,ge)&&le(e.getEnd(!0),ge)){n.setAttrib(ge,js,te),Y.throttle(ge);return}}ue()},U=()=>{Pe(Zc,I=>{I.elm&&(n.unbind(I.elm),delete I.elm)})},J=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{J(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",We),t.on("keyup compositionend",I=>{a&&a.nodeName==="TABLE"&&We(I)}),t.on("hide blur",ue),t.on("contextmenu longpress",L,!0)}),t.on("remove",U),{isResizable:q,showResizeRect:O,hideResizeRect:ue,updateResizeRect:We,destroy:()=>{Y.cancel(),a=i=u=null}}},gR=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,s)=>{e.setStart(n.dom,s)},n=>{e.setStartAfter(n.dom)})},pR=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,s)=>{e.setEnd(n.dom,s)},n=>{e.setEndAfter(n.dom)})},Ih=(e,t,n)=>{const s=e.document.createRange();return gR(s,t),pR(s,n),s},Jc=(e,t,n,s,o)=>{const r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(s.dom,o),r},jr=_n.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Fh=(e,t,n)=>t(C.fromDom(n.startContainer),n.startOffset,C.fromDom(n.endContainer),n.endOffset),hR=(e,t)=>t.match({domRange:n=>({ltr:F(n),rtl:d.none}),relative:(n,s)=>({ltr:ks(()=>Ih(e,n,s)),rtl:ks(()=>d.some(Ih(e,s,n)))}),exact:(n,s,o,r)=>({ltr:ks(()=>Jc(e,n,s,o,r)),rtl:ks(()=>d.some(Jc(e,o,r,n,s)))})}),bR=(e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(o=>o.collapsed===!1).map(o=>jr.rtl(C.fromDom(o.endContainer),o.endOffset,C.fromDom(o.startContainer),o.startOffset)).getOrThunk(()=>Fh(e,jr.ltr,n)):Fh(e,jr.ltr,n)},CR=(e,t)=>{const n=hR(e,t);return bR(e,n)};jr.ltr,jr.rtl;const Mh={create:(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s})},yR=(e,t,n)=>{var s,o;return d.from((o=(s=e.dom).caretPositionFromPoint)===null||o===void 0?void 0:o.call(s,t,n)).bind(r=>{if(r.offsetNode===null)return d.none();const a=e.dom.createRange();return a.setStart(r.offsetNode,r.offset),a.collapse(),d.some(a)})},vR=(e,t,n)=>{var s,o;return d.from((o=(s=e.dom).caretRangeFromPoint)===null||o===void 0?void 0:o.call(s,t,n))},ER=(()=>document.caretPositionFromPoint?yR:document.caretRangeFromPoint?vR:d.none)(),SR=(e,t,n)=>{const s=C.fromDom(e.document);return ER(s,t,n).map(o=>Mh.create(C.fromDom(o.startContainer),o.startOffset,C.fromDom(o.endContainer),o.endOffset))},eu=_n.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),wR=(e,t,n,s)=>e.fold(t,n,s),kR=e=>e.fold(bt,bt,bt),xR=eu.before,NR=eu.on,_R=eu.after,qn={before:xR,on:NR,after:_R,cata:wR,getStart:kR},ii=_n.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),AR=e=>ii.exact(e.start,e.soffset,e.finish,e.foffset),RR=e=>e.match({domRange:t=>C.fromDom(t.startContainer),relative:(t,n)=>qn.getStart(t),exact:(t,n,s,o)=>t}),TR=ii.domRange,PR=ii.relative,DR=ii.exact,BR=e=>{const t=RR(e);return Im(t)},OR=Mh.create,Fo={domRange:TR,relative:PR,exact:DR,exactFromRange:AR,getWin:BR,range:OR},li=(e,t)=>{const n=Be(e);return n==="input"?qn.after(e):De(["br","img"],n)?t===0?qn.before(e):qn.after(e):qn.on(e,t)},$R=(e,t)=>{const n=e.fold(qn.before,li,qn.after),s=t.fold(qn.before,li,qn.after);return Fo.relative(n,s)},Uh=(e,t,n,s)=>{const o=li(e,t),r=li(n,s);return Fo.relative(o,r)},LR=e=>e.match({domRange:t=>{const n=C.fromDom(t.startContainer),s=C.fromDom(t.endContainer);return Uh(n,t.startOffset,s,t.endOffset)},relative:$R,exact:Uh}),tu=(e,t)=>{const s=(t||document).createDocumentFragment();return B(e,o=>{s.appendChild(o.dom)}),C.fromDom(s)},IR=e=>{const t=Fo.getWin(e).dom,n=(o,r,a,i)=>Jc(t,o,r,a,i),s=LR(e);return CR(t,s).match({ltr:n,rtl:n})},FR=(e,t,n)=>SR(e,t,n),zh=(e,t,n)=>FR(n.defaultView,e,t).map(s=>{const o=n.createRange();return o.setStart(s.start.dom,s.soffset),o.setEnd(s.finish.dom,s.foffset),o}).getOrUndefined(),nu=(e,t)=>e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,MR=(e,t,n)=>{for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null},Hh=(e,t,n)=>MR(e,t,n)!==null,UR=(e,t,n)=>Hh(e,t,s=>s.nodeName===n),su=e=>e&&e.nodeName==="TABLE",zR=e=>e&&/^(TD|TH|CAPTION)$/.test(e.nodeName),HR=(e,t)=>Ht(e)&&Hh(e,t,Dn)===!1,Vh=(e,t,n)=>{const s=new Ve(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());for(;t=s[n?"prev":"next"]();)if(Ue(t))return!0},VR=(e,t)=>e.previousSibling&&e.previousSibling.nodeName===t,WR=(e,t)=>{for(;t&&t!==e;){if(Oe(t))return!0;t=t.parentNode}return!1},ou=(e,t,n,s,o)=>{let r;const a=e.getRoot();let i;const l=e.schema.getNonEmptyElements(),c=e.getParent(o.parentNode,e.isBlock)||a;if(s&&Ue(o)&&t&&e.isEmpty(c))return d.some(N(o.parentNode,e.nodeIndex(o)));const u=new Ve(o,c);for(;i=u[s?"prev":"next"]();){if(e.getContentEditableParent(i)==="false"||HR(i,a))return d.none();if(M(i)&&i.nodeValue.length>0)return UR(i,a,"A")===!1?d.some(N(i,s?i.nodeValue.length:0)):d.none();if(e.isBlock(i)||l[i.nodeName.toLowerCase()])return d.none();r=i}return Ql(r)?d.none():n&&r?d.some(N(r,0)):d.none()},Wh=(e,t,n,s)=>{let o,r;const a=e.getRoot();let i,l,c=!1;o=s[(n?"start":"end")+"Container"],r=s[(n?"start":"end")+"Offset"];const u=Z(o)&&r===o.childNodes.length,f=e.schema.getNonEmptyElements();if(l=n,Ht(o))return d.none();if(Z(o)&&r>o.childNodes.length-1&&(l=!1),Zl(o)&&(o=a,r=0),o===a){if(l&&(i=o.childNodes[r>0?r-1:0],i&&(Ht(i)||f[i.nodeName]||su(i))))return d.none();if(o.hasChildNodes()){if(r=Math.min(!l&&r>0?r-1:r,o.childNodes.length-1),o=o.childNodes[r],r=M(o)&&u?o.data.length:0,!t&&o===a.lastChild&&su(o)||WR(a,o)||Ht(o))return d.none();if(o.hasChildNodes()&&su(o)===!1){i=o;const m=new Ve(o,a);do{if(Oe(i)||Ht(i)){c=!1;break}if(M(i)&&i.nodeValue.length>0){r=l?0:i.nodeValue.length,o=i,c=!0;break}if(f[i.nodeName.toLowerCase()]&&!zR(i)){r=e.nodeIndex(i),o=i.parentNode,l||r++,c=!0;break}}while(i=l?m.next():m.prev())}}}return t&&(M(o)&&r===0&&ou(e,u,t,!0,o).each(m=>{o=m.container(),r=m.offset(),c=!0}),Z(o)&&(i=o.childNodes[r],i||(i=o.childNodes[r-1]),i&&Ue(i)&&!VR(i,"A")&&!Vh(e,i,!1)&&!Vh(e,i,!0)&&ou(e,u,t,!0,i).each(m=>{o=m.container(),r=m.offset(),c=!0}))),l&&!t&&M(o)&&r===o.nodeValue.length&&ou(e,u,t,!1,o).each(m=>{o=m.container(),r=m.offset(),c=!0}),c?d.some(N(o,r)):d.none()},ci=(e,t)=>{const n=t.collapsed,s=t.cloneRange(),o=N.fromRangeStart(t);return Wh(e,n,!0,s).each(r=>{(!n||!N.isAbove(o,r))&&s.setStart(r.container(),r.offset())}),n||Wh(e,n,!1,s).each(r=>{s.setEnd(r.container(),r.offset())}),n&&s.collapse(!0),nu(t,s)?d.none():d.some(s)},ui=(e,t)=>e.splitText(t),fi=e=>{let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset;return t===s&&M(t)?n>0&&n<t.nodeValue.length&&(s=ui(t,n),t=s.previousSibling,o>n?(o=o-n,t=s=ui(s,o).previousSibling,o=s.nodeValue.length,n=0):o=0):(M(t)&&n>0&&n<t.nodeValue.length&&(t=ui(t,n),n=0),M(s)&&o>0&&o<s.nodeValue.length&&(s=ui(s,o).previousSibling,o=s.nodeValue.length)),{startContainer:t,startOffset:n,endContainer:s,endOffset:o}},Mo=e=>({walk:(o,r)=>Hr(e,o,r),split:fi,normalize:o=>ci(e,o).fold(Le,r=>(o.setStart(r.startContainer,r.startOffset),o.setEnd(r.endContainer,r.endOffset),!0))});Mo.compareRanges=nu,Mo.getCaretRangeFromPoint=zh,Mo.getSelectedNode=za,Mo.getNode=us;const jR=((e,t)=>{const n=(i,l)=>{if(!yn(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);const c=i.dom;pr(c)&&(c.style[e]=l+"px")},s=i=>{const l=t(i);if(l<=0||l===null){const c=kn(i,e);return parseFloat(c)||0}return l},o=s,r=(i,l)=>$t(l,(c,u)=>{const f=kn(i,u),m=f===void 0?0:parseInt(f,10);return isNaN(m)?c:c+m},0);return{set:n,get:s,getOuter:o,aggregate:r,max:(i,l,c)=>{const u=r(i,c);return l>u?l-u:0}}})("height",e=>{const t=e.dom;return ho(e)?t.getBoundingClientRect().height:t.offsetHeight}),qR=e=>jR.get(e),jh=()=>C.fromDom(document),qh=(e,t)=>e.view(t).fold(F([]),s=>{const o=e.owner(s),r=qh(e,o);return[s].concat(r)}),KR=(e,t)=>{const n=t.owner(e);return qh(t,n)};var GR=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?d.none():d.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(C.fromDom)},owner:e=>ns(e)});const YR=e=>{const t=jh(),n=Yl(t),s=KR(e,GR),o=Gl(e),r=Ca(s,(a,i)=>{const l=Gl(i);return{left:a.left+l.left,top:a.top+l.top}},{left:0,top:0});return bo(r.left+o.left+n.left,r.top+o.top+n.top)},ru=e=>Be(e)==="textarea",XR=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),QR=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},ZR=(e,t)=>{const n=at(e);if(n.length===0||ru(e))return{element:e,offset:t};if(t<n.length&&!ru(n[t]))return{element:n[t],offset:0};{const s=n[n.length-1];return ru(s)?{element:e,offset:t}:Be(s)==="img"?{element:s,offset:1}:Ut(s)?{element:s,offset:Xc(s).length}:{element:s,offset:at(s).length}}},Kh=(e,t)=>{const n=ek(e),s=qR(e);return{element:e,bottom:n.top+s,height:s,pos:n,cleanup:t}},JR=(e,t)=>{const n=ZR(e,t),s=C.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+tt+"</span>");return Jt(n.element,s),Kh(s,()=>Fe(s))},eT=e=>Kh(C.fromDom(e),me),Gh=(e,t,n,s)=>{nT(e,(o,r)=>tT(e,t,n,s),n)},Yh=(e,t,n,s,o)=>{const r={elm:s.element.dom,alignToTop:o};if(XR(e,r))return;const a=Yl(t).top;n(t,a,s,o),QR(e,r)},tT=(e,t,n,s)=>{const o=C.fromDom(e.getBody()),r=C.fromDom(e.getDoc());zw(o);const a=JR(C.fromDom(n.startContainer),n.startOffset);Yh(e,r,t,a,s),a.cleanup()},Xh=(e,t,n,s)=>{const o=C.fromDom(e.getDoc());Yh(e,o,n,eT(t),s)},nT=(e,t,n)=>{const s=n.startContainer,o=n.startOffset,r=n.endContainer,a=n.endOffset;t(C.fromDom(s),C.fromDom(r));const i=e.dom.createRng();i.setStart(s,o),i.setEnd(r,a),e.selection.setRng(n)},au=(e,t,n,s)=>{const o=e.pos;if(n)Jm(o.left,o.top,s);else{const r=o.top-t+e.height;Jm(o.left,r,s)}},Qh=(e,t,n,s,o)=>{const r=n+t,a=s.pos.top,i=s.bottom,l=i-a>=n;a<t?au(s,n,o!==!1,e):a>r?au(s,n,l?o!==!1:o===!0,e):i>r&&!l&&au(s,n,o===!0,e)},Zh=(e,t,n,s)=>{const o=e.dom.defaultView.innerHeight;Qh(e,t,o,n,s)},Jh=(e,t,n,s)=>{const o=e.dom.defaultView.innerHeight;Qh(e,t,o,n,s);const r=YR(n.element),a=ng(window);r.top<a.y?eg(n.element,s!==!1):r.top>a.bottom&&eg(n.element,s===!0)},sT=(e,t,n)=>Gh(e,Zh,t,n),oT=(e,t,n)=>Xh(e,t,Zh,n),rT=(e,t,n)=>Gh(e,Jh,t,n),aT=(e,t,n)=>Xh(e,t,Jh,n),iT=(e,t,n)=>{(e.inline?oT:aT)(e,t,n)},qr=(e,t,n)=>{(e.inline?sT:rT)(e,t,n)},eb=e=>e.dom.focus(),tb=e=>{const t=As(e).dom;return e.dom===t.activeElement},iu=(e=jh())=>d.from(e.dom.activeElement).map(C.fromDom),lT=e=>iu(As(e)).filter(t=>e.dom.contains(t.dom)),nb=(e,t)=>{const n=Ut(t)?Xc(t).length:at(t).length+1;return e>n?n:e<0?0:e},cT=e=>Fo.range(e.start,nb(e.soffset,e.start),e.finish,nb(e.foffset,e.finish)),sb=(e,t)=>!_a(t.dom)&&(Vn(e,t)||Ae(e,t)),ob=e=>t=>sb(e,t.start)&&sb(e,t.finish),uT=e=>e.inline,fT=e=>Fo.range(C.fromDom(e.startContainer),e.startOffset,C.fromDom(e.endContainer),e.endOffset),dT=e=>{const t=e.getSelection();return(!t||t.rangeCount===0?d.none():d.from(t.getRangeAt(0))).map(fT)},mT=e=>{const t=Im(e);return dT(t.dom).filter(ob(e))},gT=(e,t)=>d.from(t).filter(ob(e)).map(cT),pT=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),d.some(t)}catch{return d.none()}},lu=e=>{const t=uT(e)?mT(C.fromDom(e.getBody())):d.none();e.bookmark=t.isSome()?t:e.bookmark},cu=e=>(e.bookmark?e.bookmark:d.none()).bind(n=>gT(C.fromDom(e.getBody()),n)).bind(pT),hT=e=>{cu(e).each(t=>e.selection.setRng(t))},rb={isEditorUIElement:e=>{const t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},bT=(e,t)=>(yn(t)||(t=0),setTimeout(e,t)),CT=(e,t)=>(yn(t)||(t=0),setInterval(e,t)),qt={setEditorTimeout:(e,t,n)=>bT(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{const s=CT(()=>{e.removed?clearInterval(s):t()},n);return s}},yT=e=>e.type==="nodechange"&&e.selectionChange,vT=(e,t)=>{const n=()=>{t.throttle()};Re.DOM.bind(document,"mouseup",n),e.on("remove",()=>{Re.DOM.unbind(document,"mouseup",n)})},ET=(e,t)=>{e.on("mouseup touchend",n=>{t.throttle()})},ST=(e,t)=>{ET(e,t),e.on("keyup NodeChange AfterSetSelectionRange",n=>{yT(n)||lu(e)})},wT=e=>{const t=Ua(()=>{lu(e)},0);e.on("init",()=>{e.inline&&vT(e,t),ST(e,t)}),e.on("remove",()=>{t.cancel()})};let Kr;const uu=Re.DOM,kT=e=>rb.isEditorUIElement(e),xT=e=>{const t=e.classList;return t!==void 0?t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"):!1},di=(e,t)=>{const n=n_(e);return uu.getParent(t,o=>kT(o)||(n?e.dom.is(o,n):!1))!==null},NT=e=>{try{const t=As(C.fromDom(e.getElement()));return iu(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},_T=(e,t)=>{const n=t.editor;wT(n),n.on("focusin",()=>{const s=e.focusedEditor;s!==n&&(s&&s.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:s}),n.focus(!0))}),n.on("focusout",()=>{qt.setEditorTimeout(n,()=>{const s=e.focusedEditor;!di(n,NT(n))&&s===n&&(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),Kr||(Kr=s=>{const o=e.activeEditor;o&&Wm(s).each(r=>{r.ownerDocument===document&&r!==document.body&&!di(o,r)&&e.focusedEditor===o&&(o.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})},uu.bind(document,"focusin",Kr))},AT=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(uu.unbind(document,"focusin",Kr),Kr=null)},RT=e=>{e.on("AddEditor",V(_T,e)),e.on("RemoveEditor",V(AT,e))},TT=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="true"),PT=e=>e.collapsed?d.from(us(e.startContainer,e.startOffset)).map(C.fromDom):d.none(),DT=(e,t)=>PT(t).bind(n=>wk(n)?d.some(n):Vn(e,n)===!1?d.some(e):d.none()),ab=(e,t)=>{DT(C.fromDom(e.getBody()),t).bind(n=>yt(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},fu=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},BT=e=>tb(e)||lT(e).isSome(),OT=e=>e.iframeElement&&tb(C.fromDom(e.iframeElement)),$T=e=>{const t=e.getBody();return t&&BT(C.fromDom(t))},LT=e=>{const t=As(C.fromDom(e.getElement()));return iu(t).filter(n=>!xT(n.dom)&&di(e,n.dom)).isSome()},qs=e=>e.inline?$T(e):OT(e),IT=e=>qs(e)||LT(e),FT=e=>{const t=e.selection,n=e.getBody();let s=t.getRng();e.quirks.refreshContentEditable(),e.bookmark!==void 0&&qs(e)===!1&&cu(e).each(r=>{e.selection.setRng(r),s=r});const o=TT(e,t.getNode());if(e.dom.isChildOf(o,n)){fu(o),ab(e,s),du(e);return}e.inline||(Se.browser.isOpera()||fu(n),e.getWin().focus()),(Se.browser.isFirefox()||e.inline)&&(fu(n),ab(e,s)),du(e)},du=e=>e.editorManager.setActive(e),MT=(e,t)=>{e.removed||(t?du(e):FT(e))},ib=(e,t,n,s,o)=>{const r=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return d.from(r).map(C.fromDom).map(i=>!s||!t.collapsed?wa(i,o(i,a)).getOr(i):i).bind(i=>Qt(i)?d.some(i):Zt(i).filter(Qt)).map(i=>i.dom).getOr(e)},lb=(e,t,n)=>ib(e,t,!0,n,(s,o)=>Math.min(zm(s),o)),cb=(e,t,n)=>ib(e,t,!1,n,(s,o)=>o>0?o-1:o),ub=(e,t)=>{const n=e;for(;e&&M(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},UT=(e,t)=>{let n,s,o;if(!t)return e;s=t.startContainer,o=t.endContainer;const r=t.startOffset,a=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(s===o&&a-r<2&&s.hasChildNodes()&&(n=s.childNodes[r]),s.nodeType===3&&o.nodeType===3&&(s.length===r?s=ub(s.nextSibling,!0):s=s.parentNode,a===0?o=ub(o.previousSibling,!1):o=o.parentNode,s&&s===o))?s:n&&n.nodeType===3?n.parentNode:n},zT=(e,t,n,s)=>{let o;const r=[],a=e.getRoot();if(n=e.getParent(n||lb(a,t,t.collapsed),e.isBlock),s=e.getParent(s||cb(a,t,t.collapsed),e.isBlock),n&&n!==a&&r.push(n),n&&s&&n!==s){o=n;const i=new Ve(n,a);for(;(o=i.next())&&o!==s;)e.isBlock(o)&&r.push(o)}return s&&n!==s&&s!==a&&r.push(s),r},HT=(e,t,n)=>d.from(t).map(s=>{const o=e.nodeIndex(s),r=e.createRng();return r.setStart(s.parentNode,o),r.setEnd(s.parentNode,o+1),n&&(Kc(e,r,s,!0),Kc(e,r,s,!1)),r}),mu=(e,t)=>Ee(t,n=>{const s=e.dispatch("GetSelectionRange",{range:n});return s.range!==n?s.range:n}),VT=e=>Be(e)==="img"?1:xh(e).fold(()=>at(e).length,t=>t.length),WT=e=>xh(e).filter(t=>t.trim().length!==0||t.indexOf(it)>-1).isSome(),jT=["img","br"],fb=e=>WT(e)||De(jT,Be(e)),qT=e=>fk(e,fb),KT=e=>GT(e,fb),GT=(e,t)=>{const n=s=>{const o=at(s);for(let r=o.length-1;r>=0;r--){const a=o[r];if(t(a))return d.some(a);const i=n(a);if(i.isSome())return i}return d.none()};return n(e)},db="[data-mce-autocompleter]",YT=(e,t)=>{if(mb(C.fromDom(e.getBody())).isNone()){const n=C.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());qe(n,C.fromDom(t.extractContents())),t.insertNode(n.dom),Zt(n).each(s=>s.dom.normalize()),KT(n).map(s=>{e.selection.setCursorLocation(s.dom,VT(s))})}},XT=e=>Bs(e,db),mb=e=>Er(e,db),QT=(e,t)=>mb(t).each(n=>{const s=e.selection.getBookmark();Ts(n),e.selection.moveToBookmark(s)}),ZT={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},mi=(e,t,n)=>{const s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){let r=e[o];if(r)return r;for(let a=e.parent;a&&a!==t;a=a.parent)if(r=a[o],r)return r}},JT=e=>{if(!Os(e.value))return!1;const t=e.parent;return!(t&&(t.name!=="span"||t.attr("style"))&&/^[ ]+$/.test(e.value))},gb=e=>{const t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class vt{constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}static create(t,n){const s=new vt(t,ZT[t]||1);return n&&Pe(n,(o,r)=>{s.attr(r,o)}),s}replace(t){const n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){const s=this;let o;if(typeof t!="string")return t!=null&&Pe(t,(r,a)=>{s.attr(a,r)}),s;if(o=s.attributes){if(n!==void 0){if(n===null){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),s}return s}if(t in o.map){let r=o.length;for(;r--;)if(o[r].name===t){o[r].value=n;break}}else o.push({name:t,value:n});return o.map[t]=n,s}return o.map[t]}}clone(){const t=this,n=new vt(t.name,t.type);let s;if(s=t.attributes){const o=[];o.map={};for(let r=0,a=s.length;r<a;r++){const i=s[r];i.name!=="id"&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=t.value,n}wrap(t){const n=this;return n.parent.insert(t,n),t.append(n),n}unwrap(){const t=this;for(let n=t.firstChild;n;){const s=n.next;t.insert(n,t,!0),n=s}t.remove()}remove(){const t=this,n=t.parent,s=t.next,o=t.prev;return n&&(n.firstChild===t?(n.firstChild=s,s&&(s.prev=null)):o.next=s,n.lastChild===t?(n.lastChild=o,o&&(o.next=null)):s.prev=o,t.parent=t.next=t.prev=null),t}append(t){const n=this;t.parent&&t.remove();const s=n.lastChild;return s?(s.next=t,t.prev=s,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,s){t.parent&&t.remove();const o=n.parent||this;return s?(n===o.firstChild?o.firstChild=t:n.prev.next=t,t.prev=n.prev,t.next=n,n.prev=t):(n===o.lastChild?o.lastChild=t:n.next.prev=t,t.next=n.next,t.prev=n,n.next=t),t.parent=o,t}getAll(t){const n=this,s=[];for(let o=n.firstChild;o;o=mi(o,n))o.name===t&&s.push(o);return s}children(){const t=this,n=[];for(let s=t.firstChild;s;s=s.next)n.push(s);return n}empty(){const t=this;if(t.firstChild){const n=[];for(let o=t.firstChild;o;o=mi(o,t))n.push(o);let s=n.length;for(;s--;){const o=n[s];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},s){const o=this;let r=o.firstChild;if(gb(o))return!1;if(r)do{if(r.type===1){if(r.attr("data-mce-bogus"))continue;if(t[r.name]||gb(r))return!1}if(r.type===8||r.type===3&&!JT(r)||r.type===3&&r.parent&&n[r.parent.name]&&Os(r.value)||s&&s(r))return!1}while(r=mi(r,o));return!0}walk(t){return mi(this,null,t)}}const e1=(e,t)=>/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t)),pb=(e,t,n=0)=>{const s=e.toLowerCase();if(s.indexOf("[if ",n)!==-1&&e1(s,n)){const o=s.indexOf("[endif]",n);return s.indexOf(">",o)}else if(t){const o=s.indexOf(">",n);return o!==-1?o:s.length}else{const o=/--!?>/g;o.lastIndex=n;const r=o.exec(e);return r?r.index+r[0].length:s.length}},t1=(e,t,n)=>{const s=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,o=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,r=e.getVoidElements();let a=1,i=n;for(;a!==0;)for(s.lastIndex=i;;){const l=s.exec(t);if(l===null)return i;if(l[1]==="!"){st(l[2],"--")?i=pb(t,!1,l.index+3):i=pb(t,!0,l.index+1);break}else{o.lastIndex=s.lastIndex;const c=o.exec(t);if(tr(c)||c.index!==s.lastIndex)continue;l[1]==="/"?a-=1:fe(r,l[2])||(a+=1),i=s.lastIndex+c[0].length;break}}return i},n1=(e,t)=>{const n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")},hb=(e,t)=>{const n=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,s=e.schema;let o=n1(e.getTempAttrs(),t);const r=s.getVoidElements();let a;for(;a=n.exec(o);){const i=n.lastIndex,l=a[0].length;let c;r[a[1]]?c=i:c=t1(s,o,i),o=o.substring(0,i-l)+o.substring(c),n.lastIndex=i-l}return rs(o)},s1=hb,o1=(e,t)=>{const n=Rt(e),s=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s|\xA0|<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(s,"")},r1=(e,t,n)=>{let s;return t.format==="raw"?s=D.trim(s1(e.serializer,n.innerHTML)):t.format==="text"?(s=rs(n.innerText),s=s===`
`?"":s):t.format==="tree"?s=e.serializer.serialize(n,t):s=o1(e,e.serializer.serialize(n,t)),t.format!=="text"&&!Pa(C.fromDom(n))&&ne(s)?D.trim(s):s},a1=(e,t)=>d.from(e.getBody()).fold(F(t.format==="tree"?new vt("body",11):""),n=>r1(e,t,n)),i1=D.each,bb=e=>({compare:(n,s)=>{if(n.nodeName!==s.nodeName)return!1;const o=a=>{const i={};return i1(e.getAttribs(a),l=>{const c=l.nodeName.toLowerCase();c.indexOf("_")!==0&&c!=="style"&&c.indexOf("data-")!==0&&(i[c]=e.getAttrib(a,c))}),i},r=(a,i)=>{let l,c;for(c in a)if(fe(a,c)){if(l=i[c],typeof l=="undefined"||a[c]!==l)return!1;delete i[c]}for(c in i)if(fe(i,c))return!1;return!0};return!r(o(n),o(s))||!r(e.parseStyle(e.getAttrib(n,"style")),e.parseStyle(e.getAttrib(s,"style")))?!1:!jt(n)&&!jt(s)}}),Cb=D.makeMap,yb=e=>{const t=[];e=e||{};const n=e.indent,s=Cb(e.indent_before||""),o=Cb(e.indent_after||""),r=as.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,l,c)=>{let u,f,m,g;if(n&&s[i]&&t.length>0&&(g=t[t.length-1],g.length>0&&g!==`
`&&t.push(`
`)),t.push("<",i),l)for(u=0,f=l.length;u<f;u++)m=l[u],t.push(" ",m.name,'="',r(m.value,!0),'"');!c||a?t[t.length]=">":t[t.length]=" />",c&&n&&o[i]&&t.length>0&&(g=t[t.length-1],g.length>0&&g!==`
`&&t.push(`
`))},end:i=>{let l;t.push("</",i,">"),n&&o[i]&&t.length>0&&(l=t[t.length-1],l.length>0&&l!==`
`&&t.push(`
`))},text:(i,l)=>{i.length>0&&(t[t.length]=l?i:r(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,l)=>{l?t.push("<?",i," ",r(l),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},ms=(e,t=ls())=>{const n=yb(e);return e=e||{},e.validate="validate"in e?e.validate:!0,{serialize:o=>{const r=e.validate,a={3:l=>{n.text(l.value,l.raw)},8:l=>{n.comment(l.value)},7:l=>{n.pi(l.name,l.value)},10:l=>{n.doctype(l.value)},4:l=>{n.cdata(l.value)},11:l=>{if(l=l.firstChild)do i(l);while(l=l.next)}};n.reset();const i=l=>{const c=a[l.type];if(c)c(l);else{const u=l.name,f=u in t.getVoidElements();let m=l.attributes;if(r&&m&&m.length>1){const g=[];g.map={};const h=t.getElementRule(l.name);if(h){for(let p=0,b=h.attributesOrder.length;p<b;p++){const y=h.attributesOrder[p];if(y in m.map){const E=m.map[y];g.map[y]=E,g.push({name:y,value:E})}}for(let p=0,b=m.length;p<b;p++){const y=m[p].name;if(!(y in g.map)){const E=m.map[y];g.map[y]=E,g.push({name:y,value:E})}}m=g}}if(n.start(u,m,f),!f){let g=l.firstChild;if(g){(u==="pre"||u==="textarea")&&g.type===3&&g.value[0]===`
`&&n.text(`
`,!0);do i(g);while(g=g.next)}n.end(u)}}};return o.type===1&&!e.inner?i(o):o.type===3?a[3](o):a[11](o),n.getContent()}}},vb=new Set;B(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{vb.add(t)});const Eb=["font","text-decoration","text-emphasis"],gu=(e,t)=>Xt(e.parseStyle(e.getAttrib(t,"style"))),l1=e=>vb.has(e),c1=(e,t)=>io(gu(e,t),n=>!l1(n)),u1=e=>re(e,t=>Me(Eb,n=>st(t,n))),f1=(e,t,n)=>{const s=gu(e,t),o=gu(e,n),r=a=>{var i,l;const c=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",u=(l=e.getStyle(n,a))!==null&&l!==void 0?l:"";return zn(c)&&zn(u)&&c!==u};return Me(s,a=>{const i=l=>Me(l,c=>c===a);if(!i(o)&&i(Eb)){const l=u1(o);return Me(l,r)}else return r(a)})},Sb=(e,t,n)=>d.from(n.container()).filter(M).exists(s=>{const o=e?0:-1;return t(s.data.charAt(n.offset()+o))}),pu=V(Sb,!0,zr),hu=V(Sb,!1,zr),d1=e=>{const t=e.container();return M(t)&&(t.data.length===0||Da(t.data)&&Wr.isBookmarkNode(t.parentNode))},gs=(e,t)=>n=>d.from(Pc(e?0:-1,n)).filter(t).isSome(),wb=e=>rg(e)&&kn(C.fromDom(e),"display")==="block",kb=e=>Oe(e)&&!sk(e),m1=gs(!0,wb),g1=gs(!1,wb),Gr=gs(!0,Nn),Yr=gs(!1,Nn),xb=gs(!0,yr),Nb=gs(!1,yr),ps=gs(!0,kb),hs=gs(!1,kb),p1=e=>{const t=[];let n=e.dom;for(;n;)t.push(C.fromDom(n)),n=n.lastChild;return t},h1=e=>{const t=At(e,"br"),n=re(p1(e).slice(-1),vo);t.length===n.length&&B(n,Fe)},Ks=e=>{Cr(e),qe(e,C.fromHtml('<br data-mce-bogus="1">'))},b1=e=>{jl(e).each(t=>{_s(t).each(n=>{sn(e)&&vo(t)&&sn(n)&&Fe(t)})})},C1=e=>e.slice(0,-1),y1=(e,t,n)=>Vn(t,e)?C1(Bw(e,s=>n(s)||Ae(s,t))):[],_b=(e,t)=>y1(e,t,Le),Kn=(e,t)=>[e].concat(_b(e,t)),bu=(e,t,n)=>eh(e,t,n,d1),Ab=(e,t)=>Ye(Kn(C.fromDom(t.container()),e),sn),Rb=(e,t,n)=>bu(e,t.dom,n).forall(s=>Ab(t,n).fold(()=>An(s,n,t.dom)===!1,o=>An(s,n,t.dom)===!1&&Vn(o,C.fromDom(s.container())))),Tb=(e,t,n)=>Ab(t,n).fold(()=>bu(e,t.dom,n).forall(s=>An(s,n,t.dom)===!1),s=>bu(e,s.dom,n).isNone()),Cu=V(Tb,!1),Pb=V(Tb,!0),v1=V(Rb,!1),E1=V(Rb,!0),S1=e=>Ga(e).exists(vo),gi=(e,t,n)=>{const s=re(Kn(C.fromDom(n.container()),t),sn),o=Lt(s).getOr(t);return Vt(e,o.dom,n).filter(S1)},yu=(e,t)=>Ga(t).exists(vo)||gi(!0,e,t).isSome(),vu=(e,t)=>eA(t).exists(vo)||gi(!1,e,t).isSome(),w1=V(gi,!1),k1=V(gi,!0),Db=e=>N.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),Bb=(e,t)=>{const n=re(Kn(C.fromDom(t.container()),e),sn);return Lt(n).getOr(e)},Ob=(e,t)=>Db(t)?hu(t):hu(t)||an(Bb(e,t).dom,t).exists(hu),$b=(e,t)=>Db(t)?pu(t):pu(t)||Wt(Bb(e,t).dom,t).exists(pu),x1=e=>De(["pre","pre-wrap"],e),Eu=e=>Ga(e).bind(t=>yo(t,Qt)).exists(t=>x1(kn(t,"white-space"))),N1=(e,t)=>an(e.dom,t).isNone(),_1=(e,t)=>Wt(e.dom,t).isNone(),A1=(e,t)=>N1(e,t)||_1(e,t)||Cu(e,t)||Pb(e,t)||vu(e,t)||yu(e,t),R1=e=>oe(e)&&Oe(e)&&Up(e),T1=e=>t=>R1(new Ve(t,e).next()),P1=(e,t)=>{const n=Wt(e.dom,t).getOr(t),s=T1(e.dom);return t.isAtEnd()&&(s(t.container())||s(n.container()))},D1=(e,t)=>Eu(t)?!1:A1(e,t)||Ob(e,t)||$b(e,t),pi=(e,t)=>Eu(t)?!1:Cu(e,t)||v1(e,t)||vu(e,t)||Ob(e,t),B1=e=>{const t=e.container(),n=e.offset();return M(t)&&n<t.data.length?N(t,n+1):e},hi=(e,t)=>Eu(t)?!1:Pb(e,t)||E1(e,t)||yu(e,t)||$b(e,t)||P1(e,t),Lb=(e,t)=>pi(e,t)||hi(e,B1(t)),Ib=(e,t)=>Ja(e.charAt(t)),O1=e=>{const t=e.container();return M(t)&&ft(t.data,it)},$1=e=>{const t=e.split("");return Ee(t,(n,s)=>Ja(n)&&s>0&&s<t.length-1&&Ic(t[s-1])&&Ic(t[s+1])?" ":n).join("")},L1=(e,t)=>{const n=t.data,s=N(t,0);return Ib(n,0)&&!Lb(e,s)?(t.data=" "+n.slice(1),!0):!1},I1=e=>{const t=e.data,n=$1(t);return n!==t?(e.data=n,!0):!1},F1=(e,t)=>{const n=t.data,s=N(t,n.length-1);return Ib(n,n.length-1)&&!Lb(e,s)?(t.data=n.slice(0,-1)+" ",!0):!1},M1=(e,t)=>d.some(t).filter(O1).bind(n=>{const s=n.container();return L1(e,s)||I1(s)||F1(e,s)?d.some(n):d.none()}),U1=e=>{const t=C.fromDom(e.getBody());e.selection.isCollapsed()&&M1(t,N.fromRangeStart(e.selection.getRng())).each(n=>{e.selection.setRng(n.toRange())})},Fb=(e,t,n)=>{if(n===0)return;const s=C.fromDom(e),o=Co(s,sn).getOr(s),r=e.data.slice(t,t+n),a=t+n>=e.data.length&&hi(o,N(e,e.data.length)),i=t===0&&pi(o,N(e,0));e.replaceData(t,n,yg(r,4,i,a))},bi=(e,t)=>{const n=e.data.slice(t),s=n.length-ew(n).length;Fb(e,t,s)},Su=(e,t)=>{const n=e.data.slice(0,t),s=n.length-Jd(n).length;Fb(e,t-s,s)},wu=(e,t,n,s=!0)=>{const o=Jd(e.data).length,r=s?e:t,a=s?t:e;return s?r.appendData(a.data):r.insertData(0,a.data),Fe(C.fromDom(a)),n&&bi(r,o),r},z1=(e,t)=>{const n=e.container(),s=e.offset();return N.isTextPosition(e)===!1&&n===t.parentNode&&s>N.before(t).offset()},H1=(e,t)=>z1(t,e)?N(t.container(),t.offset()-1):t,V1=e=>M(e)?N(e,0):N.before(e),W1=e=>M(e)?N(e,e.data.length):N.after(e),Mb=e=>tn(e.previousSibling)?d.some(W1(e.previousSibling)):e.previousSibling?Pn(e.previousSibling):d.none(),Ub=e=>tn(e.nextSibling)?d.some(V1(e.nextSibling)):e.nextSibling?yt(e.nextSibling):d.none(),j1=(e,t)=>{const n=N.before(t.previousSibling?t.previousSibling:t.parentNode);return an(e,n).fold(()=>Wt(e,N.after(t)),d.some)},q1=(e,t)=>Wt(e,N.after(t)).fold(()=>an(e,N.before(t)),d.some),K1=(e,t)=>Mb(t).orThunk(()=>Ub(t)).orThunk(()=>j1(e,t)),G1=(e,t)=>Ub(t).orThunk(()=>Mb(t)).orThunk(()=>q1(e,t)),Y1=(e,t,n)=>e?G1(t,n):K1(t,n),X1=(e,t,n)=>Y1(e,t,n).map(V(H1,n)),zb=(e,t,n)=>{n.fold(()=>{e.focus()},s=>{e.selection.setRng(s.toRange(),t)})},Q1=e=>t=>t.dom===e,Z1=(e,t)=>t&&fe(e.schema.getBlockElements(),Be(t)),J1=e=>{if(Xe(e)){const t=C.fromHtml('<br data-mce-bogus="1">');return Cr(e),qe(e,t),d.some(N.before(t.dom))}else return d.none()},eP=(e,t,n)=>{const s=_s(e).filter(Ut),o=br(e).filter(Ut);return Fe(e),bw(s,o,t,(r,a,i)=>{const l=r.dom,c=a.dom,u=l.data.length;return wu(l,c,n),i.container()===c?N(l,u):i}).orThunk(()=>(n&&(s.each(r=>Su(r.dom,r.dom.length)),o.each(r=>bi(r.dom,0))),t))},tP=(e,t)=>fe(e.schema.getTextInlineElements(),Be(t)),Gs=(e,t,n,s=!0)=>{const o=X1(t,e.getBody(),n.dom),r=Co(n,V(Z1,e),Q1(e.getBody())),a=eP(n,o,tP(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):r.bind(J1).fold(()=>{s&&zb(e,t,a)},i=>{s&&zb(e,t,d.some(i))})},nP=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,sP=e=>nP.test(e),Ys=(e,t)=>wn(C.fromDom(t),KN(e)),oP=e=>Re.DOM.getStyle(e,"direction",!0)==="rtl"||sP(e.textContent),rP=(e,t,n)=>re(Re.DOM.getParents(n.container(),"*",t),e),bs=(e,t,n)=>{const s=rP(e,t,n);return d.from(s[s.length-1])},aP=(e,t,n)=>{const s=ds(t,e),o=ds(n,e);return s&&s===o},iP=e=>nc(e)||sc(e),Kt=(e,t)=>{if(!t)return t;const n=t.container(),s=t.offset();return e?wo(n)?M(n.nextSibling)?N(n.nextSibling,0):N.after(n):nc(t)?N(n,s+1):t:wo(n)?M(n.previousSibling)?N(n.previousSibling,n.previousSibling.data.length):N.before(n):sc(t)?N(n,s-1):t},Hb=V(Kt,!0),Vb=V(Kt,!1),Wb=(e,t)=>{const n=s=>s.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},ku=e=>Wb(e,"Delete"),lP=e=>Wb(e,"ForwardDelete"),cP=e=>t=>Ae(e,C.fromDom(t.dom.parentNode)),uP=e=>Sk(e)||Sr(e),Ci=(e,t)=>Vn(e,t)?yo(t,uP,cP(e)):d.none(),fP=e=>{const t=e.getBody(),n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)},jb=e=>{e.dom.isEmpty(e.getBody())&&(e.setContent(""),fP(e))},dP=(e,t,n)=>_t(yt(n),Pn(n),(s,o)=>{const r=Kt(!0,s),a=Kt(!1,o),i=Kt(!1,t);return e?Wt(n,i).exists(l=>l.isEqual(a)&&t.isEqual(r)):an(n,i).exists(l=>l.isEqual(r)&&t.isEqual(a))}).getOr(!0),qb=e=>(Cw(e)?_s(e):jl(e)).bind(qb).orThunk(()=>d.some(e)),Kb=(e,t,n,s=!0)=>{t.deleteContents();const o=qb(n).getOr(n),r=C.fromDom(e.dom.getParent(o.dom,e.dom.isBlock));if(Xe(r)&&(Ks(r),s&&e.selection.setCursorLocation(r.dom,0)),!Ae(n,r)){const a=go(Zt(r),n)?[]:Ow(r);B(a.concat(at(n)),i=>{!Ae(i,r)&&!Vn(i,r)&&Xe(i)&&Fe(i)})}},mP=e=>t=>Ae(e,t),xu=e=>At(e,"td,th"),gP=(e,t)=>{const n=c=>Vr(C.fromDom(c),t),s=n(e.startContainer),o=n(e.endContainer),r=s.isSome(),a=o.isSome(),i=_t(s,o,Ae).getOr(!1);return{startTable:s,endTable:o,isStartInTable:r,isEndInTable:a,isSameTable:i,isMultiTable:!i&&r&&a}},Nu=(e,t)=>({start:e,end:t}),pP=(e,t,n)=>({rng:e,table:t,cells:n}),Xr=_n.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),yi=(e,t)=>Bs(C.fromDom(e),"td,th",t),Gb=e=>!Ae(e.start,e.end),Yb=(e,t)=>Vr(e.start,t).bind(n=>Vr(e.end,t).bind(s=>Hl(Ae(n,s),n))),hP=(e,t)=>!Gb(e)&&Yb(e,t).exists(n=>{const s=n.dom.rows;return s.length===1&&s[0].cells.length===1}),bP=(e,t)=>{const n=yi(e.startContainer,t),s=yi(e.endContainer,t);return _t(n,s,Nu)},CP=e=>t=>Vr(t,e).bind(n=>lo(xu(n)).map(s=>Nu(t,s))),yP=e=>t=>Vr(t,e).bind(n=>Lt(xu(n)).map(s=>Nu(s,t))),_u=e=>t=>Yb(t,e).map(n=>pP(t,n,xu(n))),Xb=(e,t,n,s)=>{if(n.collapsed||!e.forall(Gb))return d.none();if(t.isSameTable){const o=e.bind(_u(s));return d.some({start:o,end:o})}else{const o=yi(n.startContainer,s),r=yi(n.endContainer,s),a=o.bind(CP(s)).bind(_u(s)),i=r.bind(yP(s)).bind(_u(s));return d.some({start:a,end:i})}},Qb=(e,t)=>or(e,n=>Ae(n,t)),Au=e=>_t(Qb(e.cells,e.rng.start),Qb(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),vP=(e,t,n)=>e.exists(s=>hP(s,n)&&qc(s.start,t)),Zb=(e,t)=>{const{startTable:n,endTable:s}=t,o=e.cloneRange();return n.each(r=>o.setStartAfter(r.dom)),s.each(r=>o.setEndBefore(r.dom)),o},EP=(e,t,n,s)=>Xb(e,t,n,s).bind(({start:o,end:r})=>o.or(r)).bind(o=>{const{isSameTable:r}=t,a=Au(o).getOr([]);if(r&&o.cells.length===a.length)return d.some(Xr.fullTable(o.table));if(a.length>0){if(r)return d.some(Xr.partialTable(a,d.none()));{const i=Zb(n,t);return d.some(Xr.partialTable(a,d.some({...t,rng:i})))}}else return d.none()}),SP=(e,t,n,s)=>Xb(e,t,n,s).bind(({start:o,end:r})=>{const a=o.bind(Au).getOr([]),i=r.bind(Au).getOr([]);if(a.length>0&&i.length>0){const l=Zb(n,t);return d.some(Xr.multiTable(a,i,l))}else return d.none()}),wP=(e,t)=>{const n=mP(e),s=bP(t,n),o=gP(t,n);return vP(s,t,n)?s.map(r=>Xr.singleCellTable(t,r.start)):o.isMultiTable?SP(s,o,t,n):EP(s,o,t,n)},Jb=e=>B(e,t=>{rt(t,"contenteditable"),Ks(t)}),kP=(e,t)=>d.from(e.dom.getParent(t,e.dom.isBlock)).map(C.fromDom),xP=(e,t,n)=>{n.each(s=>{t?Fe(s):(Ks(s),e.selection.setCursorLocation(s.dom,0))})},Ru=(e,t,n,s)=>{const o=n.cloneRange();s?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),Tu(e,o,t,!1).each(r=>r())},eC=e=>{const t=Io(e),n=C.fromDom(e.selection.getNode());Ra(n.dom)&&Xe(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&Me(t,s=>Ae(s,n))&&ot(n,"data-mce-selected","1")},tC=(e,t,n)=>d.some(()=>{const s=e.selection.getRng(),o=n.bind(({rng:r,isStartInTable:a})=>{const i=kP(e,a?r.endContainer:r.startContainer);r.deleteContents(),xP(e,a,i.filter(Xe));const l=a?t[0]:t[t.length-1];return Ru(e,l,s,a),Xe(l)?d.none():d.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);Jb(o),eC(e)}),NP=(e,t,n,s)=>d.some(()=>{const o=e.selection.getRng(),r=t[0],a=n[n.length-1];Ru(e,r,o,!0),Ru(e,a,o,!1);const i=Xe(r)?t:t.slice(1),l=Xe(a)?n:n.slice(0,-1);Jb(i.concat(l)),s.deleteContents(),eC(e)}),Tu=(e,t,n,s=!0)=>d.some(()=>{Kb(e,t,n,s)}),_P=(e,t)=>d.some(()=>Gs(e,!1,t)),AP=(e,t,n)=>wP(t,n).bind(s=>s.fold(V(Tu,e),V(_P,e),V(tC,e),V(NP,e))),RP=(e,t)=>vi(e,t),TP=(e,t,n,s)=>Pu(t,s).fold(()=>AP(e,t,n),o=>RP(e,o)),PP=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.selection.getRng();return n.length!==0?tC(e,n,d.none()):TP(e,s,o,t)},nC=(e,t)=>Ye(Kn(t,e),Ta),Pu=(e,t)=>Ye(Kn(t,e),_m("caption")),DP=(e,t,n,s,o)=>Qa(n,e.getBody(),o).bind(r=>nC(t,C.fromDom(r.getNode())).bind(a=>Ae(a,s)?d.none():d.some(me))),vi=(e,t)=>d.some(()=>{Ks(t),e.selection.setCursorLocation(t.dom,0)}),BP=(e,t,n,s)=>yt(e.dom).bind(o=>Pn(e.dom).map(r=>t?n.isEqual(o)&&s.isEqual(r):n.isEqual(r)&&s.isEqual(o))).getOr(!0),OP=(e,t)=>vi(e,t),$P=(e,t,n)=>Pu(e,C.fromDom(n.getNode())).fold(()=>d.some(me),s=>Hl(!Ae(s,t),me)),LP=(e,t,n,s,o)=>Qa(n,e.getBody(),o).fold(()=>d.some(me),r=>BP(s,n,o,r)?OP(e,s):$P(t,s,r)),IP=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return nC(n,s).bind(r=>Xe(r)?vi(e,r):DP(e,n,t,r,o))},FP=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return Xe(s)?vi(e,s):LP(e,n,t,s,o)},sC=(e,t)=>e?xb(t):Nb(t),MP=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return sC(t,n)||Vt(t,e.getBody(),n).exists(s=>sC(t,s))},UP=(e,t,n)=>{const s=C.fromDom(e.getBody());return Pu(s,n).fold(()=>IP(e,t,s,n).orThunk(()=>Hl(MP(e,t),me)),o=>FP(e,t,s,o))},Du=(e,t)=>{const n=C.fromDom(e.selection.getStart(!0)),s=Io(e);return e.selection.isCollapsed()&&s.length===0?UP(e,t,n):PP(e,n,s)},Qr=(e,t)=>{for(;t&&t!==e;){if(xn(t)||Oe(t))return t;t=t.parentNode}return null},Bu=(e,t)=>{t(e),e.firstChild&&Bu(e.firstChild,t),e.next&&Bu(e.next,t)},oC=(e,t,n,s)=>{const o=n.name;for(let r=0,a=e.length;r<a;r++){const i=e[r];if(i.name===o){const l=s.nodes[o];l?l.nodes.push(n):s.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let r=0,a=t.length;r<a;r++){const i=t[r],l=i.name;if(l in n.attributes.map){const c=s.attributes[l];c?c.nodes.push(n):s.attributes[l]={filter:i,nodes:[n]}}}},zP=(e,t,n)=>{const s={nodes:{},attributes:{}};return n.firstChild&&Bu(n.firstChild,o=>{oC(e,t,o,s)}),s},rC=(e,t)=>{const n=s=>{Pe(s,o=>{const r=re(o.nodes,a=>oe(a.parent));B(o.filter.callbacks,a=>{a(r,o.filter.name,t)})})};n(e.nodes),n(e.attributes)},aC=(e,t,n,s={})=>{const o=zP(e,t,n);rC(o,s)},Ou=(e,t,n,s)=>{t.insert&&n[s.name]?s.empty().append(new vt("br",1)):s.empty().append(new vt("#text",3)).value=it},HP=e=>iC(e,"#text")&&e.firstChild.value===it,iC=(e,t)=>e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t,VP=(e,t)=>{const n=e.getElementRule(t.name);return n&&n.paddEmpty},Zr=(e,t,n,s)=>s.isEmpty(t,n,o=>VP(e,o)),WP=(e,t)=>e&&(e.name in t||e.name==="br"),$u=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const s=e.children();for(const o of s)t.isValidChild(n.name,o.name)||$u(o,t,n);e.unwrap()}},Lu=(e,t,n=me)=>{const s=t.getTextBlockElements(),o=t.getNonEmptyElements(),r=t.getWhitespaceElements(),a=D.makeMap("tr,td,th,tbody,thead,tfoot,table"),i=new Set;for(let l=0;l<e.length;l++){const c=e[l];let u,f,m;if(!c.parent||i.has(c))continue;if(s[c.name]&&c.parent.name==="li"){let h=c.next;for(;h&&s[h.name];){h.name="li",i.add(h),c.parent.insert(h,c.parent);h=h.next}c.unwrap();continue}const g=[c];for(u=c.parent;u&&!t.isValidChild(u.name,c.name)&&!a[u.name];u=u.parent)g.push(u);if(u&&g.length>1)if(t.isValidChild(u.name,c.name)){g.reverse(),f=g[0].clone(),n(f);let h=f;for(let p=0;p<g.length-1;p++){t.isValidChild(h.name,g[p].name)?(m=g[p].clone(),n(m),h.append(m)):m=h;for(let b=g[p].firstChild;b&&b!==g[p+1];){const y=b.next;m.append(b),b=y}h=m}Zr(t,o,r,f)?u.insert(c,g[0],!0):(u.insert(f,g[0],!0),u.insert(c,f)),u=g[0],(Zr(t,o,r,u)||iC(u,"br"))&&u.empty().remove()}else $u(c,t);else if(c.parent){if(c.name==="li"){let h=c.prev;if(h&&(h.name==="ul"||h.name==="ol")){h.append(c);continue}if(h=c.next,h&&(h.name==="ul"||h.name==="ol")){h.insert(c,h.firstChild,!0);continue}const p=new vt("ul",1);n(p),c.wrap(p);continue}if(t.isValidChild(c.parent.name,"div")&&t.isValidChild("div",c.name)){const h=new vt("div",1);n(h),c.wrap(h)}else $u(c,t)}}},jP=(e,t,n,s)=>{const o=document.createRange();return o.setStart(e,t),o.setEnd(n,s),o},qP=e=>{const t=N.fromRangeStart(e),n=N.fromRangeEnd(e),s=e.commonAncestorContainer;return Vt(!1,s,n).map(o=>!An(t,n,s)&&An(t,o,s)?jP(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},Iu=e=>e.collapsed?e:qP(e),KP=e=>e.firstChild&&e.firstChild===e.lastChild,GP=e=>e.name==="br"||e.value===it,YP=(e,t)=>e.getBlockElements()[t.name]&&KP(t)&&GP(t.firstChild),XP=(e,t)=>{const n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||YP(e,t))},QP=(e,t)=>{let n=t.firstChild,s=t.lastChild;return n&&n.name==="meta"&&(n=n.next),s&&s.attr("id")==="mce_marker"&&(s=s.prev),XP(e,s)&&(s=s.prev),!n||n!==s?!1:n.name==="ul"||n.name==="ol"},ZP=e=>{const t=e.firstChild,n=e.lastChild;return t&&t.nodeName==="META"&&t.parentNode.removeChild(t),n&&n.id==="mce_marker"&&n.parentNode.removeChild(n),e},JP=(e,t,n)=>{const s=t.serialize(n),o=e.createFragment(s);return ZP(o)},eD=e=>re(e.childNodes,t=>t.nodeName==="LI"),tD=e=>e.data===it||Ue(e),nD=e=>e&&e.firstChild&&e.firstChild===e.lastChild&&tD(e.firstChild),sD=e=>!e.firstChild||nD(e),oD=e=>e.length>0&&sD(e[e.length-1])?e.slice(0,-1):e,Fu=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},rD=(e,t)=>!!Fu(e,t),aD=(e,t)=>{const n=t.cloneRange(),s=t.cloneRange();return n.setStartBefore(e),s.setEndAfter(e),[n.cloneContents(),s.cloneContents()]},iD=(e,t)=>{const n=N.before(e),o=Tn(t).next(n);return o?o.toRange():null},lC=(e,t)=>{const n=N.after(e),o=Tn(t).prev(n);return o?o.toRange():null},lD=(e,t,n,s)=>{const o=aD(e,s),r=e.parentNode;return r.insertBefore(o[0],e),D.each(t,a=>{r.insertBefore(a,e)}),r.insertBefore(o[1],e),r.removeChild(e),lC(t[t.length-1],n)},cD=(e,t,n)=>{const s=e.parentNode;return D.each(t,o=>{s.insertBefore(o,e)}),iD(e,n)},uD=(e,t,n,s)=>(s.insertAfter(t.reverse(),e),lC(t[0],n)),fD=(e,t,n,s)=>{const o=JP(t,e,s),r=Fu(t,n.startContainer),a=oD(eD(o.firstChild)),i=1,l=2,c=t.getRoot(),u=f=>{const m=N.fromRangeStart(n),g=Tn(t.getRoot()),h=f===i?g.prev(m):g.next(m);return h?Fu(t,h.getNode())!==r:!0};return u(i)?cD(r,a,c):u(l)?uD(r,a,c,t):lD(r,a,c,n)},dD=["pre"],mD=(e,t)=>{const n=e.firstChild,s=De(dD,n.name),o=n.name===t.tagName.toLowerCase(),r=e.lastChild.attr("data-mce-type")==="bookmark"?e.lastChild.prev:e.lastChild;return n===r&&s&&o},Mu=Ra,gD=(e,t,n)=>{if(n!==null){const s=e.getParent(t.endContainer,Mu);return n===s&&qc(C.fromDom(n),t)}else return!1},pD=(e,t,n)=>{if(n.getAttribute("data-mce-bogus")==="all")n.parentNode.insertBefore(e.dom.createFragment(t),n);else{const s=n.firstChild,o=n.lastChild;!s||s===o&&s.nodeName==="BR"?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})}},hD=(e,t)=>{d.from(e.getParent(t,"td,th")).map(C.fromDom).each(b1)},bD=(e,t)=>{const n=e.schema.getTextInlineElements(),s=e.dom;if(t){const o=e.getBody(),r=bb(s);D.each(s.select("*[data-mce-fragment]"),a=>{if(oe(n[a.nodeName.toLowerCase()])&&c1(s,a)){for(let l=a.parentNode;oe(l)&&l!==o&&!f1(s,a,l);l=l.parentNode)if(r.compare(l,a)){s.remove(a,!0);break}}})}},CD=e=>{let t=e;for(;t=t.walk();)t.type===1&&t.attr("data-mce-fragment","1")},yD=e=>{D.each(e.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")})},vD=e=>!!e.getAttribute("data-mce-fragment"),ED=(e,t)=>t&&!e.schema.getVoidElements()[t.nodeName],SD=(e,t)=>{let n;const s=e.dom,o=e.selection;if(!t)return;o.scrollIntoView(t);const r=Qr(e.getBody(),t);if(s.getContentEditable(r)==="false"){s.remove(t),o.select(r);return}let a=s.createRng();const i=t.previousSibling;if(M(i)){a.setStart(i,i.nodeValue.length);const u=t.nextSibling;M(u)&&(i.appendData(u.data),u.parentNode.removeChild(u))}else a.setStartBefore(t),a.setEndBefore(t);const l=u=>{let f=N.fromRangeStart(u);if(f=Tn(e.getBody()).next(f),f)return f.toRange()},c=s.getParent(t,s.isBlock);s.remove(t),c&&s.isEmpty(c)&&(Cr(C.fromDom(c)),a.setStart(c,0),a.setEnd(c,0),!Mu(c)&&!vD(c)&&(n=l(a))?(a=n,s.remove(c)):s.add(c,s.create("br",{"data-mce-bogus":"1"}))),o.setRng(a)},wD=e=>{const t=e.dom,n=Iu(e.selection.getRng());e.selection.setRng(n);const s=t.getParent(n.startContainer,Mu);gD(t,n,s)?Tu(e,n,C.fromDom(s)):e.getDoc().execCommand("Delete",!1,null)},kD=(e,t,n)=>{let s,o,r;const a=e.selection,i=e.dom,l=e.parser,c=n.merge,u=ms({validate:!0},e.schema),f='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,f),o=a.getRng();const m=o.startContainer||(o.parentElement?o.parentElement():null),g=e.getBody();m===g&&a.isCollapsed()&&i.isBlock(g.firstChild)&&ED(e,g.firstChild)&&i.isEmpty(g.firstChild)&&(o=i.createRng(),o.setStart(g.firstChild,0),o.setEnd(g.firstChild,0),a.setRng(o)),a.isCollapsed()||wD(e),s=a.getNode();const h={context:s.nodeName.toLowerCase(),data:n.data,insert:!0},p=l.parse(t,h);if(n.paste===!0&&QP(e.schema,p)&&rD(i,s))return o=fD(u,i,a.getRng(),p),a.setRng(o),t;if(n.paste===!0&&mD(p,s)&&p.firstChild.unwrap(),CD(p),r=p.lastChild,r.attr("id")==="mce_marker"){const b=r;for(r=r.prev;r;r=r.walk(!0))if(r.type===3||!i.isBlock(r.name)){e.schema.isValidChild(r.parent.name,"span")&&r.parent.insert(b,r,r.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(s),!h.invalid)t=u.serialize(p),pD(e,t,s);else{e.selection.setContent(f),s=a.getNode();const b=e.getBody();for(s.nodeType===9?s=r=b:r=s;r!==b;)s=r,r=r.parentNode;t=s===b?b.innerHTML:i.getOuterHTML(s);const y=l.parse(t);for(let _=y;_;_=_.walk())if(_.attr("id")==="mce_marker"){_.replace(p);break}const E=p.children(),S=p.parent.name;p.unwrap();const x=re(E,_=>!e.schema.isValidChild(S,_.name));Lu(x,e.schema),aC(l.getNodeFilters(),l.getAttributeFilters(),y),t=u.serialize(y),s===b?i.setHTML(b,t):i.setOuterHTML(s,t)}return bD(e,c),SD(e,i.get("mce_marker")),yD(e.getBody()),hD(i,a.getStart()),t},Ei=e=>e instanceof vt,xD=e=>{qs(e)&&yt(e.getBody()).each(t=>{const n=t.getNode(),s=yr(n)?yt(n).getOr(t):t;e.selection.setRng(s.toRange())})},Uu=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&xD(e)},ND=(e,t,n,s)=>{if(n.length===0||/^\s+$/.test(n)){const o='<br data-mce-bogus="1">';t.nodeName==="TABLE"?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");const r=Rt(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),r.toLowerCase())?(n=o,n=e.dom.createHTML(r,zs(e),n)):n||(n=o),Uu(e,n,s.no_selection),{content:n,html:n}}else{s.format!=="raw"&&(n=ms({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));const o=Pa(C.fromDom(t))?n:D.trim(n);return Uu(e,o,s.no_selection),{content:o,html:o}}},_D=(e,t,n,s)=>{aC(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);const o=ms({validate:!1},e.schema).serialize(n),r=Pa(C.fromDom(t))?o:D.trim(o);return Uu(e,r,s.no_selection),{content:n,html:r}},AD=(e,t,n)=>d.from(e.getBody()).map(s=>Ei(t)?_D(e,s,t,n):ND(e,s,t,n)).getOr({content:t,html:Ei(n.content)?"":n.content}),RD=(e,t)=>ck(e,t).isSome(),cC=e=>_e(e)?e:Le,TD=(e,t,n)=>{let s=e.dom;const o=cC(n);for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s),a=t(r);if(a.isSome())return a;if(o(r))break}return d.none()},zu=(e,t,n)=>{const s=t(e),o=cC(n);return s.orThunk(()=>o(e)?d.none():TD(e,t,o))},Hu=zc,uC=(e,t,n)=>{const s=e.formatter.get(n);if(s)for(let o=0;o<s.length;o++){const r=s[o];if(It(r)&&r.inherit===!1&&e.dom.is(t,r.selector))return!0}return!1},Vu=(e,t,n,s,o)=>{const r=e.dom.getRoot();return t===r?!1:(t=e.dom.getParent(t,a=>uC(e,a,n)?!0:a.parentNode===r||!!On(e,a,n,s,!0)),!!On(e,t,n,s,o))},Si=(e,t,n)=>Ze(n)&&Hu(t,n.inline)||Bn(n)&&Hu(t,n.block)?!0:It(n)?Z(t)&&e.is(t,n.selector):!1,fC=(e,t,n,s,o,r)=>{const a=n[s];if(_e(n.onmatch))return n.onmatch(t,n,s);if(a){if(kt(a.length)){for(const i in a)if(fe(a,i)){const l=s==="attributes"?e.getAttrib(t,i):ni(e,t,i),c=jn(a[i],r),u=xt(l)||va(l);if(u&&xt(c))continue;if(o&&u&&!n.exact||(!o||n.exact)&&!Hu(l,Hc(c,i)))return!1}}else for(let i=0;i<a.length;i++)if(s==="attributes"?e.getAttrib(t,a[i]):ni(e,t,a[i]))return!0}return!0},On=(e,t,n,s,o)=>{const r=e.formatter.get(n),a=e.dom;if(r&&t)for(let i=0;i<r.length;i++){const l=r[i];if(Si(e.dom,t,l)&&fC(a,t,l,"attributes",o,s)&&fC(a,t,l,"styles",o,s)){const c=l.classes;if(c){for(let u=0;u<c.length;u++)if(!e.dom.hasClass(t,jn(c[u],s)))return}return l}}},Wu=(e,t,n,s,o)=>{if(s)return Vu(e,s,t,n,o);if(s=e.selection.getNode(),Vu(e,s,t,n,o))return!0;const r=e.selection.getStart();return!!(r!==s&&Vu(e,r,t,n,o))},PD=(e,t,n)=>{const s=[],o={},r=e.selection.getStart();return e.dom.getParent(r,a=>{for(let i=0;i<t.length;i++){const l=t[i];!o[l]&&On(e,a,l,n)&&(o[l]=!0,s.push(l))}},e.dom.getRoot()),s},DD=(e,t)=>{const n=o=>Ae(o,C.fromDom(e.getBody())),s=(o,r)=>On(e,o.dom,r)?d.some(r):d.none();return d.from(e.selection.getStart(!0)).bind(o=>zu(C.fromDom(o),r=>co(t,a=>s(r,a)),n)).getOrNull()},BD=(e,t)=>{const n=e.formatter.get(t),s=e.dom;if(n){const o=e.selection.getStart(),r=si(s,o);for(let a=n.length-1;a>=0;a--){const i=n[a];if(!It(i))return!0;for(let l=r.length-1;l>=0;l--)if(s.is(r[l],i.selector))return!0}}return!1},OD=(e,t,n)=>$t(n,(s,o)=>{const r=AA(e,o);return e.formatter.matchNode(t,o,{},r)?s.concat([o]):s},[]),Uo=tt,dC="_mce_caret",$D=(e,t)=>e.importNode(t,!0),LD=e=>{const t=[];for(;e;){if(e.nodeType===3&&e.nodeValue!==Uo||e.childNodes.length>1)return[];e.nodeType===1&&t.push(e),e=e.firstChild}return t},mC=e=>LD(e).length>0,gC=e=>{if(e){const t=new Ve(e,e);for(e=t.current();e;e=t.next())if(M(e))return e}return null},ju=e=>{const t=C.fromTag("span");return Sn(t,{id:dC,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&qe(t,C.fromText(Uo)),t},ID=e=>{const t=gC(e);return t&&t.nodeValue.charAt(0)===Uo&&t.deleteData(0,1),t},qu=(e,t,n=!0)=>{const s=e.dom,o=e.selection;if(mC(t))Gs(e,!1,C.fromDom(t),n);else{const r=o.getRng(),a=s.getParent(t,s.isBlock),i=r.startContainer,l=r.startOffset,c=r.endContainer,u=r.endOffset,f=ID(t);s.remove(t,!0),i===f&&l>0&&r.setStart(f,l-1),c===f&&u>0&&r.setEnd(f,u-1),a&&s.isEmpty(a)&&Ks(C.fromDom(a)),o.setRng(r)}},Ku=(e,t,n=!0)=>{const s=e.dom,o=e.selection;if(t)qu(e,t,n);else if(t=Ws(e.getBody(),o.getStart()),!t)for(;t=s.get(dC);)qu(e,t,!1)},FD=(e,t,n)=>{const s=e.dom,o=s.getParent(n,V(Mc,e));o&&s.isEmpty(o)?n.parentNode.replaceChild(t,n):(h1(C.fromDom(n)),s.isEmpty(n)?n.parentNode.replaceChild(t,n):s.insertAfter(t,n))},pC=(e,t)=>(e.appendChild(t),t),hC=(e,t)=>{const n=Ca(e,(s,o)=>pC(s,o.cloneNode(!1)),t);return pC(n,n.ownerDocument.createTextNode(Uo))},MD=(e,t,n,s,o,r)=>{const a=e.formatter,i=e.dom,l=re(Xt(a.get()),f=>f!==s&&!ft(f,"removeformat")),c=OD(e,n,l);if(re(c,f=>!RA(e,f,s)).length>0){const f=n.cloneNode(!1);return i.add(t,f),a.remove(s,o,f,r),i.remove(f),d.some(f)}else return d.none()},UD=(e,t,n)=>{let s,o;const r=e.selection,a=r.getRng();let i=a.startOffset;const c=a.startContainer.nodeValue;s=Ws(e.getBody(),r.getStart()),s&&(o=gC(s));const u=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&i>0&&i<c.length&&u.test(c.charAt(i))&&u.test(c.charAt(i-1))){const f=r.getBookmark();a.collapse(!0);let m=Lo(e,a,e.formatter.get(t));m=fi(m),e.formatter.apply(t,n,m),r.moveToBookmark(f)}else(!s||o.nodeValue!==Uo)&&(s=$D(e.getDoc(),ju(!0).dom),o=s.firstChild,a.insertNode(s),i=1),e.formatter.apply(t,n,s),r.setCursorLocation(o,i)},zD=(e,t,n,s)=>{const o=e.dom,r=e.selection;let a,i,l;const c=[],u=r.getRng(),f=u.startContainer,m=u.startOffset;for(i=f,f.nodeType===3&&(m!==f.nodeValue.length&&(a=!0),i=i.parentNode);i;){if(On(e,i,t,n,s)){l=i;break}i.nextSibling&&(a=!0),c.push(i),i=i.parentNode}if(!!l)if(a){const g=r.getBookmark();u.collapse(!0);let h=Lo(e,u,e.formatter.get(t),!0);h=fi(h),e.formatter.remove(t,n,h,s),r.moveToBookmark(g)}else{const g=Ws(e.getBody(),l),h=ju(!1).dom;FD(e,h,g!==null?g:l);const p=MD(e,h,l,t,n,s),b=hC(c.concat(p.toArray()),h);qu(e,g,!1),r.setCursorLocation(b,1),o.isEmpty(l)&&o.remove(l)}},HD=(e,t)=>{const n=e.selection,s=e.getBody();Ku(e,null,!1),(t===8||t===46)&&n.isCollapsed()&&n.getStart().innerHTML===Uo&&Ku(e,Ws(s,n.getStart())),(t===37||t===39)&&Ku(e,Ws(s,n.getStart()))},VD=e=>{e.on("mouseup keydown",t=>{HD(e,t.keyCode)})},WD=(e,t)=>{const n=ju(!1),s=hC(t,n.dom);return Jt(C.fromDom(e),n),Fe(C.fromDom(e)),N(s,0)},jD=(e,t)=>{const n=e.schema.getTextInlineElements();return fe(n,Be(t))&&!Dn(t.dom)&&!Ds(t.dom)},qD=e=>Dn(e.dom)&&mC(e.dom),wi={},bC=fo,CC=cr,KD=(e,t)=>{wi[e]||(wi[e]=[]),wi[e].push(t)},GD=(e,t)=>{CC(wi[e],n=>{n(t)})};KD("pre",e=>{const t=e.selection.getRng();let n;const s=a=>r(a.previousSibling)&&Kd(n,a.previousSibling)!==-1,o=(a,i)=>{const l=C.fromDom(i),c=ns(l).dom;Fe(l),Rs(C.fromDom(a),[C.fromTag("br",c),C.fromTag("br",c),...at(l)])},r=en(["pre"]);t.collapsed||(n=e.selection.getSelectedBlocks(),CC(bC(bC(n,r),s),a=>{o(a.previousSibling,a)}))});const Gu=D.each,Yu=e=>Z(e)&&!jt(e)&&!Dn(e)&&!Ds(e),yC=(e,t)=>{for(let n=e;n;n=n[t]){if(M(n)&&zn(n.data))return e;if(Z(n)&&!jt(n))return n}return e},vC=(e,t,n)=>{const s=bb(e);if(t&&n&&(t=yC(t,"previousSibling"),n=yC(n,"nextSibling"),s.compare(t,n))){for(let o=t.nextSibling;o&&o!==n;){const r=o;o=o.nextSibling,t.appendChild(r)}return e.remove(n),D.each(D.grep(n.childNodes),o=>{t.appendChild(o)}),t}return n},EC=(e,t,n,s)=>{if(s&&t.merge_siblings!==!1){const o=vC(e,fh(s),s);vC(e,o,fh(o,!0))}},YD=(e,t,n)=>{if(t.clear_child_styles){const s=t.links?"*:not(a)":"*";Gu(e.select(s,n),o=>{Yu(o)&&Gu(t.styles,(r,a)=>{e.setStyle(o,a,"")})})}},Xu=(e,t,n)=>{Gu(e.childNodes,s=>{Yu(s)&&(t(s)&&n(s),s.hasChildNodes()&&Xu(s,t,n))})},XD=(e,t)=>{t.nodeName==="SPAN"&&e.getAttribs(t).length===0&&e.remove(t,!0)},SC=(e,t)=>n=>!!(n&&ni(e,n,t)),wC=(e,t,n)=>s=>{e.setStyle(s,t,n),s.getAttribute("style")===""&&s.removeAttribute("style"),XD(e,s)},Jr=_n.generate([{keep:[]},{rename:["name"]},{removed:[]}]),QD=/^(src|href|style)$/,Qu=D.each,ki=zc,ZD=e=>/^(TR|TH|TD)$/.test(e.nodeName),kC=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),xC=(e,t,n)=>{let s=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(Z(s)){const r=s.childNodes.length-1;!n&&o&&o--,s=s.childNodes[o>r?r:o]}return M(s)&&n&&o>=s.nodeValue.length&&(s=new Ve(s,e.getBody()).next()||s),M(s)&&!n&&o===0&&(s=new Ve(s,e.getBody()).prev()||s),s},NC=(e,t)=>{const n=t?"firstChild":"lastChild";if(ZD(e)&&e[n]){const s=e[n];return e.nodeName==="TR"&&s[n]||s}return e},Zu=(e,t,n,s)=>{const o=e.create(n,s);return t.parentNode.insertBefore(o,t),o.appendChild(t),o},_C=(e,t,n,s,o)=>{const r=C.fromDom(t),a=C.fromDom(e.create(s,o)),i=n?Mm(r):Fm(r);return Rs(a,i),n?(Jt(r,a),Xm(a,r)):(ss(r,a),qe(a,r)),a.dom},JD=(e,t)=>t.links&&e.nodeName==="A",eB=(e,t,n)=>{const s=t.parentNode;let o;const r=e.dom,a=Rt(e);Bn(n)&&s===r.getRoot()&&(!n.list_block||!ki(t,n.list_block))&&B(Nt(t.childNodes),i=>{Oo(e,a,i.nodeName.toLowerCase())?o?o.appendChild(i):(o=Zu(r,i,a),r.setAttribs(o,zs(e))):o=null}),!(TA(n)&&!ki(n.inline,t))&&r.remove(t,!0)},AC=(e,t,n,s,o)=>{let r;const a=e.dom;if(!Si(a,s,t)&&!JD(s,t))return Jr.keep();const i=s;if(Ze(t)&&t.remove==="all"&&Ge(t.preserve_attributes)){const l=re(a.getAttribs(i),c=>De(t.preserve_attributes,c.name.toLowerCase()));if(a.removeAllAttribs(i),B(l,c=>a.setAttrib(i,c.name,c.value)),l.length>0)return Jr.rename("span")}if(t.remove!=="all"){Qu(t.styles,(c,u)=>{c=Hc(jn(c,n),u+""),yn(u)&&(u=c,o=null),(t.remove_similar||!o||ki(ni(a,o,u),c))&&a.setStyle(i,u,""),r=!0}),r&&a.getAttrib(i,"style")===""&&(i.removeAttribute("style"),i.removeAttribute("data-mce-style")),Qu(t.attributes,(c,u)=>{let f;if(c=jn(c,n),yn(u)&&(u=c,o=null),t.remove_similar||!o||ki(a.getAttrib(o,u),c)){if(u==="class"&&(c=a.getAttrib(i,u),c&&(f="",B(c.split(/\s+/),m=>{/mce\-\w+/.test(m)&&(f+=(f?" ":"")+m)}),f))){a.setAttrib(i,u,f);return}if(QD.test(u)&&i.removeAttribute("data-mce-"+u),u==="style"&&en(["li"])(i)&&a.getStyle(i,"list-style-type")==="none"){i.removeAttribute(u),a.setStyle(i,"list-style-type","none");return}u==="class"&&i.removeAttribute("className"),i.removeAttribute(u)}}),Qu(t.classes,c=>{c=jn(c,n),(!o||a.hasClass(o,c))&&a.removeClass(i,c)});const l=a.getAttribs(i);for(let c=0;c<l.length;c++){const u=l[c].nodeName;if(u.indexOf("_")!==0&&u.indexOf("data-")!==0)return Jr.keep()}}return t.remove!=="none"?(eB(e,i,t),Jr.removed()):Jr.keep()},zo=(e,t,n,s,o)=>AC(e,t,n,s,o).fold(Le,r=>(e.dom.rename(s,r),!0),je),tB=(e,t,n,s,o)=>{let r;return B(si(e.dom,t.parentNode).reverse(),a=>{if(!r&&a.id!=="_start"&&a.id!=="_end"){const i=On(e,a,n,s,o);i&&i.split!==!1&&(r=a)}}),r},nB=(e,t,n,s)=>AC(e,t,n,s,s).fold(F(s),o=>(e.dom.createFragment().appendChild(s),e.dom.rename(s,o)),F(null)),sB=(e,t,n,s,o,r,a,i)=>{let l,c,u;const f=e.dom;if(n){const m=n.parentNode;for(let g=s.parentNode;g&&g!==m;g=g.parentNode){l=f.clone(g,!1);for(let h=0;h<t.length&&(l=nB(e,t[h],i,l),l!==null);h++);l&&(c&&l.appendChild(c),u||(u=l),c=l)}r&&(!a.mixed||!f.isBlock(n))&&(s=f.split(n,s)),c&&(o.parentNode.insertBefore(c,o),u.appendChild(o),Ze(a)&&EC(f,a,i,c))}return s},RC=(e,t,n,s,o)=>{const r=e.formatter.get(t),a=r[0];let i=!0;const l=e.dom,c=e.selection,u=b=>{const y=tB(e,b,t,n,o);return sB(e,r,y,b,b,!0,a,n)},f=b=>jt(b)&&Z(b)&&(b.id==="_start"||b.id==="_end"),m=b=>Me(r,y=>zo(e,y,n,b,b)),g=b=>{let y=!0,E=!1;Z(b)&&l.getContentEditable(b)&&(y=i,i=l.getContentEditable(b)==="true",E=!0);const S=Nt(b.childNodes);if(i&&!E){const j=m(b)||Me(r,T=>Si(l,b,T)),A=b.parentNode;!j&&oe(A)&&Vc(a)&&m(A)}if(a.deep&&S.length){for(let _=0;_<S.length;_++)g(S[_]);E&&(i=y)}B(["underline","line-through","overline"],_=>{Z(b)&&e.dom.getStyle(b,"text-decoration")===_&&b.parentNode&&dh(l,b.parentNode)===_&&zo(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:_}},null,b)})},h=b=>{const y=l.get(b?"_start":"_end");let E=y[b?"firstChild":"lastChild"];return f(E)&&(E=E[b?"firstChild":"lastChild"]),M(E)&&E.data.length===0&&(E=b?y.previousSibling||y.nextSibling:y.nextSibling||y.previousSibling),l.remove(y,!0),E},p=b=>{let y,E,S=Lo(e,b,r,b.collapsed);if(a.split){if(S=fi(S),y=xC(e,S,!0),E=xC(e,S),y!==E){if(y=NC(y,!0),E=NC(E,!1),kC(l,y,E)){const _=d.from(y.firstChild).getOr(y);u(_C(l,_,!0,"span",{id:"_start","data-mce-type":"bookmark"})),h(!0);return}if(kC(l,E,y)){const _=d.from(E.lastChild).getOr(E);u(_C(l,_,!1,"span",{id:"_end","data-mce-type":"bookmark"})),h(!1);return}y=Zu(l,y,"span",{id:"_start","data-mce-type":"bookmark"}),E=Zu(l,E,"span",{id:"_end","data-mce-type":"bookmark"});const x=l.createRng();x.setStartAfter(y),x.setEndBefore(E),Hr(l,x,_=>{B(_,j=>{!jt(j)&&!jt(j.parentNode)&&u(j)})}),u(y),u(E),y=h(!0),E=h()}else y=E=u(y);S.startContainer=y.parentNode?y.parentNode:y,S.startOffset=l.nodeIndex(y),S.endContainer=E.parentNode?E.parentNode:E,S.endOffset=l.nodeIndex(E)+1}Hr(l,S,x=>{B(x,g)})};if(s){if(ti(s)){const b=l.createRng();b.setStartBefore(s),b.setEndAfter(s),p(b)}else p(s);Qc(e,t,s,n);return}if(l.getContentEditable(c.getNode())==="false"){s=c.getNode();for(let b=0;b<r.length&&!(r[b].ceFalseOverride&&zo(e,r[b],n,s,s));b++);Qc(e,t,s,n);return}!c.isCollapsed()||!Ze(a)||Io(e).length?(Yc(c,!0,()=>{Gc(e,p)}),Ze(a)&&Wu(e,t,n,c.getStart())&&uh(l,c,c.getRng()),e.nodeChanged()):zD(e,t,n,o),Qc(e,t,s,n)},TC=D.each,oB=(e,t,n,s)=>{const o=r=>{if(r.nodeType===1&&r.parentNode&&r.parentNode.nodeType===1){const a=dh(e,r.parentNode);e.getStyle(r,"color")&&a?e.setStyle(r,"text-decoration",a):e.getStyle(r,"text-decoration")===a&&e.setStyle(r,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(D.walk(s,o,"childNodes"),o(s))},rB=(e,t,n,s)=>{t.styles&&t.styles.backgroundColor&&Xu(s,SC(e,"fontSize"),wC(e,"backgroundColor",jn(t.styles.backgroundColor,n)))},aB=(e,t,n,s)=>{Ze(t)&&(t.inline==="sub"||t.inline==="sup")&&(Xu(s,SC(e,"fontSize"),wC(e,"fontSize","")),e.remove(e.select(t.inline==="sup"?"sub":"sup",s),!0))},iB=(e,t,n,s)=>{TC(t,o=>{Ze(o)&&TC(e.dom.select(o.inline,s),r=>{!Yu(r)||zo(e,o,n,r,o.exact?r:null)}),YD(e.dom,o,s)})},lB=(e,t,n,s,o)=>{On(e,o.parentNode,n,s)&&zo(e,t,s,o)||t.merge_with_parents&&e.dom.getParent(o.parentNode,r=>{if(On(e,r,n,s))return zo(e,t,s,o),!0})},xi=D.each,cB=e=>Z(e)&&!jt(e)&&!Dn(e)&&!Ds(e),uB=(e,t,n,s)=>{if(t_(e)&&Ze(t)){const o=_g(e.schema),r=RD(C.fromDom(n),a=>Dn(a.dom));return uo(o,s)&&Xe(C.fromDom(n.parentNode),!1)&&!r}else return!1},PC=(e,t,n,s)=>{const o=e.formatter.get(t),r=o[0],a=!s&&e.selection.isCollapsed(),i=e.dom,l=e.selection,c=(g,h=r)=>{if(_e(h.onformat)&&h.onformat(g,h,n,s),xi(h.styles,(p,b)=>{i.setStyle(g,b,jn(p,n))}),h.styles){const p=i.getAttrib(g,"style");p&&i.setAttrib(g,"data-mce-style",p)}xi(h.attributes,(p,b)=>{i.setAttrib(g,b,jn(p,n))}),xi(h.classes,p=>{p=jn(p,n),i.hasClass(g,p)||i.addClass(g,p)})},u=(g,h)=>{let p=!1;return xi(g,b=>{if(!It(b))return!1;if(!(oe(b.collapsed)&&b.collapsed!==a)&&i.is(h,b.selector)&&!Dn(h))return c(h,b),p=!0,!1}),p},f=g=>{if(ne(g)){const h=i.create(g);return c(h),h}else return null},m=(g,h,p)=>{const b=[];let y=!0;const E=r.inline||r.block,S=f(E);Hr(g,h,x=>{let _;const j=A=>{let T=!1,$=y;const L=A.nodeName.toLowerCase(),Q=A.parentNode,q=Q.nodeName.toLowerCase();if(Z(A)&&g.getContentEditable(A)&&($=y,y=g.getContentEditable(A)==="true",T=!0),Ue(A)&&!uB(e,r,A,q)){_=null,Bn(r)&&g.remove(A);return}if(Bn(r)&&r.wrapper&&On(e,A,t,n)){_=null;return}if(y&&!T&&Bn(r)&&!r.wrapper&&Mc(e,L)&&Oo(e,q,E)){const z=g.rename(A,E);c(z),b.push(z),_=null;return}if(It(r)){let z=u(o,A);if(!z&&oe(Q)&&Vc(r)&&(z=u(o,Q)),!Ze(r)||z){_=null;return}}y&&!T&&Oo(e,E,L)&&Oo(e,q,E)&&!(!p&&M(A)&&Da(A.data))&&!Dn(A)&&(!Ze(r)||!g.isBlock(A))?(_||(_=g.clone(S,!1),A.parentNode.insertBefore(_,A),b.push(_)),_.appendChild(A)):(_=null,B(Nt(A.childNodes),j),T&&(y=$),_=null)};B(x,j)}),r.links===!0&&B(b,x=>{const _=j=>{j.nodeName==="A"&&c(j,r),B(Nt(j.childNodes),_)};_(x)}),B(b,x=>{const _=T=>{let $=0;return B(T.childNodes,L=>{!_A(L)&&!jt(L)&&$++}),$},j=T=>Ye(T.childNodes,cB).filter(L=>Si(g,L,r)).map(L=>{const Q=g.clone(L,!1);return c(Q),g.replace(Q,T,!0),g.remove(L,!0),Q}).getOr(T),A=_(x);if((b.length>1||!g.isBlock(x))&&A===0){g.remove(x,!0);return}(Ze(r)||Bn(r)&&r.wrapper)&&(!r.exact&&A===1&&(x=j(x)),iB(e,o,n,x),lB(e,r,t,n,x),rB(g,r,n,x),oB(g,r,n,x),aB(g,r,n,x),EC(g,r,n,x))})};if(i.getContentEditable(l.getNode())==="false"){s=l.getNode();for(let g=0,h=o.length;g<h;g++){const p=o[g];if(p.ceFalseOverride&&It(p)&&i.is(s,p.selector)){c(s,p);break}}Ph(e,t,s,n);return}if(r){if(s)if(ti(s)){if(!u(o,s)){const g=i.createRng();g.setStartBefore(s),g.setEndAfter(s),m(i,Lo(e,g,o),!0)}}else m(i,s,!0);else!a||!Ze(r)||Io(e).length?(l.setRng(Iu(l.getRng())),Yc(l,!0,()=>{Gc(e,(g,h)=>{const p=h?g:Lo(e,g,o);m(i,p,!1)})}),uh(i,l,l.getRng()),e.nodeChanged()):UD(e,t,n);GD(t,e)}Ph(e,t,s,n)},DC=e=>fe(e,"vars"),fB=(e,t)=>{e.set({}),t.on("NodeChange",n=>{LC(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{const s=d.from(n.node).map(o=>ti(o)?o:o.startContainer).bind(o=>Z(o)?d.some(o):d.from(o.parentElement)).getOrThunk(()=>BC(t));LC(t,s,e.get())})},BC=e=>e.selection.getStart(),OC=(e,t,n,s,o)=>Vd(t,i=>{const l=e.formatter.matchNode(i,n,o!=null?o:{},s);return!kt(l)},i=>uC(e,i,n)?!0:s?!1:oe(e.formatter.matchNode(i,n,o,!0))),$C=(e,t)=>{const n=t!=null?t:BC(e);return re(si(e.dom,n),s=>Z(s)&&!Ds(s))},LC=(e,t,n)=>{const s=$C(e,t);Pe(n,(o,r)=>{const a=i=>{const l=OC(e,s,r,i.similar,DC(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);const u=l.getOr(t);DC(i)?i.callback(c,{node:u,format:r,parents:s}):B(i.callbacks,f=>f(c,{node:u,format:r,parents:s}))}};B([o.withSimilar,o.withoutSimilar],a),B(o.withVars,a)})},dB=(e,t,n,s,o,r)=>{const a=t.get();B(n.split(","),i=>{const l=Te(a,i).getOrThunk(()=>{const u={withSimilar:{state:Qe(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Qe(!1),similar:!1,callbacks:[]},withVars:[]};return a[i]=u,u}),c=()=>{const u=$C(e);return OC(e,u,i,o,r).isSome()};if(kt(r)){const u=o?l.withSimilar:l.withoutSimilar;u.callbacks.push(s),u.callbacks.length===1&&u.state.set(c())}else l.withVars.push({state:Qe(c()),similar:o,vars:r,callback:s})}),t.set(a)},mB=(e,t,n)=>{const s=e.get();B(t.split(","),o=>Te(s,o).each(r=>{s[o]={withSimilar:{...r.withSimilar,callbacks:re(r.withSimilar.callbacks,a=>a!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:re(r.withoutSimilar.callbacks,a=>a!==n)},withVars:re(r.withVars,a=>a.callback!==n)}})),e.set(s)},gB=(e,t,n,s,o,r)=>(t.get()===null&&fB(t,e),dB(e,t,n,s,o,r),{unbind:()=>mB(t,n,s)}),pB=(e,t,n,s)=>{const o=e.formatter.get(t);Wu(e,t,n,s)&&(!("toggle"in o[0])||o[0].toggle)?RC(e,t,n,s):PC(e,t,n,s)};function Xs(e){return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function Ju(e,t){return Ju=Object.setPrototypeOf||function(s,o){return s.__proto__=o,s},Ju(e,t)}function hB(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ni(e,t,n){return hB()?Ni=Reflect.construct:Ni=function(o,r,a){var i=[null];i.push.apply(i,r);var l=Function.bind.apply(o,i),c=new l;return a&&Ju(c,a.prototype),c},Ni.apply(null,arguments)}function ln(e){return bB(e)||CB(e)||yB(e)||vB()}function bB(e){if(Array.isArray(e))return ef(e)}function CB(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yB(e,t){if(!!e){if(typeof e=="string")return ef(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ef(e,t)}}function ef(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function vB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var EB=Object.hasOwnProperty,IC=Object.setPrototypeOf,SB=Object.isFrozen,wB=Object.getPrototypeOf,kB=Object.getOwnPropertyDescriptor,Tt=Object.freeze,$n=Object.seal,xB=Object.create,FC=typeof Reflect!="undefined"&&Reflect,_i=FC.apply,tf=FC.construct;_i||(_i=function(t,n,s){return t.apply(n,s)}),Tt||(Tt=function(t){return t}),$n||($n=function(t){return t}),tf||(tf=function(t,n){return Ni(t,ln(n))});var NB=cn(Array.prototype.forEach),_B=cn(Array.prototype.pop),ea=cn(Array.prototype.push),Ai=cn(String.prototype.toLowerCase),AB=cn(String.prototype.match),Cs=cn(String.prototype.replace),RB=cn(String.prototype.indexOf),TB=cn(String.prototype.trim),Pt=cn(RegExp.prototype.test),nf=PB(TypeError);function cn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return _i(e,t,s)}}function PB(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return tf(e,n)}}function we(e,t){IC&&IC(e,null);for(var n=t.length;n--;){var s=t[n];if(typeof s=="string"){var o=Ai(s);o!==s&&(SB(t)||(t[n]=o),s=o)}e[s]=!0}return e}function Qs(e){var t=xB(null),n;for(n in e)_i(EB,e,[n])&&(t[n]=e[n]);return t}function Ri(e,t){for(;e!==null;){var n=kB(e,t);if(n){if(n.get)return cn(n.get);if(typeof n.value=="function")return cn(n.value)}e=wB(e)}function s(o){return console.warn("fallback value for",o),null}return s}var MC=Tt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sf=Tt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),of=Tt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),DB=Tt(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rf=Tt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),BB=Tt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),UC=Tt(["#text"]),zC=Tt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),af=Tt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),HC=Tt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ti=Tt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),OB=$n(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$B=$n(/<%[\w\W]*|[\w\W]*%>/gm),LB=$n(/^data-[\-\w.\u00B7-\uFFFF]/),IB=$n(/^aria-[\-\w]+$/),FB=$n(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),MB=$n(/^(?:\w+script|data):/i),UB=$n(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zB=$n(/^html$/i),HB=function(){return typeof window=="undefined"?null:window},VB=function(t,n){if(Xs(t)!=="object"||typeof t.createPolicy!="function")return null;var s=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(s=n.currentScript.getAttribute(o));var r="dompurify"+(s?"#"+s:"");try{return t.createPolicy(r,{createHTML:function(i){return i}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function VC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:HB(),t=function(k){return VC(k)};if(t.version="2.3.8",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,s=e.document,o=e.DocumentFragment,r=e.HTMLTemplateElement,a=e.Node,i=e.Element,l=e.NodeFilter,c=e.NamedNodeMap,u=c===void 0?e.NamedNodeMap||e.MozNamedAttrMap:c,f=e.HTMLFormElement,m=e.DOMParser,g=e.trustedTypes,h=i.prototype,p=Ri(h,"cloneNode"),b=Ri(h,"nextSibling"),y=Ri(h,"childNodes"),E=Ri(h,"parentNode");if(typeof r=="function"){var S=s.createElement("template");S.content&&S.content.ownerDocument&&(s=S.content.ownerDocument)}var x=VB(g,n),_=x?x.createHTML(""):"",j=s,A=j.implementation,T=j.createNodeIterator,$=j.createDocumentFragment,L=j.getElementsByTagName,Q=n.importNode,q={};try{q=Qs(s).documentMode?s.documentMode:{}}catch{}var z={};t.isSupported=typeof E=="function"&&A&&typeof A.createHTMLDocument!="undefined"&&q!==9;var pe=OB,Ce=$B,ke=LB,ze=IB,O=MB,Y=UB,ue=FB,le=null,We=we({},[].concat(ln(MC),ln(sf),ln(of),ln(rf),ln(UC))),U=null,J=we({},[].concat(ln(zC),ln(af),ln(HC),ln(Ti))),K=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),I=null,ce=null,ge=!0,te=!0,ee=!1,ye=!1,ve=!1,He=!1,xe=!1,de=!1,Ne=!1,ct=!1,ut=!0,et=!0,gn=!1,St={},gt=null,Gt=we({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),vs=null,Fn=we({},["audio","video","img","source","image","track"]),Mn=null,pn=we({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),oo="http://www.w3.org/1998/Math/MathML",Es="http://www.w3.org/2000/svg",Yt="http://www.w3.org/1999/xhtml",hn=Yt,ro=!1,bn,vl=["application/xhtml+xml","text/html"],Pd="text/html",Qn,Zn=null,y0=s.createElement("form"),Dd=function(k){return k instanceof RegExp||k instanceof Function},El=function(k){Zn&&Zn===k||((!k||Xs(k)!=="object")&&(k={}),k=Qs(k),le="ALLOWED_TAGS"in k?we({},k.ALLOWED_TAGS):We,U="ALLOWED_ATTR"in k?we({},k.ALLOWED_ATTR):J,Mn="ADD_URI_SAFE_ATTR"in k?we(Qs(pn),k.ADD_URI_SAFE_ATTR):pn,vs="ADD_DATA_URI_TAGS"in k?we(Qs(Fn),k.ADD_DATA_URI_TAGS):Fn,gt="FORBID_CONTENTS"in k?we({},k.FORBID_CONTENTS):Gt,I="FORBID_TAGS"in k?we({},k.FORBID_TAGS):{},ce="FORBID_ATTR"in k?we({},k.FORBID_ATTR):{},St="USE_PROFILES"in k?k.USE_PROFILES:!1,ge=k.ALLOW_ARIA_ATTR!==!1,te=k.ALLOW_DATA_ATTR!==!1,ee=k.ALLOW_UNKNOWN_PROTOCOLS||!1,ye=k.SAFE_FOR_TEMPLATES||!1,ve=k.WHOLE_DOCUMENT||!1,de=k.RETURN_DOM||!1,Ne=k.RETURN_DOM_FRAGMENT||!1,ct=k.RETURN_TRUSTED_TYPE||!1,xe=k.FORCE_BODY||!1,ut=k.SANITIZE_DOM!==!1,et=k.KEEP_CONTENT!==!1,gn=k.IN_PLACE||!1,ue=k.ALLOWED_URI_REGEXP||ue,hn=k.NAMESPACE||Yt,k.CUSTOM_ELEMENT_HANDLING&&Dd(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(K.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&Dd(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(K.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(K.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),bn=vl.indexOf(k.PARSER_MEDIA_TYPE)===-1?bn=Pd:bn=k.PARSER_MEDIA_TYPE,Qn=bn==="application/xhtml+xml"?function(H){return H}:Ai,ye&&(te=!1),Ne&&(de=!0),St&&(le=we({},ln(UC)),U=[],St.html===!0&&(we(le,MC),we(U,zC)),St.svg===!0&&(we(le,sf),we(U,af),we(U,Ti)),St.svgFilters===!0&&(we(le,of),we(U,af),we(U,Ti)),St.mathMl===!0&&(we(le,rf),we(U,HC),we(U,Ti))),k.ADD_TAGS&&(le===We&&(le=Qs(le)),we(le,k.ADD_TAGS)),k.ADD_ATTR&&(U===J&&(U=Qs(U)),we(U,k.ADD_ATTR)),k.ADD_URI_SAFE_ATTR&&we(Mn,k.ADD_URI_SAFE_ATTR),k.FORBID_CONTENTS&&(gt===Gt&&(gt=Qs(gt)),we(gt,k.FORBID_CONTENTS)),et&&(le["#text"]=!0),ve&&we(le,["html","head","body"]),le.table&&(we(le,["tbody"]),delete I.tbody),Tt&&Tt(k),Zn=k)},Bd=we({},["mi","mo","mn","ms","mtext"]),Jn=we({},["foreignobject","desc","title","annotation-xml"]),Sl=we({},["title","style","font","a","script"]),v=we({},sf);we(v,of),we(v,DB);var w=we({},rf);we(w,BB);var P=function(k){var H=E(k);(!H||!H.tagName)&&(H={namespaceURI:Yt,tagName:"template"});var se=Ai(k.tagName),$e=Ai(H.tagName);return k.namespaceURI===Es?H.namespaceURI===Yt?se==="svg":H.namespaceURI===oo?se==="svg"&&($e==="annotation-xml"||Bd[$e]):Boolean(v[se]):k.namespaceURI===oo?H.namespaceURI===Yt?se==="math":H.namespaceURI===Es?se==="math"&&Jn[$e]:Boolean(w[se]):k.namespaceURI===Yt?H.namespaceURI===Es&&!Jn[$e]||H.namespaceURI===oo&&!Bd[$e]?!1:!w[se]&&(Sl[se]||!v[se]):!1},R=function(k){ea(t.removed,{element:k});try{k.parentNode.removeChild(k)}catch{try{k.outerHTML=_}catch{k.remove()}}},X=function(k,H){try{ea(t.removed,{attribute:H.getAttributeNode(k),from:H})}catch{ea(t.removed,{attribute:null,from:H})}if(H.removeAttribute(k),k==="is"&&!U[k])if(de||Ne)try{R(H)}catch{}else try{H.setAttribute(k,"")}catch{}},be=function(k){var H,se;if(xe)k="<remove></remove>"+k;else{var $e=AB(k,/^[\r\n\t ]+/);se=$e&&$e[0]}bn==="application/xhtml+xml"&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");var Mt=x?x.createHTML(k):k;if(hn===Yt)try{H=new m().parseFromString(Mt,bn)}catch{}if(!H||!H.documentElement){H=A.createDocument(hn,"template",null);try{H.documentElement.innerHTML=ro?"":Mt}catch{}}var wt=H.body||H.documentElement;return k&&se&&wt.insertBefore(s.createTextNode(se),wt.childNodes[0]||null),hn===Yt?L.call(H,ve?"html":"body")[0]:ve?H.documentElement:wt},he=function(k){return T.call(k.ownerDocument||k,k,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Bt=function(k){return k instanceof f&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof u)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function")},Cn=function(k){return Xs(a)==="object"?k instanceof a:k&&Xs(k)==="object"&&typeof k.nodeType=="number"&&typeof k.nodeName=="string"},es=function(k,H,se){!z[k]||NB(z[k],function($e){$e.call(t,H,se,Zn)})},v0=function(k){var H;if(es("beforeSanitizeElements",k,null),Bt(k)||Pt(/[\u0080-\uFFFF]/,k.nodeName))return R(k),!0;var se=Qn(k.nodeName);if(es("uponSanitizeElement",k,{tagName:se,allowedTags:le}),k.hasChildNodes()&&!Cn(k.firstElementChild)&&(!Cn(k.content)||!Cn(k.content.firstElementChild))&&Pt(/<[/\w]/g,k.innerHTML)&&Pt(/<[/\w]/g,k.textContent)||se==="select"&&Pt(/<template/i,k.innerHTML))return R(k),!0;if(!le[se]||I[se]){if(!I[se]&&S0(se)&&(K.tagNameCheck instanceof RegExp&&Pt(K.tagNameCheck,se)||K.tagNameCheck instanceof Function&&K.tagNameCheck(se)))return!1;if(et&&!gt[se]){var $e=E(k)||k.parentNode,Mt=y(k)||k.childNodes;if(Mt&&$e)for(var wt=Mt.length,pt=wt-1;pt>=0;--pt)$e.insertBefore(p(Mt[pt],!0),b(k))}return R(k),!0}return k instanceof i&&!P(k)||(se==="noscript"||se==="noembed")&&Pt(/<\/no(script|embed)/i,k.innerHTML)?(R(k),!0):(ye&&k.nodeType===3&&(H=k.textContent,H=Cs(H,pe," "),H=Cs(H,Ce," "),k.textContent!==H&&(ea(t.removed,{element:k.cloneNode()}),k.textContent=H)),es("afterSanitizeElements",k,null),!1)},E0=function(k,H,se){if(ut&&(H==="id"||H==="name")&&(se in s||se in y0))return!1;if(!(te&&!ce[H]&&Pt(ke,H))){if(!(ge&&Pt(ze,H))){if(!U[H]||ce[H]){if(!(S0(k)&&(K.tagNameCheck instanceof RegExp&&Pt(K.tagNameCheck,k)||K.tagNameCheck instanceof Function&&K.tagNameCheck(k))&&(K.attributeNameCheck instanceof RegExp&&Pt(K.attributeNameCheck,H)||K.attributeNameCheck instanceof Function&&K.attributeNameCheck(H))||H==="is"&&K.allowCustomizedBuiltInElements&&(K.tagNameCheck instanceof RegExp&&Pt(K.tagNameCheck,se)||K.tagNameCheck instanceof Function&&K.tagNameCheck(se))))return!1}else if(!Mn[H]){if(!Pt(ue,Cs(se,Y,""))){if(!((H==="src"||H==="xlink:href"||H==="href")&&k!=="script"&&RB(se,"data:")===0&&vs[k])){if(!(ee&&!Pt(O,Cs(se,Y,"")))){if(se)return!1}}}}}}return!0},S0=function(k){return k.indexOf("-")>0},w0=function(k){var H,se,$e,Mt;es("beforeSanitizeAttributes",k,null);var wt=k.attributes;if(!!wt){var pt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U};for(Mt=wt.length;Mt--;){H=wt[Mt];var wl=H,ht=wl.name,k0=wl.namespaceURI;se=ht==="value"?H.value:TB(H.value),$e=Qn(ht);var $8=se;if(pt.attrName=$e,pt.attrValue=se,pt.keepAttr=!0,pt.forceKeepAttr=void 0,es("uponSanitizeAttribute",k,pt),se=pt.attrValue,!pt.forceKeepAttr){if(!pt.keepAttr){X(ht,k);continue}if(Pt(/\/>/i,se)){X(ht,k);continue}ye&&(se=Cs(se,pe," "),se=Cs(se,Ce," "));var L8=Qn(k.nodeName);if(!E0(L8,$e,se)){X(ht,k);continue}if(se!==$8)try{k0?k.setAttributeNS(k0,ht,se):k.setAttribute(ht,se)}catch{X(ht,k)}}}es("afterSanitizeAttributes",k,null)}},O8=function ae(k){var H,se=he(k);for(es("beforeSanitizeShadowDOM",k,null);H=se.nextNode();)es("uponSanitizeShadowNode",H,null),!v0(H)&&(H.content instanceof o&&ae(H.content),w0(H));es("afterSanitizeShadowDOM",k,null)};return t.sanitize=function(ae,k){var H,se,$e,Mt,wt;if(ro=!ae,ro&&(ae="<!-->"),typeof ae!="string"&&!Cn(ae)){if(typeof ae.toString!="function")throw nf("toString is not a function");if(ae=ae.toString(),typeof ae!="string")throw nf("dirty is not a string, aborting")}if(!t.isSupported){if(Xs(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof ae=="string")return e.toStaticHTML(ae);if(Cn(ae))return e.toStaticHTML(ae.outerHTML)}return ae}if(He||El(k),t.removed=[],typeof ae=="string"&&(gn=!1),gn){if(ae.nodeName){var pt=Qn(ae.nodeName);if(!le[pt]||I[pt])throw nf("root node is forbidden and cannot be sanitized in-place")}}else if(ae instanceof a)H=be("<!---->"),se=H.ownerDocument.importNode(ae,!0),se.nodeType===1&&se.nodeName==="BODY"||se.nodeName==="HTML"?H=se:H.appendChild(se);else{if(!de&&!ye&&!ve&&ae.indexOf("<")===-1)return x&&ct?x.createHTML(ae):ae;if(H=be(ae),!H)return de?null:ct?_:""}H&&xe&&R(H.firstChild);for(var wl=he(gn?ae:H);$e=wl.nextNode();)$e.nodeType===3&&$e===Mt||v0($e)||($e.content instanceof o&&O8($e.content),w0($e),Mt=$e);if(Mt=null,gn)return ae;if(de){if(Ne)for(wt=$.call(H.ownerDocument);H.firstChild;)wt.appendChild(H.firstChild);else wt=H;return U.shadowroot&&(wt=Q.call(n,wt,!0)),wt}var ht=ve?H.outerHTML:H.innerHTML;return ve&&le["!doctype"]&&H.ownerDocument&&H.ownerDocument.doctype&&H.ownerDocument.doctype.name&&Pt(zB,H.ownerDocument.doctype.name)&&(ht="<!DOCTYPE "+H.ownerDocument.doctype.name+`>
`+ht),ye&&(ht=Cs(ht,pe," "),ht=Cs(ht,Ce," ")),x&&ct?x.createHTML(ht):ht},t.setConfig=function(ae){El(ae),He=!0},t.clearConfig=function(){Zn=null,He=!1},t.isValidAttribute=function(ae,k,H){Zn||El({});var se=Qn(ae),$e=Qn(k);return E0(se,$e,H)},t.addHook=function(ae,k){typeof k=="function"&&(z[ae]=z[ae]||[],ea(z[ae],k))},t.removeHook=function(ae){if(z[ae])return _B(z[ae])},t.removeHooks=function(ae){z[ae]&&(z[ae]=[])},t.removeAllHooks=function(){z={}},t}var WB=VC();const WC=D.explode,jC=()=>{const e={};return{addFilter:(o,r)=>{B(WC(o),a=>{fe(e,a)||(e[a]={name:a,callbacks:[]}),e[a].callbacks.push(r)})},getFilters:()=>$l(e),removeFilter:(o,r)=>{B(WC(o),a=>{if(fe(e,a))if(oe(r)){const i=e[a],l=re(i.callbacks,c=>c!==r);l.length>0?i.callbacks=l:delete e[a]}else delete e[a]})}}},jB=(e,t)=>{B(t,n=>{e.attr(n,null)})},qB=(e,t,n)=>{e.addNodeFilter("font",s=>{B(s,o=>{const r=t.parse(o.attr("style")),a=o.attr("color"),i=o.attr("face"),l=o.attr("size");a&&(r.color=a),i&&(r["font-family"]=i),l&&(r["font-size"]=n[parseInt(o.attr("size"),10)-1]),o.name="span",o.attr("style",t.serialize(r)),jB(o,["color","face","size"])})})},KB=(e,t,n)=>{e.addNodeFilter("strike",s=>{const o=t.type!=="html4";B(s,r=>{if(o)r.name="s";else{const a=n.parse(r.attr("style"));a["text-decoration"]="line-through",r.name="span",r.attr("style",n.serialize(a))}})})},GB=(e,t,n)=>{const s=fc();t.convert_fonts_to_spans&&qB(e,s,D.explode(t.font_size_legacy_values)),KB(e,n,s)},YB=(e,t,n)=>{t.inline_styles&&GB(e,t,n)},XB=e=>fetch(e).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject(`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`)),QB=e=>{const t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},lf=e=>{const[t,...n]=e.split(","),s=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(o){const r=o[2]===";base64",a=r?QB(s):decodeURIComponent(s);return d.some({type:o[1],data:a,base64Encoded:r})}else return d.none()},qC=(e,t,n=!0)=>{let s=t;if(n)try{s=atob(t)}catch{return d.none()}const o=new Uint8Array(s.length);for(let r=0;r<o.length;r++)o[r]=s.charCodeAt(r);return d.some(new Blob([o],{type:e}))},ZB=e=>new Promise((t,n)=>{lf(e).bind(({type:s,data:o,base64Encoded:r})=>qC(s,o,r)).fold(()=>n("Invalid data URI"),t)}),JB=e=>st(e,"blob:")?XB(e):st(e,"data:")?ZB(e):Promise.reject("Unknown URI format"),KC=e=>new Promise((t,n)=>{const s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=()=>{n(s.error.message)},s.readAsDataURL(e)});let eO=0;const tO=e=>(e||"blobid")+eO++,GC=(e,t,n)=>lf(e).bind(({data:s,type:o,base64Encoded:r})=>{if(t&&!r)return d.none();{const a=r?s:btoa(s);return n(a,o)}}),YC=(e,t,n)=>{const s=e.create(tO(),t,n);return e.add(s),s},XC=(e,t,n=!1)=>GC(t,n,(s,o)=>d.from(e.getByData(s,o)).orThunk(()=>qC(o,s).map(r=>YC(e,r,s)))),nO=(e,t)=>{const n=()=>Promise.reject("Invalid data URI");if(st(t,"blob:")){const s=e.getByUri(t);return oe(s)?Promise.resolve(s):JB(t).then(o=>KC(o).then(r=>GC(r,!1,a=>d.some(YC(e,o,a))).getOrThunk(n)))}else return st(t,"data:")?XC(e,t).fold(n,s=>Promise.resolve(s)):Promise.reject("Unknown image data format")},sO=e=>oe(e.attr("data-mce-bogus")),oO=e=>e.attr("src")===Se.transparentSrc||oe(e.attr("data-mce-placeholder")),rO=(e,t)=>{const{blob_cache:n}=t,s=o=>{const r=o.attr("src");oO(o)||sO(o)||XC(n,r,!0).each(a=>{o.attr("src",a.blobUri())})};n&&e.addAttributeFilter("src",o=>B(o,s))},aO=(e,t)=>{const n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(s,o,r)=>{const a=D.extend({},n.getBlockElements()),i=n.getNonEmptyElements(),l=n.getWhitespaceElements();a.body=1;for(let c=0,u=s.length;c<u;c++){let f=s[c],m=f.parent;if(a[f.parent.name]&&f===m.lastChild){let g=f.prev;for(;g;){const h=g.name;if(h!=="span"||g.attr("data-mce-type")!=="bookmark"){h==="br"&&(f=null);break}g=g.prev}if(f&&(f.remove(),Zr(n,i,l,m))){const h=n.getElementRule(m.name);h&&(h.removeEmpty?m.remove():h.paddEmpty&&Ou(t,r,a,m))}}else{let g=f;for(;m&&m.firstChild===g&&m.lastChild===g&&(g=m,!a[m.name]);)m=m.parent;if(g===m){const h=new vt("#text",3);h.value=it,f.replace(h)}}}}),e.addAttributeFilter("href",s=>{let o=s.length;const r=i=>i.split(" ").filter(c=>c.length>0).concat(["noopener"]).sort().join(" "),a=i=>{const l=i?D.trim(i):"";return/\b(noopener)\b/g.test(l)?l:r(l)};if(!t.allow_unsafe_link_target)for(;o--;){const i=s[o];i.name==="a"&&i.attr("target")==="_blank"&&i.attr("rel",a(i.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",s=>{let o=s.length,r,a,i,l;for(;o--;)if(l=s[o],l.name==="a"&&l.firstChild&&!l.attr("href")){i=l.parent,r=l.lastChild;do a=r.prev,i.insert(r,l),r=a;while(r)}}),t.fix_list_elements&&e.addNodeFilter("ul,ol",s=>{let o=s.length,r,a;for(;o--;)if(r=s[o],a=r.parent,a.name==="ul"||a.name==="ol")if(r.prev&&r.prev.name==="li")r.prev.append(r);else{const i=new vt("li",1);i.attr("style","list-style-type: none"),r.wrap(i)}}),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",s=>{const o=n.getValidClasses();let r=s.length;for(;r--;){const a=s[r],i=a.attr("class").split(" ");let l="";for(let c=0;c<i.length;c++){const u=i[c];let f=!1,m=o["*"];m&&m[u]&&(f=!0),m=o[a.name],!f&&m&&m[u]&&(f=!0),f&&(l&&(l+=" "),l+=u)}l.length||(l=null),a.attr("class",l)}}),rO(e,t)},QC=D.each,iO=D.trim,lO="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),cO={ftp:21,http:80,https:443,mailto:25},uO=["img","video"],fO=(e,t)=>oe(e)?!e:oe(t)?!De(uO,t):!0,dO=e=>{try{return decodeURIComponent(e)}catch{return unescape(e)}},ZC=(e,t,n)=>{const s=dO(t);return e.allow_script_urls?!1:/((java|vb)script|mhtml):/i.test(s)?!0:e.allow_html_data_urls?!1:/^data:image\//i.test(s)?fO(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(s):/^data:/i.test(s)};class un{constructor(t,n){t=iO(t),this.settings=n||{};const s=this.settings.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){o.source=t;return}const r=t.indexOf("//")===0;if(t.indexOf("/")===0&&!r&&(t=(s&&s.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){const i=this.settings.base_uri?this.settings.base_uri.path:new un(document.location.href).directory;if(this.settings.base_uri&&this.settings.base_uri.protocol=="")t="//mce_host"+o.toAbsPath(i,t);else{const l=/([^#?]*)([#?]?.*)/.exec(t);t=(s&&s.protocol||"http")+"://mce_host"+o.toAbsPath(i,l[1])+l[2]}}t=t.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);QC(lO,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),o[i]=c}),s&&(o.protocol||(o.protocol=s.protocol),o.userInfo||(o.userInfo=s.userInfo),!o.port&&o.host==="mce_host"&&(o.port=s.port),(!o.host||o.host==="mce_host")&&(o.host=s.host),o.source=""),r&&(o.protocol="")}static parseDataUri(t){let n;const s=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(s[0]);return o&&(n=o[1]),{type:n,data:s[1]}}static isDomSafe(t,n,s={}){if(s.allow_script_urls)return!0;{const o=as.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!ZC(s,o,n)}}static getDocumentBaseUrl(t){let n;return t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?n=t.href:n=t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/")),n}setPath(t){const n=/^(.*?)\/?(\w+)?$/.exec(t);this.path=n[0],this.directory=n[1],this.file=n[2],this.source="",this.getURI()}toRelative(t){let n;if(t==="./")return t;const s=new un(t,{base_uri:this});if(s.host!=="mce_host"&&this.host!==s.host&&s.host||this.port!==s.port||this.protocol!==s.protocol&&s.protocol!=="")return s.getURI();const o=this.getURI(),r=s.getURI();return o===r||o.charAt(o.length-1)==="/"&&o.substr(0,o.length-1)===r?o:(n=this.toRelPath(this.path,s.path),s.query&&(n+="?"+s.query),s.anchor&&(n+="#"+s.anchor),n)}toAbsolute(t,n){const s=new un(t,{base_uri:this});return s.getURI(n&&this.isSameOrigin(s))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;const n=cO[this.protocol];if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let s=0,o="",r,a;const i=t.substring(0,t.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(r=0,a=i.length;r<a;r++)if(r>=l.length||i[r]!==l[r]){s=r+1;break}}if(i.length<l.length){for(r=0,a=l.length;r<a;r++)if(r>=i.length||i[r]!==l[r]){s=r+1;break}}if(s===1)return n;for(r=0,a=i.length-(s-1);r<a;r++)o+="../";for(r=s-1,a=l.length;r<a;r++)r!==s-1?o+="/"+l[r]:o+=l[r];return o}toAbsPath(t,n){let s,o=0,r=[],a;const i=/\/$/.test(n)?"/":"";let l=t.split("/");const c=n.split("/");for(QC(l,u=>{u&&r.push(u)}),l=r,s=c.length-1,r=[];s>=0;s--)if(!(c[s].length===0||c[s]===".")){if(c[s]===".."){o++;continue}if(o>0){o--;continue}r.push(c[s])}return s=l.length-o,s<=0?a=rr(r).join("/"):a=l.slice(0,s).join("/")+"/"+rr(r).join("/"),a.indexOf("/")!==0&&(a="/"+a),i&&a.lastIndexOf("/")!==a.length-1&&(a+=i),a}getURI(t=!1){let n;return(!this.source||t)&&(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const JC=D.makeMap,ey=D.extend,mO={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]},gO=D.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),cf="data-mce-type",pO=(e,t)=>{const n={...mO};return n.PARSER_MEDIA_TYPE=t,e.allow_script_urls?n.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(n.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),n},hO=(e,t)=>{const n=WB(),s=e.validate;let o=0;return n.addHook("uponSanitizeElement",(r,a)=>{var i,l;r.nodeType===Sm&&!e.allow_conditional_comments&&/^\[if/i.test(r.nodeValue)&&(r.nodeValue=" "+r.nodeValue);const c=a.tagName;if(r.nodeType!==fr||c==="body")return;const u=C.fromDom(r),f=dr(u,cf),m=zt(u,"data-mce-bogus");if(!f&&ne(m)){m==="all"?Fe(u):Ts(u);return}const g=t.getElementRule(c.toLowerCase());if(s&&!g){Ts(u);return}else a.allowedTags[c]=!0;if(s&&!f){if(B((i=g.attributesForced)!==null&&i!==void 0?i:[],h=>{ot(u,h.name,h.value==="{$uid}"?`mce_${o++}`:h.value)}),B((l=g.attributesDefault)!==null&&l!==void 0?l:[],h=>{dr(u,h.name)||ot(u,h.name,h.value==="{$uid}"?`mce_${o++}`:h.value)}),g.attributesRequired&&!Me(g.attributesRequired,h=>dr(u,h))){Ts(u);return}if(g.removeEmptyAttrs&&Ew(u)){Ts(u);return}g.outputName&&g.outputName!==c.toLowerCase()&&Fx(u,g.outputName)}}),n.addHook("uponSanitizeAttribute",(r,a)=>{const i=r.tagName.toLowerCase(),{attrName:l,attrValue:c}=a;a.keepAttr=!s||t.isValid(i,l)||st(l,"data-")||st(l,"aria-"),l in gO&&ZC(e,c,i)&&(a.keepAttr=!1),a.keepAttr?(a.allowedAttributes[l]=!0,l in t.getBoolAttrs()&&(a.attrValue=l),e.allow_svg_data_urls&&st(c,"data:image/svg+xml")&&(a.forceKeepAttr=!0)):r.hasAttribute(cf)&&(l==="id"||l==="class"||l==="style")&&(a.forceKeepAttr=!0)}),n},ty=(e,t,n)=>{const s=e.name,o=s in n&&s!=="title"&&s!=="textarea",r=t.childNodes;for(let a=0,i=r.length;a<i;a++){const l=r[a],c=new vt(l.nodeName.toLowerCase(),l.nodeType);if(Z(l)){const u=l.attributes;for(let f=0,m=u.length;f<m;f++){const g=u[f];c.attr(g.name,g.value)}}else M(l)?(c.value=l.data,o&&(c.raw=!0)):(Ql(l)||ok(l)||rk(l))&&(c.value=l.data);ty(c,l,n),e.append(c)}},bO=(e,t,n)=>{const s=[];for(let o=e,r=o;oe(o);r=o,o=o.walk())B(t,a=>a(o)),xt(o.parent)&&o!==e?o=r:s.push(o);for(let o=s.length-1;o>=0;o--){const r=s[o];B(n,a=>a(r))}},CO=(e,t,n,s)=>{const o=n.validate,r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=ey(JC("script,style,head,html,body,title,meta,param"),t.getBlockElements()),l=_g(t),c=/[ \t\r\n]+/g,u=/^[ \t\r\n]+/,f=/[ \t\r\n]+$/,m=y=>{for(y=y.parent;oe(y);){if(y.name in a)return!0;y=y.parent}return!1},g=y=>{let E=y;for(;oe(E);){if(E.name in l)return Zr(t,r,a,E);E=E.parent}return!1},h=(y,E)=>{const S=E?y.prev:y.next;return oe(S)?!1:y.parent.name in i&&(y.parent!==e||s.isRootContent)};return[y=>{if(y.type===3&&!m(y)){let E=y.value;E=E.replace(c," "),(WP(y.prev,i)||h(y,!0))&&(E=E.replace(u,"")),E.length===0?y.remove():y.value=E}},y=>{var E;if(y.type===1){const S=t.getElementRule(y.name);if(o&&S){const x=Zr(t,r,a,y);S.paddInEmptyBlock&&x&&g(y)?Ou(n,s,i,y):S.removeEmpty&&x?i[y.name]?y.remove():y.unwrap():S.paddEmpty&&(x||HP(y))&&Ou(n,s,i,y)}}else if(y.type===3&&!m(y)){let S=y.value;(i[(E=y.next)===null||E===void 0?void 0:E.name]||h(y,!1))&&(S=S.replace(f,"")),S.length===0?y.remove():y.value=S}}]},yO=(e,t)=>{var n;const s=(n=t.forced_root_block)!==null&&n!==void 0?n:e.forced_root_block;return s===!1?"":s===!0?"p":s},Ho=(e={},t=ls())=>{const n=jC(),s=jC(),o={validate:!0,root_name:"body",...e},r=new DOMParser,a=hO(o,t),i=(E,S,x="html")=>{const _=x==="xhtml"?"application/xhtml+xml":"text/html",j=fe(t.getSpecialElements(),S.toLowerCase()),A=j?`<${S}>${E}</${S}>`:E,T=x==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${A}</body></html>`:`<body>${A}</body>`,$=r.parseFromString(T,_).body;return a.sanitize($,pO(o,_)),a.removed=[],j?$.firstChild:$},l=n.addFilter,c=n.getFilters,u=n.removeFilter,f=s.addFilter,m=s.getFilters,g=s.removeFilter,h=(E,S)=>{const x=E.parent;x&&t.children[E.name]&&!t.isValidChild(x.name,E.name)&&S.push(E)},p=(E,S)=>{const x=ey(JC("script,style,head,html,body,title,meta,param"),t.getBlockElements()),_=/^[ \t\r\n]+/,j=/[ \t\r\n]+$/;let A=E.firstChild,T=null;const $=L=>{L&&(A=L.firstChild,A&&A.type===3&&(A.value=A.value.replace(_,"")),A=L.lastChild,A&&A.type===3&&(A.value=A.value.replace(j,"")))};if(!!t.isValidChild(E.name,S.toLowerCase())){for(;A;){const L=A.next;A.type===3||A.type===1&&A.name!=="p"&&!x[A.name]&&!A.attr(cf)?(T||(T=new vt(S,1),T.attr(o.forced_root_block_attrs),E.insert(T,A)),T.append(A)):($(T),T=null),A=L}$(T)}},y={schema:t,addAttributeFilter:f,getAttributeFilters:m,removeAttributeFilter:g,addNodeFilter:l,getNodeFilters:c,removeNodeFilter:u,parse:(E,S={})=>{var x;const _=o.validate,j=(x=S.context)!==null&&x!==void 0?x:o.root_name,A=i(E,j,S.format),T=new vt(j,11);ty(T,A,t.getSpecialElements());const[$,L]=CO(T,t,o,S),Q=[],q=_?ke=>h(ke,Q):me,z={nodes:{},attributes:{}},pe=ke=>oC(c(),m(),ke,z);if(bO(T,[$,pe],[L,q]),Q.reverse(),_&&Q.length>0)if(S.context){const{pass:ke,fail:ze}=sr(Q,O=>O.parent===T);Lu(ze,t,pe),S.invalid=ke.length>0}else Lu(Q,t,pe);const Ce=yO(o,S);return Ce&&(T.name==="body"||S.isRootContent)&&p(T,Ce),S.invalid||rC(z,S),T}};return aO(y,o),YB(y,o,t),y},vO=e=>Ei(e)?ms({validate:!1}).serialize(e):e,ny=(e,t)=>{const n=vO(e),s=t(n);if(s.isDefaultPrevented())return s;if(Ei(e))if(s.content!==n){const o=Ho({validate:!1,forced_root_block:!1}).parse(s.content,{context:e.name});return{...s,content:o}}else return{...s,content:e};else return s},sy=(e,t)=>{if(t.no_events)return Ct.value(t);{const n=aR(e,t);return n.isDefaultPrevented()?Ct.error(Bh(e,{content:"",...n}).content):Ct.value(n)}},oy=(e,t,n)=>n.no_events?t:ny(t,o=>Bh(e,{...n,content:o})).content,uf=(e,t)=>{if(t.no_events)return Ct.value(t);{const n=ny(t.content,s=>rR(e,{...t,content:s}));return n.isDefaultPrevented()?(Dh(e,n),Ct.error(void 0)):Ct.value(n)}},ff=(e,t,n)=>{n.no_events||Dh(e,{...n,content:t})},df=(e,t,n)=>({element:e,width:t,rows:n}),ry=(e,t)=>({element:e,cells:t}),EO=(e,t)=>({x:e,y:t}),ay=(e,t)=>{const n=parseInt(zt(e,t),10);return isNaN(n)?1:n},SO=(e,t,n,s,o)=>{const r=ay(o,"rowspan"),a=ay(o,"colspan"),i=e.rows;for(let l=n;l<n+r;l++){i[l]||(i[l]=ry(zg(s),[]));for(let c=t;c<t+a;c++){const u=i[l].cells;u[c]=l===n&&c===t?o:Ao(o)}}},wO=(e,t,n)=>{const s=e.rows;return!!(s[n]?s[n].cells:[])[t]},kO=(e,t,n)=>{for(;wO(e,t,n);)t++;return t},iy=e=>$t(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),ly=(e,t)=>{const n=e.rows;for(let s=0;s<n.length;s++){const o=n[s].cells;for(let r=0;r<o.length;r++)if(Ae(o[r],t))return d.some(EO(r,s))}return d.none()},cy=(e,t,n,s,o)=>{const r=[],a=e.rows;for(let i=n;i<=o;i++){const l=a[i].cells,c=t<s?l.slice(t,s+1):l.slice(s,t+1);r.push(ry(a[i].element,c))}return r},xO=(e,t,n)=>{const s=t.x,o=t.y,r=n.x,a=n.y,i=o<a?cy(e,s,o,r,a):cy(e,s,a,r,o);return df(e.element,iy(i),i)},NO=(e,t)=>{const n=Ao(e.element),s=C.fromTag("tbody");return Rs(s,t),qe(n,s),n},_O=e=>Ee(e.rows,t=>{const n=Ee(t.cells,o=>{const r=zg(o);return rt(r,"colspan"),rt(r,"rowspan"),r}),s=Ao(t.element);return Rs(s,n),s}),AO=e=>{const t=df(Ao(e),0,[]);return B(At(e,"tr"),(n,s)=>{B(At(n,"td,th"),(o,r)=>{SO(t,kO(t,r,s),s,n,o)})}),df(t.element,iy(t.rows),t.rows)},RO=e=>NO(e,_O(e)),TO=(e,t,n)=>ly(e,t).bind(s=>ly(e,n).map(o=>xO(e,s,o))),PO=e=>Ye(e,t=>Be(t)==="ul"||Be(t)==="ol"),DO=(e,t)=>Ye(e,n=>Be(n)==="li"&&qc(n,t)).fold(F([]),n=>PO(e).map(s=>{const o=C.fromTag(Be(s)),r=lr(Gm(s),(a,i)=>st(i,"list-style"));return ka(o,r),[C.fromTag("li"),o]}).getOr([])),BO=(e,t)=>{const n=$t(t,(s,o)=>(qe(o,s),o),e);return t.length>0?tu([n]):n},OO=e=>Sr(e)?Zt(e).filter(tc).fold(F([]),t=>[e,t]):tc(e)?[e]:[],$O=(e,t)=>{const n=C.fromDom(t.commonAncestorContainer),s=Kn(n,e),o=re(s,xk),r=DO(s,t),a=o.concat(r.length?r:OO(n));return Ee(a,Ao)},uy=()=>tu([]),LO=(e,t)=>BO(C.fromDom(t.cloneContents()),$O(e,t)),IO=(e,t)=>vr(t,"table",V(Ae,e)),FO=(e,t)=>IO(e,t[0]).bind(n=>{const s=t[0],o=t[t.length-1],r=AO(n);return TO(r,s,o).map(a=>tu([RO(a)]))}).getOrThunk(uy),MO=(e,t)=>t.length>0&&t[0].collapsed?uy():LO(e,t[0]),UO=(e,t)=>{const n=Sh(t,e);return n.length>0?FO(e,n):MO(e,t)},Pi=(e,t)=>t>=0&&t<e.length&&zr(e.charAt(t)),fy=e=>rs(e.innerText),zO=e=>e.map(t=>t.nodeName).getOr("div").toLowerCase(),HO=e=>d.from(e.selection.getRng()).map(t=>{const n=d.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),s=e.getBody(),o=zO(n),r=e.dom.add(s,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),a=fy(r),i=rs(r.textContent);if(e.dom.remove(r),Pi(i,0)||Pi(i,i.length-1)){const l=n.getOr(s),c=fy(l),u=c.indexOf(a);if(u===-1)return a;{const f=Pi(c,u-1),m=Pi(c,u+a.length);return(f?" ":"")+a+(m?" ":"")}}else return a}).getOr(""),VO=(e,t)=>{const n=e.selection.getRng(),s=e.dom.create("body"),o=e.selection.getSel(),r=mu(e,Wc(o)),a=t.contextual?UO(C.fromDom(e.getBody()),r).dom:n.cloneContents();return a&&s.appendChild(a),e.selection.serializer.serialize(s,t)},WO=(e,t)=>{if(t.format==="text")return HO(e);{const n=VO(e,t);return t.format==="tree"?n:e.selection.isCollapsed()?"":n}},jO=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),qO=(e,t,n={})=>{const s=jO(n,t);return sy(e,s).fold(bt,o=>{const r=WO(e,o);return oy(e,r,o)})},mf=0,dy=1,my=2,KO=(e,t)=>{const n=e.length+t.length+2,s=new Array(n),o=new Array(n),r=(u,f,m)=>({start:u,end:f,diag:m}),a=(u,f,m,g,h)=>{const p=l(u,f,m,g);if(p===null||p.start===f&&p.diag===f-g||p.end===u&&p.diag===u-m){let b=u,y=m;for(;b<f||y<g;)b<f&&y<g&&e[b]===t[y]?(h.push([mf,e[b]]),++b,++y):f-u>g-m?(h.push([my,e[b]]),++b):(h.push([dy,t[y]]),++y)}else{a(u,p.start,m,p.start-p.diag,h);for(let b=p.start;b<p.end;++b)h.push([mf,e[b]]);a(p.end,f,p.end-p.diag,g,h)}},i=(u,f,m,g)=>{let h=u;for(;h-f<g&&h<m&&e[h]===t[h-f];)++h;return r(u,h,f)},l=(u,f,m,g)=>{const h=f-u,p=g-m;if(h===0||p===0)return null;const b=h-p,y=p+h,E=(y%2===0?y:y+1)/2;s[1+E]=u,o[1+E]=f+1;let S,x,_,j,A;for(S=0;S<=E;++S){for(x=-S;x<=S;x+=2){for(_=x+E,x===-S||x!==S&&s[_-1]<s[_+1]?s[_]=s[_+1]:s[_]=s[_-1]+1,j=s[_],A=j-u+m-x;j<f&&A<g&&e[j]===t[A];)s[_]=++j,++A;if(b%2!==0&&b-S<=x&&x<=b+S&&o[_-b]<=s[_])return i(o[_-b],x+u-m,f,g)}for(x=b-S;x<=b+S;x+=2){for(_=x+E-b,x===b-S||x!==b+S&&o[_+1]<=o[_-1]?o[_]=o[_+1]-1:o[_]=o[_-1],j=o[_]-1,A=j-u+m-x;j>=u&&A>=m&&e[j]===t[A];)o[_]=j--,A--;if(b%2===0&&-S<=x&&x<=S&&o[_]<=s[_+b])return i(o[_],x+u-m,f,g)}}},c=[];return a(0,e.length,0,t.length,c),c},gy=e=>Z(e)?e.outerHTML:M(e)?as.encodeRaw(e.data,!1):Ql(e)?"<!--"+e.data+"-->":"",GO=e=>{let t;const n=document.createElement("div"),s=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)s.appendChild(t);return s},YO=(e,t,n)=>{const s=GO(t);if(e.hasChildNodes()&&n<e.childNodes.length){const o=e.childNodes[n];o.parentNode.insertBefore(s,o)}else e.appendChild(s)},XO=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){const n=e.childNodes[t];n.parentNode.removeChild(n)}},QO=(e,t)=>{let n=0;B(e,s=>{s[0]===mf?n++:s[0]===dy?(YO(t,s[1],n),n++):s[0]===my&&XO(t,n)})},ZO=e=>re(Ee(Nt(e.childNodes),gy),t=>t.length>0),JO=(e,t)=>{const n=Ee(Nt(t.childNodes),gy);return QO(KO(n,e),t),t},e$=ks(()=>document.implementation.createHTMLDocument("undo")),t$=e=>e.indexOf("</iframe>")!==-1,n$=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),s$=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),Di=e=>{const t=ZO(e.getBody()),n=Un(t,o=>{const r=hb(e.serializer,o);return r.length>0?[r]:[]}),s=n.join("");return t$(s)?n$(n):s$(s)},gf=(e,t,n)=>{const s=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?JO(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:oe(s)&&sh(s)?!s.isFakeCaret:!0}),e.selection.moveToBookmark(s)},pf=e=>e.type==="fragmented"?e.fragments.join(""):e.content,py=e=>{const t=C.fromTag("body",e$());return Kl(t,pf(e)),B(At(t,"*[data-mce-bogus]"),Ts),Qm(t)},o$=(e,t)=>pf(e)===pf(t),r$=(e,t)=>py(e)===py(t),hf=(e,t)=>!e||!t?!1:o$(e,t)?!0:r$(e,t),bf=e=>e.get()===0,Bi=(e,t,n)=>{bf(n)&&(e.typing=t)},hy=(e,t)=>{e.typing&&(Bi(e,!1,t),e.add())},a$=e=>{e.typing&&(e.typing=!1,e.add())},i$=(e,t,n)=>{bf(t)&&n.set(dp(e.selection))},l$=(e,t,n,s,o,r,a)=>{const i=Di(e);if(r=r||{},r=D.extend(r,i),bf(s)===!1||e.removed)return null;const l=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:r,lastLevel:l,originalEvent:a}).isDefaultPrevented()||l&&hf(l,r))return null;t.data[n.get()]&&o.get().each(f=>{t.data[n.get()].beforeBookmark=f});const c=i_(e);if(c&&t.data.length>c){for(let f=0;f<t.data.length-1;f++)t.data[f]=t.data[f+1];t.data.length--,n.set(t.data.length)}r.bookmark=dp(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(r),n.set(t.data.length-1);const u={level:r,lastLevel:l,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",u),e.dispatch("change",u)):e.dispatch("AddUndo",u),r},c$=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},u$=(e,t,n,s,o)=>{if(t.transact(s)){const r=t.data[n.get()].bookmark,a=t.data[n.get()-1];gf(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=r)}},f$=(e,t,n)=>{let s;return t.get()<n.length-1&&(t.set(t.get()+1),s=n[t.get()],gf(e,s,!1),e.setDirty(!0),e.dispatch("Redo",{level:s})),s},d$=(e,t,n,s)=>{let o;return t.typing&&(t.add(),t.typing=!1,Bi(t,!1,n)),s.get()>0&&(s.set(s.get()-1),o=t.data[s.get()],gf(e,o,!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},m$=e=>{e.clear(),e.add()},g$=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!hf(Di(e),t.data[0]),p$=(e,t)=>t.get()<e.data.length-1&&!e.typing,h$=(e,t,n)=>(hy(e,t),e.beforeChange(),e.ignore(n),e.add()),b$=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},C$=(e,t)=>{const n=e.dom,s=oe(t)?t:e.getBody();kt(e.hasVisual)&&(e.hasVisual=d_(e)),B(n.select("table,a",s),o=>{switch(o.nodeName){case"TABLE":const r=m_(e),a=n.getAttrib(o,"border");(!a||a==="0")&&e.hasVisual?n.addClass(o,r):n.removeClass(o,r);break;case"A":if(!n.getAttrib(o,"href")){const i=n.getAttrib(o,"name")||o.id,l=Rp(e);i&&e.hasVisual?n.addClass(o,l):n.removeClass(o,l)}break}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},by=e=>({init:{bindEvents:me},undoManager:{beforeChange:(t,n)=>i$(e,t,n),add:(t,n,s,o,r,a)=>l$(e,t,n,s,o,r,a),undo:(t,n,s)=>d$(e,t,n,s),redo:(t,n)=>f$(e,t,n),clear:(t,n)=>c$(e,t,n),reset:t=>m$(t),hasUndo:(t,n)=>g$(e,t,n),hasRedo:(t,n)=>p$(t,n),transact:(t,n,s)=>h$(t,n,s),ignore:(t,n)=>b$(t,n),extra:(t,n,s,o)=>u$(e,t,n,s,o)},formatter:{match:(t,n,s,o)=>Wu(e,t,n,s,o),matchAll:(t,n)=>PD(e,t,n),matchNode:(t,n,s,o)=>On(e,t,n,s,o),canApply:t=>BD(e,t),closest:t=>DD(e,t),apply:(t,n,s)=>PC(e,t,n,s),remove:(t,n,s,o)=>RC(e,t,n,s,o),toggle:(t,n,s)=>pB(e,t,n,s),formatChanged:(t,n,s,o,r)=>gB(e,t,n,s,o,r)},editor:{getContent:t=>a1(e,t),setContent:(t,n)=>AD(e,t,n),insertContent:(t,n)=>kD(e,t,n),addVisual:t=>C$(e,t)},selection:{getContent:(t,n)=>qO(e,t,n)},autocompleter:{addDecoration:t=>YT(e,t),removeDecoration:()=>QT(e,C.fromDom(e.getBody()))},raw:{getModel:()=>d.none()}}),y$=e=>{const t=c=>Ot(c)?c:{},{init:n,undoManager:s,formatter:o,editor:r,selection:a,autocompleter:i,raw:l}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:s.beforeChange,add:s.add,undo:s.undo,redo:s.redo,clear:s.clear,reset:s.reset,hasUndo:s.hasUndo,hasRedo:s.hasRedo,transact:(c,u,f)=>s.transact(f),ignore:(c,u)=>s.ignore(u),extra:(c,u,f,m)=>s.extra(f,m)},formatter:{match:(c,u,f,m)=>o.match(c,t(u),m),matchAll:o.matchAll,matchNode:o.matchNode,canApply:c=>o.canApply(c),closest:c=>o.closest(c),apply:(c,u,f)=>o.apply(c,t(u)),remove:(c,u,f,m)=>o.remove(c,t(u)),toggle:(c,u,f)=>o.toggle(c,t(u)),formatChanged:(c,u,f,m,g)=>o.formatChanged(u,f,m,g)},editor:{getContent:c=>r.getContent(c),setContent:(c,u)=>({content:r.setContent(c,u),html:""}),insertContent:(c,u)=>(r.insertContent(c),""),addVisual:r.addVisual},selection:{getContent:(c,u)=>a.getContent(u)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>d.some(l.getRawModel())}}},v$=()=>{const e=F(null),t=F("");return{init:{bindEvents:me},undoManager:{beforeChange:me,add:e,undo:e,redo:e,clear:me,reset:me,hasUndo:Le,hasRedo:Le,transact:e,ignore:me,extra:me},formatter:{match:Le,matchAll:F([]),matchNode:F(void 0),canApply:Le,closest:t,apply:me,remove:me,toggle:me,formatChanged:F({unbind:me})},editor:{getContent:t,setContent:F({content:"",html:""}),insertContent:F(""),addVisual:me},selection:{getContent:t},autocompleter:{addDecoration:me,removeDecoration:me},raw:{getModel:F(d.none())}}},Gn=e=>fe(e.plugins,"rtc"),E$=e=>Te(e.plugins,"rtc").bind(t=>d.from(t.setup)),S$=e=>{const t=e;return E$(e).fold(()=>(t.rtcInstance=by(e),d.none()),n=>(t.rtcInstance=v$(),d.some(()=>n().then(s=>(t.rtcInstance=y$(s),s.rtc.isRemote)))))},Cf=e=>e.rtcInstance?e.rtcInstance:by(e),Ie=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},w$=(e,t,n)=>{Ie(e).undoManager.beforeChange(t,n)},k$=(e,t,n,s,o,r,a)=>Ie(e).undoManager.add(t,n,s,o,r,a),x$=(e,t,n,s)=>Ie(e).undoManager.undo(t,n,s),N$=(e,t,n)=>Ie(e).undoManager.redo(t,n),_$=(e,t,n)=>{Ie(e).undoManager.clear(t,n)},A$=(e,t)=>{Ie(e).undoManager.reset(t)},R$=(e,t,n)=>Ie(e).undoManager.hasUndo(t,n),T$=(e,t,n)=>Ie(e).undoManager.hasRedo(t,n),P$=(e,t,n,s)=>Ie(e).undoManager.transact(t,n,s),D$=(e,t,n)=>{Ie(e).undoManager.ignore(t,n)},B$=(e,t,n,s,o)=>{Ie(e).undoManager.extra(t,n,s,o)},O$=(e,t,n,s,o)=>Ie(e).formatter.match(t,n,s,o),$$=(e,t,n)=>Ie(e).formatter.matchAll(t,n),L$=(e,t,n,s,o)=>Ie(e).formatter.matchNode(t,n,s,o),I$=(e,t)=>Ie(e).formatter.canApply(t),F$=(e,t)=>Ie(e).formatter.closest(t),M$=(e,t,n,s)=>{Ie(e).formatter.apply(t,n,s)},U$=(e,t,n,s,o)=>{Ie(e).formatter.remove(t,n,s,o)},z$=(e,t,n,s)=>{Ie(e).formatter.toggle(t,n,s)},H$=(e,t,n,s,o,r)=>Ie(e).formatter.formatChanged(t,n,s,o,r),V$=(e,t)=>Cf(e).editor.getContent(t),W$=(e,t,n)=>Cf(e).editor.setContent(t,n),j$=(e,t,n)=>Cf(e).editor.insertContent(t,n),q$=(e,t,n)=>Ie(e).selection.getContent(t,n),K$=(e,t)=>Ie(e).editor.addVisual(t),Cy=e=>Ie(e).init.bindEvents(),G$=(e,t)=>Ie(e).autocompleter.addDecoration(t),Y$=e=>Ie(e).autocompleter.removeDecoration(),X$=(e,t={})=>{const n=t.format?t.format:"html";return q$(e,n,t)},yy=e=>e.dom.length===0?(Fe(e),d.none()):d.some(e),Q$=(e,t)=>e.filter(n=>Wr.isBookmarkNode(n.dom)).bind(t?br:_s),Z$=(e,t,n,s)=>{const o=e.dom,r=t.dom,a=s?o.length:r.length;s?(wu(o,r,!1,!s),n.setStart(r,a)):(wu(r,o,!1,!s),n.setEnd(r,a))},J$=(e,t)=>{Zt(e).each(n=>{const s=e.dom;t&&pi(n,N(s,0))?bi(s,0):!t&&hi(n,N(s,s.length))&&Su(s,s.length)})},vy=(e,t,n,s)=>{e.bind(o=>((s?Su:bi)(o.dom,s?o.dom.length:0),t.filter(Ut).map(a=>Z$(o,a,n,s)))).orThunk(()=>Q$(t,s).or(t).filter(Ut).map(r=>J$(r,s)))},eL=(e,t)=>{const n=d.from(t.firstChild).map(C.fromDom),s=d.from(t.lastChild).map(C.fromDom);e.deleteContents(),e.insertNode(t);const o=n.bind(_s).filter(Ut).bind(yy),r=s.bind(br).filter(Ut).bind(yy);vy(o,n,e,!0),vy(r,s,e,!1),e.collapse(!1)},tL=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),nL=(e,t)=>{if(t.format!=="raw"){const n=e.selection.getRng(),s=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=s?{context:s.nodeName.toLowerCase()}:{},r=e.parser.parse(t.content,{forced_root_block:!1,...o,...t});return ms({validate:!1},e.schema).serialize(r)}else return t.content},sL=(e,t,n={})=>{const s=tL(n,t);uf(e,s).each(o=>{const r=nL(e,o),a=e.selection.getRng();eL(a,a.createContextualFragment(r)),e.selection.setRng(a),qr(e,a),ff(e,r,o)})},Ey=(e,t,n)=>{if(e&&fe(e,t)){const s=re(e[t],o=>o!==n);s.length===0?delete e[t]:e[t]=s}};var oL=(e,t)=>{let n,s;const o=(a,i)=>Ye(i,l=>e.is(l,a)),r=a=>e.getParents(a,null,e.getRoot());return{selectorChangedWithUnbind:(a,i)=>(n||(n={},s={},t.on("NodeChange",l=>{const c=l.element,u=r(c),f={};D.each(n,(m,g)=>{o(g,u).each(h=>{s[g]||(B(m,p=>{p(!0,{node:h,selector:g,parents:u})}),s[g]=m),f[g]=m})}),D.each(s,(m,g)=>{f[g]||(delete s[g],D.each(m,h=>{h(!1,{node:c,selector:g,parents:u})}))})})),n[a]||(n[a]=[]),n[a].push(i),o(a,r(t.selection.getStart())).each(()=>{s[a]=n[a]}),{unbind:()=>{Ey(n,a,i),Ey(s,a,i)}})}};const Sy=e=>!!(e&&e.ownerDocument)&&Vn(C.fromDom(e.ownerDocument),C.fromDom(e)),rL=e=>e?Sy(e.startContainer)&&Sy(e.endContainer):!1,wy=(e,t,n,s)=>{let o,r;const{selectorChangedWithUnbind:a}=oL(e,s),i=(O,Y)=>{const ue=e.createRng();oe(O)&&oe(Y)?(ue.setStart(O,Y),ue.setEnd(O,Y),S(ue),b(!1)):(Kc(e,ue,s.getBody(),!0),S(ue))},l=O=>X$(s,O),c=(O,Y)=>sL(s,O,Y),u=O=>lb(s.getBody(),E(),O),f=O=>cb(s.getBody(),E(),O),m=(O,Y)=>ke.getBookmark(O,Y),g=O=>ke.moveToBookmark(O),h=(O,Y)=>(HT(e,O,Y).each(S),O),p=()=>{const O=E(),Y=y();return!O||O.item?!1:O.compareEndPoints?O.compareEndPoints("StartToEnd",O)===0:!Y||O.collapsed},b=O=>{const Y=E();Y.collapse(!!O),S(Y)},y=()=>t.getSelection?t.getSelection():t.document.selection,E=()=>{let O,Y,ue;const le=(U,J,K)=>{try{return J.compareBoundaryPoints(U,K)}catch{return-1}},We=t.document;if(s.bookmark!==void 0&&qs(s)===!1){const U=cu(s);if(U.isSome())return U.map(J=>mu(s,[J])[0]).getOr(We.createRange())}try{(O=y())&&!_a(O.anchorNode)&&(O.rangeCount>0?Y=O.getRangeAt(0):Y=O.createRange?O.createRange():We.createRange(),Y=mu(s,[Y])[0])}catch{}return Y||(Y=We.createRange()),Y.setStart&&Y.startContainer.nodeType===9&&Y.collapsed&&(ue=e.getRoot(),Y.setStart(ue,0),Y.setEnd(ue,0)),o&&r&&(le(Y.START_TO_START,Y,o)===0&&le(Y.END_TO_END,Y,o)===0?Y=r:(o=null,r=null)),Y},S=(O,Y)=>{let ue;if(!rL(O))return;const le=y();if(O=s.dispatch("SetSelectionRange",{range:O,forward:Y}).range,le){r=O;try{le.removeAllRanges(),le.addRange(O)}catch{}Y===!1&&le.extend&&(le.collapse(O.endContainer,O.endOffset),le.extend(O.startContainer,O.startOffset)),o=le.rangeCount>0?le.getRangeAt(0):null}!O.collapsed&&O.startContainer===O.endContainer&&le.setBaseAndExtent&&O.endOffset-O.startOffset<2&&O.startContainer.hasChildNodes()&&(ue=O.startContainer.childNodes[O.startOffset],ue&&ue.tagName==="IMG"&&(le.setBaseAndExtent(O.startContainer,O.startOffset,O.endContainer,O.endOffset),(le.anchorNode!==O.startContainer||le.focusNode!==O.endContainer)&&le.setBaseAndExtent(ue,0,ue,1))),s.dispatch("AfterSetSelectionRange",{range:O,forward:Y})},x=O=>(c(e.getOuterHTML(O)),O),_=()=>UT(s.getBody(),E()),j=(O,Y)=>zT(e,E(),O,Y),A=()=>{const O=y(),Y=O==null?void 0:O.anchorNode,ue=O==null?void 0:O.focusNode;if(!O||!Y||!ue||_a(Y)||_a(ue))return!0;const le=e.createRng(),We=e.createRng();try{le.setStart(Y,O.anchorOffset),le.collapse(!0),We.setStart(ue,O.focusOffset),We.collapse(!0)}catch{return!0}return le.compareBoundaryPoints(le.START_TO_START,We)<=0},Ce={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:s,collapse:b,setCursorLocation:i,getContent:l,setContent:c,getBookmark:m,moveToBookmark:g,select:h,isCollapsed:p,isForward:A,setNode:x,getNode:_,getSel:y,setRng:S,getRng:E,getStart:u,getEnd:f,getSelectedBlocks:j,normalize:()=>{const O=E(),Y=y();if(!LA(Y)&&ri(s)){const ue=ci(e,O);return ue.each(le=>{S(le,A())}),ue.getOr(O)}return O},selectorChanged:(O,Y)=>(a(O,Y),Ce),selectorChangedWithUnbind:a,getScrollContainer:()=>{let O,Y=e.getRoot();for(;Y&&Y.nodeName!=="BODY";){if(Y.scrollHeight>Y.clientHeight){O=Y;break}Y=Y.parentNode}return O},scrollIntoView:(O,Y)=>{oe(O)?iT(s,O,Y):qr(s,E(),Y)},placeCaretAt:(O,Y)=>S(zh(O,Y,s.getDoc())),getBoundingClientRect:()=>{const O=E();return O.collapsed?N.fromRangeStart(O).getClientRects()[0]:O.getBoundingClientRect()},destroy:()=>{t=o=r=null,ze.destroy()}},ke=Wr(Ce),ze=Lh(Ce,s);return Ce.bookmarkManager=ke,Ce.controlSelection=ze,Ce},aL=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.attr("tabindex",a.attr("data-mce-tabindex")),a.attr(o,null)}}),e.addAttributeFilter("src,href,style",(s,o)=>{const r="data-mce-"+o,a=t.url_converter,i=t.url_converter_scope;let l=s.length;for(;l--;){const c=s[l];let u=c.attr(r);u!==void 0?(c.attr(o,u.length>0?u:null),c.attr(r,null)):(u=c.attr(o),o==="style"?u=n.serializeStyle(n.parseStyle(u),c.name):a&&(u=a.call(i,u,o,c.name)),c.attr(o,u.length>0?u:null))}}),e.addAttributeFilter("class",s=>{let o=s.length;for(;o--;){const r=s[o];let a=r.attr("class");a&&(a=r.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",a.length>0?a:null))}}),e.addAttributeFilter("data-mce-type",(s,o,r)=>{let a=s.length;for(;a--;){const i=s[a];i.attr("data-mce-type")==="bookmark"&&!r.cleanup&&(d.from(i.firstChild).exists(c=>!Da(c.value))?i.unwrap():i.remove())}}),e.addNodeFilter("noscript",s=>{let o=s.length;for(;o--;){const r=s[o].firstChild;r&&(r.value=as.decode(r.value))}}),e.addNodeFilter("script,style",(s,o)=>{const r=i=>i.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let a=s.length;for(;a--;){const i=s[a],l=i.firstChild?i.firstChild.value:"";if(o==="script"){const c=i.attr("type");c&&i.attr("type",c==="mce-no/type"?null:c.replace(/^mce\-/,"")),t.element_format==="xhtml"&&l.length>0&&(i.firstChild.value=`// <![CDATA[
`+r(l)+`
// ]]>`)}else t.element_format==="xhtml"&&l.length>0&&(i.firstChild.value=`<!--
`+r(l)+`
-->`)}}),e.addNodeFilter("#comment",s=>{let o=s.length;for(;o--;){const r=s[o];t.preserve_cdata&&r.value.indexOf("[CDATA[")===0?(r.name="#cdata",r.type=4,r.value=n.decode(r.value.replace(/^\[CDATA\[|\]\]$/g,""))):r.value.indexOf("mce:protected ")===0&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(r.value).substr(14))}}),e.addNodeFilter("xml:namespace,input",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.type===7?a.remove():a.type===1&&o==="input"&&!a.attr("type")&&a.attr("type","text")}}),e.addAttributeFilter("data-mce-type",s=>{B(s,o=>{o.attr("data-mce-type")==="format-caret"&&(o.isEmpty(e.schema.getNonEmptyElements())?o.remove():o.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)})},iL=e=>{const t=s=>s&&s.name==="br",n=e.lastChild;if(t(n)){const s=n.prev;t(s)&&(n.remove(),s.remove())}},lL=(e,t,n)=>{let s;const o=e.dom;let r=t.cloneNode(!0);const a=document.implementation;if(a.createHTMLDocument){const i=a.createHTMLDocument("");D.each(r.nodeName==="BODY"?r.childNodes:[r],l=>{i.body.appendChild(i.importNode(l,!0))}),r.nodeName!=="BODY"?r=i.body.firstChild:r=i.body,s=o.doc,o.doc=i}return GA(e,{...n,node:r}),s&&(o.doc=s),r},cL=(e,t)=>e&&e.hasEventListeners("PreProcess")&&!t.no_events,uL=(e,t,n)=>cL(e,n)?lL(e,t,n):t,fL=(e,t,n)=>{D.inArray(t,n)===-1&&(e.addAttributeFilter(n,(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.push(n))},dL=(e,t,n)=>!t.no_events&&e?YA(e,{...t,content:n}).content:n,mL=(e,t,n)=>{const s=rs(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Pa(C.fromDom(t))?s:D.trim(s)},gL=(e,t,n)=>{const s=n.selection?{forced_root_block:!1,...n}:n,o=e.parse(t,s);return iL(o),o},pL=(e,t,n)=>ms(e,t).serialize(n),hL=(e,t,n,s,o)=>{const r=pL(t,n,s);return dL(e,o,r)},bL=(e,t)=>{const n=["data-mce-selected"],s=t&&t.dom?t.dom:Re.DOM,o=t&&t.schema?t.schema:ls(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs="remove_trailing_brs"in e?e.remove_trailing_brs:!0;const r=Ho(e,o);aL(r,e,s);const a=(i,l={})=>{const c={format:"html",...l},u=uL(t,i,c),f=mL(s,u,c),m=gL(r,f,c);return c.format==="tree"?m:hL(t,e,o,m,c)};return{schema:o,addNodeFilter:r.addNodeFilter,addAttributeFilter:r.addAttributeFilter,serialize:a,addRules:o.addValidElements,setRules:o.setValidElements,addTempAttr:V(fL,r,n),getTempAttrs:F(n),getNodeFilters:r.getNodeFilters,getAttributeFilters:r.getAttributeFilters,removeNodeFilter:r.removeNodeFilter,removeAttributeFilter:r.removeAttributeFilter}},ky=(e,t)=>{const n=bL(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},CL="html",yL=(e,t)=>({...e,format:t,get:!0,getInner:!0}),vL=(e,t={})=>{const n=t.format?t.format:CL,s=yL(t,n);return sy(e,s).fold(bt,o=>{const r=V$(e,o);return oy(e,r,o)})},EL="html",SL=(e,t)=>({format:EL,...e,set:!0,content:t}),yf=(e,t,n={})=>{const s=SL(n,t);return uf(e,s).map(o=>{const r=W$(e,o.content,o);return ff(e,r.html,o),r.content}).getOr(t)},wL="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),kL="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),xL=e=>{const t=re(wL,s=>fe(e,s)),n=e.forced_root_block;return(n===!1||n==="")&&t.push("forced_root_block (false only)"),ar(t)},NL=e=>{const t=D.makeMap(e.plugins," "),s=re(kL,o=>fe(t,o));return ar(s)},_L=(e,t)=>{const n=xL(e),s=NL(t),o=s.length>0,r=n.length>0,a=t.theme==="mobile";if(o||r||a){const i=`
- `,l=a?`

Themes:${i}mobile`:"",c=o?`

Plugins:${i}${s.join(i)}`:"",u=r?`

Options:${i}${n.join(i)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+l+c+u)}},AL=(e,t)=>{_L(e,t)},Oi=Re.DOM,RL=e=>{Oi.setStyle(e.id,"display",e.orgDisplay)},$i=e=>d.from(e).each(t=>t.destroy()),TL=e=>{e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)},PL=e=>{const t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),Oi.unbind(t,"submit reset",e.formEventDelegate))},DL=e=>{if(!e.removed){const{_selectionOverrides:t,editorUpload:n}=e,s=e.getBody(),o=e.getElement();s&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&o&&Oi.remove(o.nextSibling),XA(e),e.editorManager.remove(e),!e.inline&&s&&RL(e),QA(e),Oi.remove(e.getContainer()),$i(t),$i(n),e.destroy()}},BL=(e,t)=>{const{selection:n,dom:s}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),$i(n),$i(s)),PL(e),TL(e),e.destroyed=!0}},Li=(()=>{const e={};return{add:(o,r)=>{e[o]=r},get:o=>e[o]?e[o]:{icons:{}},has:o=>fe(e,o)}})(),Vo=dt.ModelManager,xy=(e,t)=>t.dom[e],Ny=(e,t)=>parseInt(kn(t,e),10),OL=V(xy,"clientWidth"),$L=V(xy,"clientHeight"),LL=V(Ny,"margin-top"),IL=V(Ny,"margin-left"),FL=e=>e.dom.getBoundingClientRect(),ML=(e,t,n)=>{const s=OL(e),o=$L(e);return t>=0&&n>=0&&t<=s&&n<=o},UL=(e,t,n,s)=>{const o=FL(t),r=e?o.left+t.dom.clientLeft+IL(t):0,a=e?o.top+t.dom.clientTop+LL(t):0,i=n-r,l=s-a;return{x:i,y:l}},zL=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.inline?s:Pw(s),r=UL(e.inline,o,t,n);return ML(o,r.x,r.y)},HL=e=>d.from(e).map(C.fromDom),VL=e=>{const t=e.inline?e.getBody():e.getContentAreaContainer();return HL(t).map(ho).getOr(!1)},WL=()=>{const e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}},_y=e=>{const t=[],n=()=>{const m=e.theme;return m&&m.getNotificationManagerImpl?m.getNotificationManagerImpl():WL()},s=()=>d.from(t[0]),o=(m,g)=>m.type===g.type&&m.text===g.text&&!m.progressBar&&!m.timeout&&!g.progressBar&&!g.timeout,r=()=>{B(t,m=>{m.reposition()})},a=m=>{t.push(m)},i=m=>{or(t,g=>g===m).each(g=>{t.splice(g,1)})},l=(m,g=!0)=>{if(!(e.removed||!VL(e)))return g&&e.dispatch("BeforeOpenNotification",{notification:m}),Ye(t,h=>o(n().getArgs(h),m)).getOrThunk(()=>{e.editorManager.setActive(e);const h=n().open(m,()=>{i(h),r(),s().fold(()=>e.focus(),p=>eb(C.fromDom(p.getEl())))});return a(h),r(),e.dispatch("OpenNotification",{notification:{...h}}),h})},c=()=>{s().each(m=>{n().close(m),i(m),r()})},u=F(t);return(m=>{m.on("SkinLoaded",()=>{const g=XN(m);g&&l({text:g,type:"warning",timeout:0},!1),r()}),m.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(r)}),m.on("remove",()=>{B(t.slice(),g=>{n().close(g)})})})(e),{open:l,close:c,getNotifications:u}},Wo=dt.PluginManager,Zs=dt.ThemeManager;var jL=()=>{const e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e,getParams:e,setParams:e}};const Ay=e=>{let t=[];const n=()=>{const p=e.theme;return p&&p.getWindowManagerImpl?p.getWindowManagerImpl():jL()},s=(p,b)=>(...y)=>b?b.apply(p,y):void 0,o=p=>{e.dispatch("OpenWindow",{dialog:p})},r=p=>{e.dispatch("CloseWindow",{dialog:p})},a=p=>{t.push(p),o(p)},i=p=>{r(p),t=re(t,b=>b!==p),t.length===0&&e.focus()},l=()=>d.from(t[t.length-1]),c=p=>{e.editorManager.setActive(e),lu(e),e.ui.show();const b=p();return a(b),b},u=(p,b)=>c(()=>n().open(p,b,i)),f=p=>c(()=>n().openUrl(p,i)),m=(p,b,y)=>{const E=n();E.alert(p,s(y||E,b))},g=(p,b,y)=>{const E=n();E.confirm(p,s(y||E,b))},h=()=>{l().each(p=>{n().close(p),i(p)})};return e.on("remove",()=>{B(t,p=>{n().close(p)})}),{open:u,openUrl:f,alert:m,confirm:g,close:h}},Ry=(e,t)=>{e.notificationManager.open({type:"error",text:t})},Ii=(e,t)=>{e._skinLoaded?Ry(e,t):e.on("SkinLoaded",()=>{Ry(e,t)})},qL=(e,t)=>{Ii(e,on.translate(["Failed to upload image: {0}",t]))},ta=(e,t,n)=>{Th(e,t,{message:n}),console.error(n)},na=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,KL=(e,t,n)=>{ta(e,"PluginLoadError",na("plugin",t,n))},GL=(e,t,n)=>{ta(e,"IconsLoadError",na("icons",t,n))},YL=(e,t,n)=>{ta(e,"LanguageLoadError",na("language",t,n))},XL=(e,t,n)=>{ta(e,"ThemeLoadError",na("theme",t,n))},QL=(e,t,n)=>{ta(e,"ModelLoadError",na("model",t,n))},ZL=(e,t,n)=>{const s=on.translate(["Failed to initialize plugin: {0}",t]);Th(e,"PluginLoadError",{message:s}),Fi(s,n),Ii(e,s)},Fi=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},JL=e=>/^[a-z0-9\-]+$/i.test(e),eI=e=>Ty(e,WN(e)),tI=e=>Ty(e,xp(e)),Ty=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`,r=e.inline===!0;return Ee(t,a=>JL(a)&&!r?`${n}/${a}/${o}`:e.documentBaseURI.toAbsolute(a))},nI=e=>{e.contentCSS=e.contentCSS.concat(eI(e),tI(e))},sI=je,oI=(e,t,n)=>Qw(e,t,sI,n),rI=e=>e?Nt(e.getElementsByTagName("img")):[],aI=(e,t)=>{const n={};return{findAll:(o,r=je)=>{const a=re(rI(o),l=>{const c=l.src;return l.hasAttribute("data-mce-bogus")||l.hasAttribute("data-mce-placeholder")||!c||c===Se.transparentSrc?!1:st(c,"blob:")?!e.isUploaded(c)&&r(l):st(c,"data:")?r(l):!1}),i=Ee(a,l=>{const c=l.src;if(fe(n,c))return n[c].then(u=>ne(u)?u:{image:l,blobInfo:u.blobInfo});{const u=nO(t,c).then(f=>(delete n[c],{image:l,blobInfo:f})).catch(f=>(delete n[c],f));return n[c]=u,u}});return Promise.all(i)}}},Py=()=>{let n={};const s=(m,g)=>({status:m,resultUri:g}),o=m=>m in n;return{hasBlobUri:o,getResultUri:m=>{const g=n[m];return g?g.resultUri:null},isPending:m=>o(m)?n[m].status===1:!1,isUploaded:m=>o(m)?n[m].status===2:!1,markPending:m=>{n[m]=s(1,null)},markUploaded:(m,g)=>{n[m]=s(2,g)},removeFailed:m=>{delete n[m]},destroy:()=>{n={}}}};let iI=0;const lI=()=>{const e=()=>Math.round(Math.random()*4294967295).toString(36),t=new Date().getTime();return"s"+t.toString(36)+e()+e()+e()},cI=e=>e+iI+++lI(),uI=()=>{let e=[];const t=f=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[f.toLowerCase()]||"dat",n=(f,m,g,h,p)=>{if(ne(f))return s({id:f,name:h,filename:p,blob:m,base64:g});if(Ot(f))return s(f);throw new Error("Unknown input type")},s=f=>{if(!f.blob||!f.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const m=f.id||cI("blobid"),g=f.name||m,h=f.blob;return{id:F(m),name:F(g),filename:F(f.filename||g+"."+t(h.type)),blob:F(h),base64:F(f.base64),blobUri:F(f.blobUri||URL.createObjectURL(h)),uri:F(f.uri)}},o=f=>{a(f.id())||e.push(f)},r=f=>Ye(e,f).getOrUndefined(),a=f=>r(m=>m.id()===f);return{create:n,add:o,get:a,getByUri:f=>r(m=>m.blobUri()===f),getByData:(f,m)=>r(g=>g.base64()===f&&g.blob().type===m),findFirst:r,removeByUri:f=>{e=re(e,m=>m.blobUri()===f?(URL.revokeObjectURL(m.blobUri()),!1):!0)},destroy:()=>{B(e,f=>{URL.revokeObjectURL(f.blobUri())}),e=[]}}},fI=(e,t)=>{const n={},s=(h,p)=>h?h.replace(/\/$/,"")+"/"+p.replace(/^\//,""):p,o=(h,p)=>new Promise((b,y)=>{const E=new XMLHttpRequest;E.open("POST",t.url),E.withCredentials=t.credentials,E.upload.onprogress=x=>{p(x.loaded/x.total*100)},E.onerror=()=>{y("Image upload failed due to a XHR Transport error. Code: "+E.status)},E.onload=()=>{if(E.status<200||E.status>=300){y("HTTP Error: "+E.status);return}const x=JSON.parse(E.responseText);if(!x||!ne(x.location)){y("Invalid JSON: "+E.responseText);return}b(s(t.basePath,x.location))};const S=new FormData;S.append("file",h.blob(),h.filename()),E.send(S)}),r=()=>new Promise(h=>{h([])}),a=(h,p)=>({url:p,blobInfo:h,status:!0}),i=(h,p)=>({url:"",blobInfo:h,status:!1,error:p}),l=(h,p)=>{D.each(n[h],b=>{b(p)}),delete n[h]},c=(h,p,b)=>(e.markPending(h.blobUri()),new Promise(y=>{let E,S;try{const x=()=>{E&&(E.close(),S=me)},_=A=>{x(),e.markUploaded(h.blobUri(),A),l(h.blobUri(),a(h,A)),y(a(h,A))},j=A=>{x(),e.removeFailed(h.blobUri()),l(h.blobUri(),i(h,A)),y(i(h,A))};S=A=>{A<0||A>100||d.from(E).orThunk(()=>d.from(b).map(Al)).each(T=>{E=T,T.progressBar.value(A)})},p(h,S).then(_,A=>{j(ne(A)?{message:A}:A)})}catch(x){y(i(h,x))}})),u=h=>h===o,f=h=>{const p=h.blobUri();return new Promise(b=>{n[p]=n[p]||[],n[p].push(b)})},m=(h,p)=>(h=D.grep(h,b=>!e.isUploaded(b.blobUri())),Promise.all(D.map(h,b=>e.isPending(b.blobUri())?f(b):c(b,t.handler,p)))),g=(h,p)=>!t.url&&u(t.handler)?r():m(h,p);return _e(t.handler)===!1&&(t.handler=o),{upload:g}},Dy=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),By=(e,t)=>fI(t,{url:IN(e),basePath:FN(e),credentials:MN(e),handler:UN(e)}),dI=e=>{const t=Py(),n=By(e,t);return{upload:(s,o=!0)=>n.upload(s,o?Dy(e):void 0)}},mI=e=>{const t=uI();let n,s;const o=Py(),r=[],a=S=>x=>e.selection?S(x):[],i=S=>S+(S.indexOf("?")===-1?"?":"&")+new Date().getTime(),l=(S,x,_)=>{let j=0;do j=S.indexOf(x,j),j!==-1&&(S=S.substring(0,j)+_+S.substr(j+x.length),j+=_.length-x.length+1);while(j!==-1);return S},c=(S,x,_)=>{const j=`src="${_}"${_===Se.transparentSrc?' data-mce-placeholder="1"':""}`;return S=l(S,`src="${x}"`,j),S=l(S,'data-mce-src="'+x+'"','data-mce-src="'+_+'"'),S},u=(S,x)=>{B(e.undoManager.data,_=>{_.type==="fragmented"?_.fragments=Ee(_.fragments,j=>c(j,S,x)):_.content=c(_.content,S,x)})},f=(S,x)=>{const _=e.convertURL(x,"src");u(S.src,x),Sn(C.fromDom(S),{src:Ep(e)?i(x):x,"data-mce-src":_})},m=()=>(n||(n=By(e,o)),b().then(a(S=>{const x=Ee(S,_=>_.blobInfo);return n.upload(x,Dy(e)).then(a(_=>{const j=[];let A=!1;const T=Ee(_,($,L)=>{const Q=S[L].blobInfo,q=S[L].image;let z=!1;return $.status&&$N(e)?($.url&&!ft(q.src,$.url)&&(A=!0),t.removeByUri(q.src),Gn(e)||f(q,$.url)):$.error&&($.error.remove&&(u(q.getAttribute("src"),Se.transparentSrc),j.push(q),z=!0),qL(e,$.error.message)),{element:q,status:$.status,uploadUri:$.url,blobInfo:Q,removed:z}});return j.length>0&&!Gn(e)?e.undoManager.transact(()=>{B(j,$=>{e.dom.remove($),t.removeByUri($.src)})}):A&&e.undoManager.dispatchChange(),T}))}))),g=()=>vp(e)?m():Promise.resolve([]),h=S=>io(r,x=>x(S)),p=S=>{r.push(S)},b=()=>(s||(s=aI(o,t)),s.findAll(e.getBody(),h).then(a(S=>{const x=re(S,_=>ne(_)?(Ii(e,_),!1):!0);return Gn(e)||B(x,_=>{u(_.image.src,_.blobInfo.blobUri()),_.image.src=_.blobInfo.blobUri(),_.image.removeAttribute("data-mce-src")}),x}))),y=()=>{t.destroy(),o.destroy(),s=n=null},E=S=>S.replace(/src="(blob:[^"]+)"/g,(x,_)=>{const j=o.getResultUri(_);if(j)return'src="'+j+'"';let A=t.getByUri(_);if(A||(A=$t(e.editorManager.get(),(T,$)=>T||$.editorUpload&&$.editorUpload.blobCache.getByUri(_),null)),A){const T=A.blob();return'src="data:'+T.type+";base64,"+A.base64()+'"'}return x});return e.on("SetContent",()=>{vp(e)?g():b()}),e.on("RawSaveContent",S=>{S.content=E(S.content)}),e.on("GetContent",S=>{S.source_view||S.format==="raw"||S.format==="tree"||(S.content=E(S.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",S=>{B(S,x=>{const _=x.attr("src");if(t.getByUri(_))return;const j=o.getResultUri(_);j&&x.attr("src",j)})})}),{blobCache:t,addFilter:p,uploadImages:m,uploadImagesAuto:g,scanForImages:b,destroy:y}},gI=e=>{const t=e.dom,n=e.schema.type,s={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const o={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},a={inline:"s",remove:"all",preserve_attributes:["class","style"]};return n!=="html4"?[a,o,r]:[o,a,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(o,r,a)=>Z(o)&&o.hasAttribute("href"),onformat:(o,r,a)=>{D.each(a,(i,l)=>{t.setAttrib(o,l,i)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":o=>{var r;return(r=o==null?void 0:o.customValue)!==null&&r!==void 0?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return D.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),o=>{s[o]={block:o,remove:"all"}}),s},Oy={remove_similar:!0,inherit:!1},jo={selector:"td,th",...Oy},pI={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...jo},tablecellverticalalign:{styles:{"vertical-align":"%value"},...jo},tablecellbordercolor:{styles:{borderColor:"%value"},...jo},tablecellclass:{classes:["%value"],...jo},tableclass:{selector:"table",classes:["%value"],...Oy},tablecellborderstyle:{styles:{borderStyle:"%value"},...jo},tablecellborderwidth:{styles:{borderWidth:"%value"},...jo}},hI=F(pI),bI=e=>{const t={},n=a=>oe(a)?t[a]:t,s=a=>fe(t,a),o=(a,i)=>{a&&(ne(a)?(Ge(i)||(i=[i]),B(i,l=>{kt(l.deep)&&(l.deep=!It(l)),kt(l.split)&&(l.split=!It(l)||Ze(l)),kt(l.remove)&&It(l)&&!Ze(l)&&(l.remove="none"),It(l)&&Ze(l)&&(l.mixed=!0,l.block_expand=!0),ne(l.classes)&&(l.classes=l.classes.split(/\s+/))}),t[a]=i):Pe(a,(l,c)=>{o(c,l)}))},r=a=>(a&&t[a]&&delete t[a],t);return o(gI(e)),o(hI()),o(JN(e)),{get:n,has:s,register:o,unregister:r}},Mi=D.each,Dt=Re.DOM,$y=(e,t)=>{let n,s,o;const r=t&&t.schema||ls({}),a=(u,f)=>{f.classes.length&&Dt.addClass(u,f.classes.join(" ")),Dt.setAttribs(u,f.attrs)},i=u=>{s=typeof u=="string"?{name:u,classes:[],attrs:{}}:u;const f=Dt.create(s.name);return a(f,s),f},l=(u,f)=>{const m=typeof u!="string"?u.nodeName.toLowerCase():u,g=r.getElementRule(m),h=g&&g.parentsRequired;return h&&h.length?f&&D.inArray(h,f)!==-1?f:h[0]:!1},c=(u,f,m)=>{let g,h;const p=f.length>0&&f[0],b=p&&p.name,y=l(u,b);if(y)b===y?(h=f[0],f=f.slice(1)):h=y;else if(p)h=f[0],f=f.slice(1);else if(!m)return u;return h&&(g=i(h),g.appendChild(u)),m&&(g||(g=Dt.create("div"),g.appendChild(u)),D.each(m,E=>{const S=i(E);g.insertBefore(S,u)})),c(g,f,h&&h.siblings)};return e&&e.length?(s=e[0],n=i(s),o=Dt.create("div"),o.appendChild(c(n,e.slice(1),s.siblings)),o):""},CI=e=>{let t;const n={classes:[],attrs:{}};return e=n.selector=D.trim(e),e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(s,o,r,a,i)=>{switch(o){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":D.inArray("checked disabled enabled read-only required".split(" "),r)!==-1&&(n.attrs[r]=r);break}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=t||"div",n},yI=e=>!e||typeof e!="string"?[]:(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),D.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{const n=D.map(t.split(/(?:~\+|~|\+)/),CI),s=n.pop();return n.length&&(s.siblings=n),s}).reverse()),vI=(e,t)=>{let n,s,o="",r,a=e_(e);if(a==="")return"";const i=u=>u.replace(/%(\w+)/g,"");if(typeof t=="string"){if(t=e.formatter.get(t),!t)return;t=t[0]}if("preview"in t){const u=Te(t,"preview");if(go(u,!1))return"";a=u.getOr(a)}n=t.block||t.inline||"span";const l=yI(t.selector);l.length?(l[0].name||(l[0].name=n),n=t.selector,s=$y(l,e)):s=$y([n],e);const c=Dt.select(n,s)[0]||s.firstChild;return Mi(t.styles,(u,f)=>{const m=i(u);m&&Dt.setStyle(c,f,m)}),Mi(t.attributes,(u,f)=>{const m=i(u);m&&Dt.setAttrib(c,f,m)}),Mi(t.classes,u=>{const f=i(u);Dt.hasClass(c,f)||Dt.addClass(c,f)}),e.dispatch("PreviewFormats"),Dt.setStyles(s,{position:"absolute",left:-65535}),e.getBody().appendChild(s),r=Dt.getStyle(e.getBody(),"fontSize",!0),r=/px$/.test(r)?parseInt(r,10):0,Mi(a.split(" "),u=>{let f=Dt.getStyle(c,u,!0);if(!(u==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(f)&&(f=Dt.getStyle(e.getBody(),u,!0),ei(f).toLowerCase()==="#ffffff"))&&!(u==="color"&&ei(f).toLowerCase()==="#000000")){if(u==="font-size"&&/em|%$/.test(f)){if(r===0)return;f=parseFloat(f)/(/%$/.test(f)?100:1)*r+"px"}u==="border"&&f&&(o+="padding:0 2px;"),o+=u+":"+f+";"}}),e.dispatch("AfterPreviewFormats"),Dt.remove(s),o},EI=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},Ly=e=>{const t=bI(e),n=Qe(null);return EI(e),VD(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(s,o,r)=>{M$(e,s,o,r)},remove:(s,o,r,a)=>{U$(e,s,o,r,a)},toggle:(s,o,r)=>{z$(e,s,o,r)},match:(s,o,r,a)=>O$(e,s,o,r,a),closest:s=>F$(e,s),matchAll:(s,o)=>$$(e,s,o),matchNode:(s,o,r,a)=>L$(e,s,o,r,a),canApply:s=>I$(e,s),formatChanged:(s,o,r,a)=>H$(e,n,s,o,r,a),getCssText:V(vI,e)}},Iy=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},SI=(e,t,n)=>{const s=Qe(!1),o=l=>{Bi(t,!1,n),t.add({},l)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",l=>{const c=l.command;Iy(c)||(hy(t,n),t.beforeChange())}),e.on("ExecCommand",l=>{const c=l.command;Iy(c)||o(l)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",l=>{const c=l.keyCode;l.isDefaultPrevented()||((c>=33&&c<=36||c>=37&&c<=40||c===45||l.ctrlKey)&&(o(),e.nodeChanged()),(c===46||c===8)&&e.nodeChanged(),s.get()&&t.typing&&hf(Di(e),t.data[0])===!1&&(e.isDirty()===!1&&e.setDirty(!0),e.dispatch("TypingUndo"),s.set(!1),e.nodeChanged()))}),e.on("keydown",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;if(c>=33&&c<=36||c>=37&&c<=40||c===45){t.typing&&o(l);return}const u=l.ctrlKey&&!l.altKey||l.metaKey;(c<16||c>20)&&c!==224&&c!==91&&!t.typing&&!u&&(t.beforeChange(),Bi(t,!0,n),t.add({},l),s.set(!0))}),e.on("mousedown",l=>{t.typing&&o(l)});const r=l=>l.inputType==="insertReplacementText",a=l=>l.inputType==="insertText"&&l.data===null,i=l=>l.inputType==="insertFromPaste"||l.inputType==="insertFromDrop";e.on("input",l=>{l.inputType&&(r(l)||a(l)||i(l))&&o(l)}),e.on("AddUndo Undo Redo ClearUndos",l=>{l.isDefaultPrevented()||e.nodeChanged()})},wI=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},Fy=e=>{const t=cs(),n=Qe(0),s=Qe(0),o={data:[],typing:!1,beforeChange:()=>{w$(e,n,t)},add:(r,a)=>k$(e,o,s,n,t,r,a),dispatchChange:()=>{e.setDirty(!0),e.dispatch("change",{level:Di(e),lastLevel:Dl(o.data,s.get()).getOrUndefined()})},undo:()=>x$(e,o,n,s),redo:()=>N$(e,s,o.data),clear:()=>{_$(e,o,s)},reset:()=>{A$(e,o)},hasUndo:()=>R$(e,o,s),hasRedo:()=>T$(e,o,s),transact:r=>P$(e,o,n,r),ignore:r=>{D$(e,n,r)},extra:(r,a)=>{B$(e,o,s,r,a)}};return Gn(e)||SI(e,o,n),wI(e),o},kI=[9,27,G.HOME,G.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,G.DOWN,G.UP,G.LEFT,G.RIGHT].concat(Se.browser.isFirefox()?[224]:[]),My="data-mce-placeholder",Uy=e=>e.type==="keydown"||e.type==="keyup",zy=e=>{const t=e.keyCode;return t===G.BACKSPACE||t===G.DELETE},xI=e=>{if(Uy(e)){const t=e.keyCode;return!zy(e)&&(G.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||De(kI,t))}else return!1},NI=e=>Uy(e)&&!(zy(e)||e.type==="keyup"&&e.keyCode===229),_I=(e,t,n)=>{if(Xe(C.fromDom(t),!1)){const s=t.firstElementChild;return s?e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right")?!1:n===s.nodeName.toLowerCase():!0}else return!1},AI=e=>{const t=e.dom,n=Rt(e),s=YN(e),o=(r,a)=>{if(xI(r))return;const i=e.getBody(),l=NI(r)?!1:_I(t,i,n);(t.getAttrib(i,My)!==""!==l||a)&&(t.setAttrib(i,My,l?s:null),t.setAttrib(i,"aria-placeholder",l?s:null),oR(e,l),e.on(l?"keydown":"keyup",o),e.off(l?"keyup":"keydown",o))};s&&e.on("init",r=>{o(r,!0),e.on("change SetContent ExecCommand",o),e.on("paste",a=>qt.setEditorTimeout(e,()=>o(a)))})},RI=(e,t)=>({block:e,position:t}),TI=(e,t)=>({from:e,to:t}),vf=(e,t)=>{const n=C.fromDom(e),s=C.fromDom(t.container());return Ci(n,s).map(o=>RI(o,t))},PI=e=>Ae(e.from.block,e.to.block)===!1,DI=e=>Zt(e.from.block).bind(t=>Zt(e.to.block).filter(n=>Ae(t,n))).isSome(),BI=e=>Oe(e.from.block.dom)===!1&&Oe(e.to.block.dom)===!1,OI=(e,t,n)=>Ue(n.position.getNode())&&Xe(n.block)===!1?Bo(!1,n.block.dom).bind(s=>s.isEqual(n.position)?Vt(t,e,s).bind(o=>vf(e,o)):d.some(n)).getOr(n):n,$I=(e,t,n)=>{const s=vf(e,N.fromRangeStart(n)),o=s.bind(r=>Vt(t,e,r.position).bind(a=>vf(e,a).map(i=>OI(e,t,i))));return _t(s,o,TI).filter(r=>PI(r)&&DI(r)&&BI(r))},LI=(e,t,n)=>n.collapsed?$I(e,t,n):d.none(),II=e=>{const t=at(e);return or(t,sn).fold(F(t),n=>t.slice(0,n))},Hy=e=>{const t=II(e);return B(t,Fe),t},Vy=(e,t)=>{const n=Kn(t,e);return Ye(n.reverse(),s=>Xe(s)).each(Fe)},FI=e=>re(Fm(e),t=>!Xe(t)).length===0,MI=(e,t,n,s)=>{if(Xe(n))return Ks(n),yt(n.dom);FI(s)&&Xe(t)&&Jt(s,C.fromTag("br"));const o=an(n.dom,N.before(s.dom));return B(Hy(t),r=>{Jt(s,r)}),Vy(e,t),o},UI=(e,t,n)=>{if(Xe(n))return Fe(n),Xe(t)&&Ks(t),yt(t.dom);const s=Pn(n.dom);return B(Hy(t),o=>{qe(n,o)}),Vy(e,t),s},zI=(e,t)=>{const n=Kn(t,e);return d.from(n[n.length-1])},HI=(e,t)=>Vn(t,e)?zI(t,e):d.none(),Wy=(e,t)=>{Bo(e,t.dom).map(n=>n.getNode()).map(C.fromDom).filter(vo).each(Fe)},jy=(e,t,n)=>(Wy(!0,t),Wy(!1,n),HI(t,n).fold(V(UI,e,t,n),V(MI,e,t,n))),qy=(e,t,n,s)=>t?jy(e,s,n):jy(e,n,s),Ef=(e,t)=>{const n=C.fromDom(e.getBody());return LI(n.dom,t,e.selection.getRng()).map(o=>()=>{qy(n,t,o.from.block,o.to.block).each(r=>{e.selection.setRng(r.toRange())})})},VI=(e,t)=>{const n=t.getRng();return _t(Ci(e,C.fromDom(n.startContainer)),Ci(e,C.fromDom(n.endContainer)),(s,o)=>Ae(s,o)===!1?d.some(()=>{n.deleteContents(),qy(e,!0,s,o).each(r=>{t.setRng(r.toRange())})}):d.none()).getOr(d.none())},Ky=(e,t)=>{const n=C.fromDom(t),s=V(Ae,e);return Co(n,Ta,s).isSome()},WI=(e,t)=>Ky(e,t.startContainer)||Ky(e,t.endContainer),jI=(e,t)=>{const n=an(e.dom,N.fromRangeStart(t)).isNone(),s=Wt(e.dom,N.fromRangeEnd(t)).isNone();return!WI(e,t)&&n&&s},qI=e=>d.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),KI=e=>{const t=C.fromDom(e.getBody()),n=e.selection.getRng();return jI(t,n)?qI(e):VI(t,e.selection)},Sf=(e,t)=>e.selection.isCollapsed()?d.none():KI(e),GI=xn,YI=Oe,Yn=(e,t,n,s,o)=>d.from(t._selectionOverrides.showCaret(e,n,s,o)),XI=e=>{const t=e.ownerDocument.createRange();return t.selectNode(e),t},sa=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?d.none():d.some(XI(t)),QI=(e,t,n)=>{const s=Dc(1,e.getBody(),t),o=N.fromRangeStart(s),r=o.getNode();if($r(r))return Yn(1,e,r,!o.isAtEnd(),!1);const a=o.getNode(!0);if($r(a))return Yn(1,e,a,!1,!1);const i=e.dom.getParent(o.getNode(),l=>YI(l)||GI(l));return $r(i)?Yn(1,e,i,!1,n):d.none()},wf=(e,t,n)=>t.collapsed?QI(e,t,n).getOr(t):t,ZI=e=>ps(e)||Gr(e),JI=e=>hs(e)||Yr(e),eF=(e,t)=>{M(t)&&t.data.length===0&&e.remove(t)},Gy=(e,t,n,s,o,r)=>{Yn(s,e,r.getNode(!o),o,!0).each(a=>{if(t.collapsed){const i=t.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),eF(e.dom,n)},tF=(e,t)=>{const n=e.selection.getRng();if(!M(n.commonAncestorContainer))return d.none();const s=t?Ke.Forwards:Ke.Backwards,o=Tn(e.getBody()),r=V(Bc,t?o.next:o.prev),a=t?ZI:JI,i=Ur(s,e.getBody(),n),l=Kt(t,r(i));if(!l||!Ya(i,l))return d.none();if(a(l))return d.some(()=>Gy(e,n,i.getNode(),s,t,l));const c=r(l);return c&&a(c)&&Ya(l,c)?d.some(()=>Gy(e,n,i.getNode(),s,t,c)):d.none()},kf=(e,t)=>tF(e,t),xf=(e,t)=>{const n=e.getBody();return t?yt(n).filter(ps):Pn(n).filter(hs)},Nf=e=>{const t=e.selection.getRng();return!t.collapsed&&(xf(e,!0).exists(n=>n.isEqual(N.fromRangeStart(t)))||xf(e,!1).exists(n=>n.isEqual(N.fromRangeEnd(t))))},nF=e=>Ta(C.fromDom(e))||Sr(C.fromDom(e)),Ft=_n.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),sF=(e,t)=>{const n=t.getNode(e===!1),s=e?"after":"before";return Z(n)&&n.getAttribute("data-mce-caret")===s},oF=(e,t,n,s)=>{const o=r=>ec(C.fromDom(r))&&!An(n,s,e);return qp(!t,n).fold(()=>qp(t,s).fold(Le,o),o)},Yy=(e,t,n,s)=>{const o=s.getNode(t===!1);return Ci(C.fromDom(e),C.fromDom(n.getNode())).map(r=>Xe(r)?Ft.remove(r.dom):Ft.moveToElement(o)).orThunk(()=>d.some(Ft.moveToElement(o)))},Xy=(e,t,n)=>Vt(t,e,n).bind(s=>nF(s.getNode())||oF(e,t,n,s)?d.none():t&&Oe(s.getNode())||t===!1&&Oe(s.getNode(!0))?Yy(e,t,n,s):t&&hs(n)||t===!1&&ps(n)?d.some(Ft.moveToPosition(s)):d.none()),rF=(e,t)=>e&&Oe(t.nextSibling)?d.some(Ft.moveToElement(t.nextSibling)):e===!1&&Oe(t.previousSibling)?d.some(Ft.moveToElement(t.previousSibling)):d.none(),aF=(e,t,n)=>n.fold(s=>d.some(Ft.remove(s)),s=>d.some(Ft.moveToElement(s)),s=>An(t,s,e)?d.none():d.some(Ft.moveToPosition(s))),iF=(e,t,n)=>sF(t,n)?rF(t,n.getNode(t===!1)).fold(()=>Xy(e,t,n),d.some):Xy(e,t,n).bind(s=>aF(e,n,s)),lF=(e,t,n)=>{const s=Dc(t?1:-1,e,n),o=N.fromRangeStart(s),r=C.fromDom(e);return t===!1&&hs(o)?d.some(Ft.remove(o.getNode(!0))):t&&ps(o)?d.some(Ft.remove(o.getNode())):t===!1&&ps(o)&&vu(r,o)?w1(r,o).map(a=>Ft.remove(a.getNode())):t&&hs(o)&&yu(r,o)?k1(r,o).map(a=>Ft.remove(a.getNode())):iF(e,t,o)},cF=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),Gs(e,t,C.fromDom(n)),!0),uF=(e,t)=>n=>{const s=t?N.before(n):N.after(n);return e.selection.setRng(s.toRange()),!0},fF=e=>t=>(e.selection.setRng(t.toRange()),!0),Qy=(e,t)=>d.from(Qr(e.getBody(),t)),dF=(e,t)=>{const n=e.selection.getNode();return Qy(e,n).filter(Oe).fold(()=>lF(e.getBody(),t,e.selection.getRng()).map(s=>()=>s.fold(cF(e,t),uF(e,t),fF(e))),()=>d.some(me))},mF=e=>{B(At(e,".mce-offscreen-selection"),Fe)},gF=(e,t)=>{const n=e.selection.getNode();return Oe(n)&&!Ra(n)?Qy(e,n.parentNode).filter(Oe).fold(()=>d.some(()=>{mF(C.fromDom(e.getBody())),Gs(e,t,C.fromDom(e.selection.getNode())),jb(e)}),()=>d.some(me)):Nf(e)?d.some(()=>{Kb(e,e.selection.getRng(),C.fromDom(e.getBody()))}):d.none()},Zy=e=>{const t=e.dom,n=e.selection,s=Qr(e.getBody(),n.getNode());if(xn(s)&&t.isBlock(s)&&t.isEmpty(s)){const o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(s,""),s.appendChild(o),n.setRng(N.before(o).toRange())}return!0},_f=(e,t)=>e.selection.isCollapsed()?dF(e,t):gF(e,t),pF=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return Vt(t,e.getBody(),n).filter(s=>t?m1(s):g1(s)).bind(s=>d.from(Pc(t?0:-1,s))).map(s=>()=>e.selection.select(s))},Af=(e,t)=>e.selection.isCollapsed()?pF(e,t):d.none(),qo=M,Jy=e=>qo(e)&&e.data[0]===tt,ev=e=>qo(e)&&e.data[e.data.length-1]===tt,tv=e=>e.ownerDocument.createTextNode(tt),hF=e=>{if(qo(e.previousSibling))return ev(e.previousSibling)||e.previousSibling.appendData(tt),e.previousSibling;if(qo(e))return Jy(e)||e.insertData(0,tt),e;{const t=tv(e);return e.parentNode.insertBefore(t,e),t}},bF=e=>{if(qo(e.nextSibling))return Jy(e.nextSibling)||e.nextSibling.insertData(0,tt),e.nextSibling;if(qo(e))return ev(e)||e.appendData(tt),e;{const t=tv(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t}},Ui=(e,t)=>e?hF(t):bF(t),CF=V(Ui,!0),yF=V(Ui,!1),nv=(e,t)=>M(e.container())?Ui(t,e.container()):Ui(t,e.getNode()),sv=(e,t)=>{const n=t.get();return n&&e.container()===n&&wo(n)},Rf=(e,t)=>t.fold(n=>{Hs(e.get());const s=CF(n);return e.set(s),d.some(N(s,s.length-1))},n=>yt(n).map(s=>{if(sv(s,e))return N(e.get(),1);{Hs(e.get());const o=nv(s,!0);return e.set(o),N(o,1)}}),n=>Pn(n).map(s=>{if(sv(s,e))return N(e.get(),e.get().length-1);{Hs(e.get());const o=nv(s,!1);return e.set(o),N(o,o.length-1)}}),n=>{Hs(e.get());const s=yF(n);return e.set(s),d.some(N(s,1))}),ov=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n].apply(null,t);if(s.isSome())return s}return d.none()},mt=_n.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),rv=(e,t)=>{const n=ds(t,e);return n||e},vF=(e,t,n)=>{const s=Hb(n),o=rv(t,s.container());return bs(e,o,s).fold(()=>Wt(o,s).bind(V(bs,e,o)).map(r=>mt.before(r)),d.none)},EF=(e,t)=>Ws(e,t)===null,av=(e,t,n)=>bs(e,t,n).filter(V(EF,t)),SF=(e,t,n)=>{const s=Vb(n);return av(e,t,s).bind(o=>an(o,s).isNone()?d.some(mt.start(o)):d.none())},wF=(e,t,n)=>{const s=Hb(n);return av(e,t,s).bind(o=>Wt(o,s).isNone()?d.some(mt.end(o)):d.none())},kF=(e,t,n)=>{const s=Vb(n),o=rv(t,s.container());return bs(e,o,s).fold(()=>an(o,s).bind(V(bs,e,o)).map(r=>mt.after(r)),d.none)},iv=e=>oP(Tf(e))===!1,Ln=(e,t,n)=>ov([vF,SF,wF,kF],[e,t,n]).filter(iv),Tf=e=>e.fold(bt,bt,bt,bt),lv=e=>e.fold(F("before"),F("start"),F("end"),F("after")),zi=e=>e.fold(mt.before,mt.before,mt.after,mt.after),Pf=e=>e.fold(mt.start,mt.start,mt.end,mt.end),xF=(e,t)=>lv(e)===lv(t)&&Tf(e)===Tf(t),NF=(e,t,n,s,o,r)=>_t(bs(t,n,s),bs(t,n,o),(a,i)=>a!==i&&aP(n,a,i)?mt.after(e?a:i):r).getOr(r),_F=(e,t)=>e.fold(je,n=>!xF(n,t)),AF=(e,t,n,s,o)=>{const r=Kt(e,o);return Vt(e,n,r).map(V(Kt,e)).fold(()=>s.map(zi),l=>Ln(t,n,l).map(V(NF,e,t,n,r,l)).filter(V(_F,s))).filter(iv)},RF=(e,t)=>e?t.fold(ws(d.some,mt.start),d.none,ws(d.some,mt.after),d.none):t.fold(d.none,ws(d.some,mt.before),d.none,ws(d.some,mt.end)),TF=(e,t,n,s)=>{const o=Kt(e,s),r=Ln(t,n,o);return Ln(t,n,o).bind(V(RF,e)).orThunk(()=>AF(e,t,n,r,s))},PF=e=>_e(e.selection.getSel().modify),cv=(e,t,n)=>{const s=e?1:-1;return t.setRng(N(n.container(),n.offset()+s).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},DF=(e,t)=>{const n=t.selection.getRng(),s=e?N.fromRangeEnd(n):N.fromRangeStart(n);return PF(t)?e&&nc(s)?cv(!0,t.selection,s):!e&&sc(s)?cv(!1,t.selection,s):!1:!1};var In;(function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"})(In||(In={}));const Hi=(e,t)=>e===Ke.Backwards?rr(t):t,BF=(e,t,n)=>e===Ke.Forwards?t.next(n):t.prev(n),OF=(e,t,n,s)=>Ue(s.getNode(t===Ke.Forwards))?In.Br:An(n,s)===!1?In.Block:In.Wrap,uv=(e,t,n,s)=>{const o=Tn(n);let r=s;const a=[];for(;r;){const i=BF(t,o,r);if(!i)break;if(Ue(i.getNode(!1)))return t===Ke.Forwards?{positions:Hi(t,a).concat([i]),breakType:In.Br,breakAt:d.some(i)}:{positions:Hi(t,a),breakType:In.Br,breakAt:d.some(i)};if(!i.isVisible()){r=i;continue}if(e(r,i)){const l=OF(n,t,r,i);return{positions:Hi(t,a),breakType:l,breakAt:d.some(i)}}a.push(i),r=i}return{positions:Hi(t,a),breakType:In.Eol,breakAt:d.none()}},fv=(e,t,n,s)=>t(n,s).breakAt.map(o=>{const r=t(n,o).positions;return e===Ke.Backwards?r.concat(o):[o].concat(r)}).getOr([]),Df=(e,t)=>$t(e,(n,s)=>n.fold(()=>d.some(s),o=>_t(Lt(o.getClientRects()),Lt(s.getClientRects()),(r,a)=>{const i=Math.abs(t-r.left);return Math.abs(t-a.left)<=i?s:o}).or(n)),d.none()),Vi=(e,t)=>Lt(t.getClientRects()).bind(n=>Df(e,n.left)),oa=V(uv,N.isAbove,-1),ra=V(uv,N.isBelow,1),dv=V(fv,-1,oa),mv=V(fv,1,ra),$F=(e,t)=>oa(e,t).breakAt.isNone(),LF=(e,t)=>ra(e,t).breakAt.isNone(),IF=e=>yt(e).map(t=>[t].concat(ra(e,t).positions)).getOr([]),FF=e=>Pn(e).map(t=>oa(e,t).positions.concat(t)).getOr([]),MF=(e,t)=>Vi(dv(e,t),t),UF=(e,t)=>Vi(mv(e,t),t),zF=Oe,gv=(e,t)=>Math.abs(e.left-t),pv=(e,t)=>Math.abs(e.right-t),HF=e=>uo(e,"node"),hv=(e,t)=>ya(e,(n,s)=>{const o=Math.min(gv(n,t),pv(n,t)),r=Math.min(gv(s,t),pv(s,t));return r===o&&HF(s)&&zF(s.node)||r<o?s:n}),VF=e=>{const t=n=>Ee(n,s=>{const o=Ms(s);return o.node=e,o});if(Z(e))return t(e.getClientRects());if(M(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}else return[]},bv=e=>Un(e,VF);var aa;(function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"})(aa||(aa={}));const WF=(e,t,n,s)=>{for(;s=Ir(s,e,bg,t);)if(n(s))return},Cv=(e,t,n,s,o,r)=>{let a=0;const i=[],l=f=>{let m=bv([f]);e===-1&&(m=m.reverse());for(let g=0;g<m.length;g++){const h=m[g];if(!n(h,c)){if(i.length>0&&t(h,ts(i))&&a++,h.line=a,o(h))return!0;i.push(h)}}},c=ts(r.getClientRects());if(!c)return i;const u=r.getNode();return l(u),WF(e,s,l,u),i},jF=(e,t)=>t.line>e,qF=(e,t)=>t.line===e,KF=V(Cv,aa.Up,Tr,Pr),GF=V(Cv,aa.Down,Pr,Tr),YF=(e,t,n,s)=>{const o=Tn(t);let r,a,i,l;const c=[];let u=0;const f=g=>ts(g.getClientRects());e===1?(r=o.next,a=Pr,i=Tr,l=N.after(s)):(r=o.prev,a=Tr,i=Pr,l=N.before(s));const m=f(l);do{if(!l.isVisible())continue;const g=f(l);if(i(g,m))continue;c.length>0&&a(g,ts(c))&&u++;const h=Ms(g);if(h.position=l,h.line=u,n(h))return c;c.push(h)}while(l=r(l));return c},yv=e=>t=>jF(e,t),Bf=e=>t=>qF(e,t),Xn=(e,t)=>{e.selection.setRng(t),qr(e,e.selection.getRng())},Of=(e,t,n)=>d.some(wf(e,t,n)),vv=(e,t,n,s,o,r)=>{const a=t===Ke.Forwards,i=Tn(e.getBody()),l=V(Bc,a?i.next:i.prev),c=a?s:o;if(!n.collapsed){const h=za(n);if(r(h))return Yn(t,e,h,t===Ke.Backwards,!1);if(Nf(e)){const p=n.cloneRange();return p.collapse(t===Ke.Backwards),d.from(p)}}const u=Ur(t,e.getBody(),n);if(c(u))return sa(e,u.getNode(!a));const f=Kt(a,l(u)),m=gg(n);if(!f)return m?d.some(n):d.none();if(c(f))return Yn(t,e,f.getNode(!a),a,!1);const g=l(f);return g&&c(g)&&Ya(f,g)?Yn(t,e,g.getNode(!a),a,!1):m?Of(e,f.toRange(),!1):d.none()},Ev=(e,t,n,s,o,r)=>{const a=Ur(t,e.getBody(),n),i=ts(a.getClientRects()),l=t===aa.Down,c=e.getBody();if(!i)return d.none();if(Nf(e)){const b=l?N.fromRangeEnd(n):N.fromRangeStart(n);return(l?UF:MF)(c,b).orThunk(()=>d.from(b)).map(E=>E.toRange())}const f=(l?GF:KF)(c,yv(1),a),m=re(f,Bf(1)),g=i.left,h=hv(m,g);if(h&&r(h.node)){const b=Math.abs(g-h.left),y=Math.abs(g-h.right);return Yn(t,e,h.node,b<y,!1)}let p;if(s(a)?p=a.getNode():o(a)?p=a.getNode(!0):p=za(n),p){const b=YF(t,c,yv(1),p);let y=hv(re(b,Bf(1)),g);if(y||(y=ts(re(b,Bf(0))),y))return Of(e,y.position.toRange(),!1)}return m.length===0?$f(e,l).filter(l?o:s).map(b=>wf(e,b.toRange(),!1)):d.none()},$f=(e,t)=>{const n=e.selection.getRng(),s=t?N.fromRangeEnd(n):N.fromRangeStart(n),o=Z_(s.container(),e.getBody());if(t){const r=ra(o,s);return lo(r.positions)}else{const r=oa(o,s);return Lt(r.positions)}},Sv=(e,t,n)=>$f(e,t).filter(n).exists(s=>(e.selection.setRng(s.toRange()),!0)),Wi=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},wv=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},kv=(e,t,n)=>Rf(t,n).map(s=>(Wi(e,s),n)),XF=(e,t,n)=>{const s=N.fromRangeStart(e);if(e.collapsed)return s;{const o=N.fromRangeEnd(e);return n?an(t,o).getOr(o):Wt(t,s).getOr(s)}},QF=(e,t,n)=>{const s=e.getBody(),o=XF(e.selection.getRng(),s,n),r=V(Ys,e);return TF(n,r,s,o).bind(i=>kv(e,t,i))},ZF=(e,t,n)=>{const s=Ee(At(C.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),a=>a.dom),o=re(s,e),r=re(n,e);B(Tl(o,r),V(wv,!1)),B(Tl(r,o),V(wv,!0))},JF=(e,t)=>{if(e.selection.isCollapsed()&&e.composing!==!0&&t.get()){const n=N.fromRangeStart(e.selection.getRng());N.isTextPosition(n)&&iP(n)===!1&&(Wi(e,H_(t.get(),n)),t.set(null))}},eM=(e,t,n,s)=>{if(t.selection.isCollapsed()){const o=re(s,e);B(o,r=>{const a=N.fromRangeStart(t.selection.getRng());Ln(e,t.getBody(),a).bind(i=>kv(t,n,i))})}},xv=(e,t,n)=>Or(e)?QF(e,t,n).isSome():!1,Nv=(e,t,n)=>Or(t)?DF(e,t):!1,tM=e=>{const t=Qe(null),n=V(Ys,e);return e.on("NodeChange",s=>{Or(e)&&(ZF(n,e.dom,s.parents),JF(e,t),eM(n,e,t,s.parents))}),t},nM=V(Nv,!0),sM=V(Nv,!1),ji=(e,t,n)=>{if(Or(e)){const s=$f(e,t).getOrThunk(()=>{const o=e.selection.getRng();return t?N.fromRangeEnd(o):N.fromRangeStart(o)});return Ln(V(Ys,e),e.getBody(),s).exists(o=>{const r=zi(o);return Rf(n,r).exists(a=>(Wi(e,a),!0))})}else return!1},oM=(e,t)=>{const n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},rM=e=>_t(yt(e),Pn(e),(t,n)=>{const s=Kt(!0,t),o=Kt(!1,n);return Wt(e,s).forall(r=>r.isEqual(o))}).getOr(!0),_v=(e,t)=>n=>Rf(t,n).map(s=>()=>Wi(e,s)),Av=(e,t,n,s)=>{const o=e.getBody(),r=V(Ys,e);e.undoManager.ignore(()=>{e.selection.setRng(oM(n,s)),ku(e),Ln(r,o,N.fromRangeStart(e.selection.getRng())).map(Pf).bind(_v(e,t)).each(nr)}),e.nodeChanged()},aM=(e,t)=>{const n=ds(t,e);return n||e},iM=(e,t,n,s)=>{const o=aM(e.getBody(),s.container()),r=V(Ys,e),a=Ln(r,o,s);return a.bind(l=>n?l.fold(F(d.some(Pf(l))),d.none,F(d.some(zi(l))),d.none):l.fold(d.none,F(d.some(zi(l))),d.none,F(d.some(Pf(l))))).map(_v(e,t)).getOrThunk(()=>{const l=Qa(n,o,s),c=l.bind(u=>Ln(r,o,u));return _t(a,c,()=>bs(r,o,s).bind(u=>rM(u)?d.some(()=>{Gs(e,n,C.fromDom(u))}):d.none())).getOrThunk(()=>c.bind(()=>l.map(u=>()=>{n?Av(e,t,s,u):Av(e,t,u,s)})))})},Lf=(e,t,n)=>{if(e.selection.isCollapsed()&&Or(e)){const s=N.fromRangeStart(e.selection.getRng());return iM(e,t,n,s)}return d.none()},lM=(e,t)=>{const n=Kn(t,e);return or(n,sn).fold(F(n),s=>n.slice(0,s))},cM=e=>zm(e)===1,uM=(e,t,n,s)=>{const o=V(jD,t),r=Ee(re(s,o),a=>a.dom);if(r.length===0)Gs(t,e,n);else{const a=WD(n.dom,r);t.selection.setRng(a.toRange())}},fM=(e,t)=>{const n=C.fromDom(e.getBody()),s=C.fromDom(e.selection.getStart()),o=re(lM(n,s),cM);return lo(o).bind(r=>{const a=N.fromRangeStart(e.selection.getRng());return dP(t,a,r.dom)&&!qD(r)?d.some(()=>uM(t,e,r,o)):d.none()})},If=(e,t)=>e.selection.isCollapsed()?fM(e,t):d.none(),Ff=(e,t,n)=>d.some(()=>{e._selectionOverrides.hideFakeCaret(),Gs(e,t,C.fromDom(n))}),dM=(e,t)=>{const n=t?Gr:Yr,s=t?Ke.Forwards:Ke.Backwards,o=Ur(s,e.getBody(),e.selection.getRng());return n(o)?Ff(e,t,o.getNode(!t)):d.from(Kt(t,o)).filter(r=>n(r)&&Ya(o,r)).map(r=>()=>Ff(e,t,r.getNode(!t)))},mM=(e,t)=>{const n=e.selection.getNode();return Nn(n)?Ff(e,t,n):d.none()},Mf=(e,t)=>e.selection.isCollapsed()?dM(e,t):mM(e,t),gM=e=>yo(e,t=>xn(t.dom)||Oe(t.dom)).exists(t=>xn(t.dom)),Uf=e=>{const t=parseInt(e,10);return isNaN(t)?0:t},Rv=(e,t)=>{const n=e||Ek(t)?"margin":"padding",s=kn(t,"direction")==="rtl"?"-right":"-left";return n+s},pM=(e,t,n,s,o,r)=>{const a=Rv(n,C.fromDom(r));if(t==="outdent"){const i=Math.max(0,Uf(r.style[a])-s);e.setStyle(r,a,i?i+o:"")}else{const i=Uf(r.style[a])+s+o;e.setStyle(r,a,i)}},hM=(e,t)=>io(t,n=>{const s=Rv(kp(e),n),o=xa(n,s).map(Uf).getOr(0);return e.dom.getContentEditable(n.dom)!=="false"&&o>0}),Tv=e=>{const t=Dv(e);return!e.mode.isReadOnly()&&(t.length>1||hM(e,t))},Pv=e=>tc(e)||Sr(e),bM=e=>Zt(e).exists(Pv),Dv=e=>re(jw(e.selection.getSelectedBlocks()),t=>!Pv(t)&&!bM(t)&&gM(t)),Bv=(e,t)=>{const{dom:n}=e,s=VN(e),o=/[a-z%]+$/i.exec(s)[0],r=parseInt(s,10),a=kp(e);B(Dv(e),i=>{pM(n,t,a,r,o,i.dom)})},CM=e=>Bv(e,"indent"),Ov=e=>Bv(e,"outdent"),$v=e=>{if(e.selection.isCollapsed()&&Tv(e)){const t=e.dom,n=e.selection.getRng(),s=N.fromRangeStart(n),o=t.getParent(n.startContainer,t.isBlock);if(o!==null&&Cu(C.fromDom(o),s))return d.some(()=>Ov(e))}return d.none()},Lv=(e,t,n)=>co([$v,_f,kf,(s,o)=>Lf(s,t,o),Ef,Du,Af,Mf,Sf,If],s=>s(e,n)),yM=(e,t)=>{Lv(e,t,!1).fold(()=>{ku(e),jb(e)},nr)},vM=(e,t)=>{Lv(e,t,!0).fold(()=>lP(e),nr)},EM=(e,t)=>{e.addCommand("delete",()=>{yM(e,t)}),e.addCommand("forwardDelete",()=>{vM(e,t)})},Iv=5,SM=400,Fv=e=>e.touches===void 0||e.touches.length!==1?d.none():d.some(e.touches[0]),wM=(e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>Iv||s>Iv},kM=e=>{const t=cs(),n=Qe(!1),s=bc(o=>{e.dispatch("longpress",{...o,type:"longpress"}),n.set(!0)},SM);e.on("touchstart",o=>{Fv(o).each(r=>{s.cancel();const a={x:r.clientX,y:r.clientY,target:o.target};s.throttle(o),n.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{s.cancel(),Fv(o).each(r=>{t.on(a=>{wM(r,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{s.cancel(),o.type!=="touchcancel"&&t.get().filter(r=>r.target.isEqualNode(o.target)).each(()=>{n.get()?o.preventDefault():e.dispatch("tap",{...o,type:"tap"})})},!0)},zf=(e,t)=>fe(e,t.nodeName),xM=(e,t)=>M(t)?!0:Z(t)?!zf(e,t)&&!jt(t):!1,NM=(e,t,n)=>Me(_b(C.fromDom(n),C.fromDom(t)),s=>zf(e,s.dom)),_M=(e,t)=>{if(M(t)){if(t.nodeValue.length===0)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||zf(e,t.nextSibling)))return!0}return!1},AM=e=>{const t=e.dom,n=e.selection,s=e.schema,o=s.getBlockElements();let r=n.getStart();const a=e.getBody();let i,l,c;const u=Rt(e);if(!r||!Z(r))return;const f=a.nodeName.toLowerCase();if(!s.isValidChild(f,u.toLowerCase())||NM(o,a,r))return;const m=n.getRng(),g=m.startContainer,h=m.startOffset,p=m.endContainer,b=m.endOffset,y=qs(e);for(r=a.firstChild;r;)if(xM(o,r)){if(_M(o,r)){l=r,r=r.nextSibling,t.remove(l);continue}i||(i=t.create(u,zs(e)),r.parentNode.insertBefore(i,r),c=!0),l=r,r=r.nextSibling,i.appendChild(l)}else i=null,r=r.nextSibling;c&&y&&(m.setStart(g,h),m.setEnd(p,b),n.setRng(m),e.nodeChanged())},RM=e=>{e.on("NodeChange",V(AM,e))},Mv=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,TM=(e,t,n)=>function(s){const o=arguments,r=o[o.length-2],a=r>0?t.charAt(r-1):"";if(a==='"')return s;if(a===">"){const i=t.lastIndexOf("<",r);if(i!==-1&&t.substring(i,r).indexOf('contenteditable="false"')!==-1)return s}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode(typeof o[1]=="string"?o[1]:o[0])+"</span>"},PM=(e,t,n)=>{let s=t.length,o=n.content;if(n.format!=="raw"){for(;s--;)o=o.replace(t[s],TM(e,o,Pp(e)));n.content=o}},DM=e=>{const t="contenteditable",n=" "+D.trim(P_(e))+" ",s=" "+D.trim(Pp(e))+" ",o=Mv(n),r=Mv(s),a=D_(e);a.length>0&&e.on("BeforeSetContent",i=>{PM(e,a,i)}),e.parser.addAttributeFilter("class",i=>{let l=i.length;for(;l--;){const c=i[l];o(c)?c.attr(t,"true"):r(c)&&c.attr(t,"false")}}),e.serializer.addAttributeFilter(t,i=>{let l=i.length;for(;l--;){const c=i[l];!o(c)&&!r(c)||(a.length>0&&c.attr("data-mce-content")?(c.name="#text",c.type=3,c.raw=!0,c.value=c.attr("data-mce-content")):c.attr(t,null))}})},BM=e=>Er(C.fromDom(e.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull(),Uv=(e,t)=>{t.hasAttribute("data-mce-caret")&&(oc(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},OM=(e,t)=>{const n=BM(e);if(!!n){if(t.type==="compositionstart"){t.preventDefault(),t.stopPropagation(),Uv(e,n);return}mg(n)&&(Uv(e,n),e.undoManager.add())}},$M=e=>{e.on("keyup compositionstart",V(OM,e))},zv=Oe,LM=(e,t,n)=>vv(t,e,n,ps,hs,zv),IM=(e,t,n)=>Ev(t,e,n,r=>ps(r)||xb(r),r=>hs(r)||Nb(r),zv),FM=e=>{const t=e.dom.create(Rt(e));return t.innerHTML='<br data-mce-bogus="1">',t},Hv=(e,t,n)=>{const s=Tn(e.getBody()),o=V(Bc,t===1?s.next:s.prev);if(n.collapsed){const r=e.dom.getParent(n.startContainer,"PRE");if(!r)return;if(!o(N.fromRangeStart(n))){const i=C.fromDom(FM(e));t===1?ss(C.fromDom(r),i):Jt(C.fromDom(r),i),e.selection.select(i.dom,!0),e.selection.collapse()}}},MM=(e,t)=>{const n=t?Ke.Forwards:Ke.Backwards,s=e.selection.getRng();return LM(n,e,s).orThunk(()=>(Hv(e,n,s),d.none()))},UM=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return IM(n,e,s).orThunk(()=>(Hv(e,n,s),d.none()))},Vv=(e,t)=>MM(e,t).exists(n=>(Xn(e,n),!0)),Wv=(e,t)=>UM(e,t).exists(n=>(Xn(e,n),!0)),jv=(e,t)=>Sv(e,t,t?hs:ps),qi=(e,t)=>xf(e,!t).map(n=>{const s=n.toRange(),o=e.selection.getRng();return t?s.setStart(o.startContainer,o.startOffset):s.setEnd(o.endContainer,o.endOffset),s}).exists(n=>(Xn(e,n),!0)),zM=e=>De(["figcaption"],Be(e)),HM=e=>{const t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t},VM=(e,t,n)=>{n?qe(e,t):Xm(e,t)},WM=(e,t,n,s)=>{const o=C.fromTag(n),r=C.fromTag("br");return Sn(o,s),qe(o,r),VM(e,o,t),HM(r)},jM=(e,t)=>{const n=V(Ae,t);return yo(C.fromDom(e.container()),sn,n).filter(zM)},qM=(e,t,n)=>t?LF(e.dom,n):$F(e.dom,n),KM=(e,t)=>{const n=C.fromDom(e.getBody()),s=N.fromRangeStart(e.selection.getRng()),o=Rt(e),r=zs(e);return jM(s,n).exists(()=>{if(qM(n,t,s)){const a=WM(n,t,o,r);return e.selection.setRng(a),!0}else return!1})},qv=(e,t)=>e.selection.isCollapsed()?KM(e,t):!1,Kv={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},GM=e=>Ee(e,t=>({...Kv,action:me,...t})),YM=e=>Ee(e,t=>({...Kv,action:()=>d.none(),...t})),Gv=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,XM=(e,t)=>Un(GM(e),n=>Gv(n,t)?[n]:[]),QM=(e,t)=>Un(YM(e),n=>Gv(n,t)?[n]:[]),ie=(e,...t)=>()=>e.apply(null,t),ia=(e,t)=>Ye(XM(e,t),n=>n.action()),Yv=(e,t)=>co(QM(e,t),n=>n.action()),Xv=(e,t)=>{const n=t?Ke.Forwards:Ke.Backwards,s=e.selection.getRng();return vv(e,n,s,Gr,Yr,Nn).exists(o=>(Xn(e,o),!0))},Qv=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return Ev(e,n,s,Gr,Yr,Nn).exists(o=>(Xn(e,o),!0))},Zv=(e,t)=>Sv(e,t,t?Yr:Gr),Jv=_n.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),la={...Jv,none:e=>Jv.none(e)},ZM=(e,t)=>eE(e,t,je),eE=(e,t,n)=>Un(at(e),s=>wn(s,t)?n(s)?[s]:[]:eE(s,t,n)),JM=(e,t,n=Le)=>{if(n(t))return d.none();if(De(e,Be(t)))return d.some(t);const s=o=>wn(o,"table")||n(o);return vr(t,e.join(","),s)},eU=(e,t)=>JM(["td","th"],e,t),tU=e=>ZM(e,"th,td"),tE=(e,t)=>Bs(e,"table",t),Hf=(e,t,n,s,o=je)=>{const r=s===1;if(!r&&n<=0)return la.first(e[0]);if(r&&n>=e.length-1)return la.last(e[e.length-1]);{const a=n+s,i=e[a];return o(i)?la.middle(t,i):Hf(e,t,a,s,o)}},nE=(e,t)=>tE(e,t).bind(n=>{const s=tU(n);return or(s,r=>Ae(e,r)).map(r=>({index:r,all:s}))}),nU=(e,t,n)=>nE(e,n).fold(()=>la.none(e),o=>Hf(o.all,e,o.index,1,t)),sU=(e,t,n)=>nE(e,n).fold(()=>la.none(),o=>Hf(o.all,e,o.index,-1,t)),oU=e=>Bs(e,"[contenteditable]"),sE=(e,t=!1)=>ho(e)?e.dom.isContentEditable:oU(e).fold(F(t),n=>rU(n)==="true"),rU=e=>e.dom.contentEditable,aU=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+t*2,bottom:e.bottom+t*2,width:e.width+t,height:e.height+t}),iU=(e,t)=>Un(t,n=>{const s=aU(Ms(n.getBoundingClientRect()),-1);return[{x:s.left,y:e(s),cell:n},{x:s.right,y:e(s),cell:n}]}),lU=(e,t,n)=>$t(e,(s,o)=>s.fold(()=>d.some(o),r=>{const a=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return d.some(i<a?o:r)}),d.none()),oE=(e,t,n,s,o)=>{const r=At(C.fromDom(n),"td,th,caption").map(i=>i.dom),a=re(iU(e,r),i=>t(i,o));return lU(a,s,o).map(i=>i.cell)},cU=e=>e.bottom,uU=e=>e.top,fU=(e,t)=>e.y<t,dU=(e,t)=>e.y>t,mU=V(oE,cU,fU),gU=V(oE,uU,dU),pU=(e,t)=>Lt(t.getClientRects()).bind(n=>mU(e,n.left,n.top)).bind(n=>Vi(FF(n),t)),hU=(e,t)=>lo(t.getClientRects()).bind(n=>gU(e,n.left,n.top)).bind(n=>Vi(IF(n),t)),bU=(e,t,n)=>n.breakAt.exists(s=>e(t,s).breakAt.isSome()),CU=e=>e.breakType===In.Wrap&&e.positions.length===0,yU=e=>e.breakType===In.Br&&e.positions.length===1,rE=(e,t,n)=>{const s=e(t,n);return CU(s)||!Ue(n.getNode())&&yU(s)?!bU(e,t,s):s.breakAt.isNone()},vU=V(rE,oa),EU=V(rE,ra),SU=(e,t,n)=>{const s=N.fromRangeStart(t);return Bo(!e,n).exists(o=>o.isEqual(s))},wU=(e,t,n,s)=>{const o=e.selection.getRng(),r=t?1:-1;return Mp()&&SU(t,o,n)?(Yn(r,e,n,!t,!1).each(a=>{Xn(e,a)}),!0):!1},kU=(e,t,n)=>pU(t,n).orThunk(()=>Lt(n.getClientRects()).bind(s=>Df(dv(e,N.before(t)),s.left))).getOr(N.before(t)),xU=(e,t,n)=>hU(t,n).orThunk(()=>Lt(n.getClientRects()).bind(s=>Df(mv(e,N.after(t)),s.left))).getOr(N.after(t)),aE=(e,t)=>{const n=t.getNode(e);return Z(n)&&n.nodeName==="TABLE"?d.some(n):d.none()},NU=(e,t,n)=>{const s=Rt(t);t.undoManager.transact(()=>{const o=C.fromTag(s);Sn(o,zs(t)),qe(o,C.fromTag("br")),e?ss(C.fromDom(n),o):Jt(C.fromDom(n),o);const r=t.dom.createRng();r.setStart(o.dom,0),r.setEnd(o.dom,0),Xn(t,r)})},iE=(e,t,n)=>{const s=aE(!!t,n),o=t===!1;s.fold(()=>Xn(e,n.toRange()),r=>Bo(o,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>Xn(e,n.toRange()),a=>NU(t,e,r)))},_U=(e,t,n,s)=>{const o=e.selection.getRng(),r=N.fromRangeStart(o),a=e.getBody();if(!t&&vU(s,r)){const i=kU(a,n,r);return iE(e,t,i),!0}else if(t&&EU(s,r)){const i=xU(a,n,r);return iE(e,t,i),!0}else return!1},lE=(e,t,n)=>d.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(s=>d.from(e.dom.getParent(s,"table")).map(o=>n(e,t,o,s))).getOr(!1),cE=(e,t)=>lE(e,t,wU),uE=(e,t)=>lE(e,t,_U),AU=e=>{const t=Fo.exact(e,0,e,0);return IR(t)},fE=(e,t,n)=>n.fold(d.none,d.none,(s,o)=>qT(o).map(r=>AU(r)),s=>(e.execCommand("mceTableInsertRowAfter"),dE(e,t,s))),dE=(e,t,n)=>fE(e,t,nU(n,sE)),RU=(e,t,n)=>fE(e,t,sU(n,sE)),mE=(e,t)=>{const n=["table","li","dl"],s=C.fromDom(e.getBody()),o=i=>{const l=Be(i);return Ae(i,s)||De(n,l)},r=e.selection.getRng(),a=C.fromDom(t?r.endContainer:r.startContainer);return eU(a,o).map(i=>(tE(i,o).each(u=>{e.model.table.clearSelectedCells(u.dom)}),e.selection.collapse(!t),(t?dE:RU)(e,o,i).each(u=>{e.selection.setRng(u)}),!0)).getOr(!1)},TU=(e,t,n)=>{const s=Se.os.isMacOS()||Se.os.isiOS();ia([{keyCode:G.RIGHT,action:ie(Vv,e,!0)},{keyCode:G.LEFT,action:ie(Vv,e,!1)},{keyCode:G.UP,action:ie(Wv,e,!1)},{keyCode:G.DOWN,action:ie(Wv,e,!0)},...s?[{keyCode:G.UP,action:ie(qi,e,!1),metaKey:!0,shiftKey:!0},{keyCode:G.DOWN,action:ie(qi,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:G.RIGHT,action:ie(cE,e,!0)},{keyCode:G.LEFT,action:ie(cE,e,!1)},{keyCode:G.UP,action:ie(uE,e,!1)},{keyCode:G.DOWN,action:ie(uE,e,!0)},{keyCode:G.RIGHT,action:ie(Xv,e,!0)},{keyCode:G.LEFT,action:ie(Xv,e,!1)},{keyCode:G.UP,action:ie(Qv,e,!1)},{keyCode:G.DOWN,action:ie(Qv,e,!0)},{keyCode:G.RIGHT,action:ie(xv,e,t,!0)},{keyCode:G.LEFT,action:ie(xv,e,t,!1)},{keyCode:G.RIGHT,ctrlKey:!s,altKey:s,action:ie(nM,e,t)},{keyCode:G.LEFT,ctrlKey:!s,altKey:s,action:ie(sM,e,t)},{keyCode:G.UP,action:ie(qv,e,!1)},{keyCode:G.DOWN,action:ie(qv,e,!0)}],n).each(o=>{n.preventDefault()})},PU=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()===!1&&TU(e,t,n)})},fn=(e,t)=>({container:e,offset:t}),Ki=Re.DOM,Gi=e=>t=>e===t?-1:0,DU=e=>t=>e.isBlock(t)||De(["BR","IMG","HR","INPUT"],t.nodeName)||e.getContentEditable(t)==="false",Vf=(e,t,n)=>{if(M(e)&&t>=0)return d.some(fn(e,t));{const s=Fs(Ki);return d.from(s.backwards(e,t,Gi(e),n)).map(o=>fn(o.container,o.container.data.length))}},BU=(e,t,n)=>{if(M(e)&&t>=e.length)return d.some(fn(e,t));{const s=Fs(Ki);return d.from(s.forwards(e,t,Gi(e),n)).map(o=>fn(o.container,0))}},Wf=(e,t,n)=>{if(!M(e))return d.none();const s=e.textContent;if(t>=0&&t<=s.length)return d.some(fn(e,t));{const o=Fs(Ki);return d.from(o.backwards(e,t,Gi(e),n)).bind(r=>{const a=r.container.data;return Wf(r.container,t+a.length,n)})}},gE=(e,t,n)=>{if(!M(e))return d.none();const s=e.textContent;if(t<=s.length)return d.some(fn(e,t));{const o=Fs(Ki);return d.from(o.forwards(e,t,Gi(e),n)).bind(r=>gE(r.container,t-s.length,n))}},jf=(e,t,n,s,o)=>{const r=Fs(e,DU(e));return d.from(r.backwards(t,n,s,o))},OU=e=>e.collapsed&&e.startContainer.nodeType===3,pE=e=>e.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,""),hE=e=>e!==""&&` \xA0\f
\r	\v`.indexOf(e)!==-1,qf=(e,t)=>e.substring(t.length),$U=(e,t,n)=>{let s;for(s=t-1;s>=0;s--){const o=e.charAt(s);if(hE(o))return d.none();if(o===n)break}return d.some(s)},LU=(e,t,n,s=0)=>{if(!OU(t))return d.none();const o=(a,i,l)=>$U(l,i,n).getOr(i),r=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return jf(e,t.startContainer,t.startOffset,o,r).bind(a=>{const i=t.cloneRange();if(i.setStart(a.container,a.offset),i.setEnd(t.endContainer,t.endOffset),i.collapsed)return d.none();const l=pE(i);return l.lastIndexOf(n)!==0||qf(l,n).length<s?d.none():d.some({text:qf(l,n),range:i,triggerChar:n})})},bE=(e,t,n,s=0)=>XT(C.fromDom(t.startContainer)).fold(()=>LU(e,t,n,s),o=>{const r=e.createRng();r.selectNode(o.dom);const a=pE(r);return d.some({range:r,text:qf(a,n),triggerChar:n})}),IU=e=>e.nodeType===xm,FU=e=>e.nodeType===fr,CE=e=>{if(IU(e))return fn(e,e.data.length);{const t=e.childNodes;return t.length>0?CE(t[t.length-1]):fn(e,t.length)}},yE=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?yE(n[t],0):n.length>0&&FU(e)&&n.length===t?CE(n[n.length-1]):fn(e,t)},MU=(e,t)=>{const n=e.getParent(t.container,e.isBlock);return jf(e,t.container,t.offset,(s,o)=>o===0?-1:o,n).filter(s=>{const o=s.container.data.charAt(s.offset-1);return!hE(o)}).isSome()},UU=e=>t=>{const n=yE(t.startContainer,t.startOffset);return!MU(e,n)},zU=(e,t,n)=>co(n.triggerChars,s=>bE(e,t,s)),HU=(e,t)=>{const n=t(),s=e.selection.getRng();return zU(e.dom,s,n).bind(o=>vE(e,t,o))},vE=(e,t,n,s={})=>{const o=t(),a=e.selection.getRng().startContainer.nodeValue,i=re(o.lookupByChar(n.triggerChar),c=>n.text.length>=c.minChars&&c.matches.getOrThunk(()=>UU(e.dom))(n.range,a,n.text));if(i.length===0)return d.none();const l=Promise.all(Ee(i,c=>c.fetch(n.text,c.maxResults,s).then(f=>({matchText:n.text,items:f,columns:c.columns,onAction:c.onAction,highlightOn:c.highlightOn}))));return d.some({lookupData:l,context:n})};var dn;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(dn||(dn={}));const Kf=(e,t,n)=>e.stype===dn.Error?t(e.serror):n(e.svalue),VU=e=>{const t=[],n=[];return B(e,s=>{Kf(s,o=>n.push(o),o=>t.push(o))}),{values:t,errors:n}},WU=(e,t)=>e.stype===dn.Error?{stype:dn.Error,serror:t(e.serror)}:e,jU=(e,t)=>e.stype===dn.Value?{stype:dn.Value,svalue:t(e.svalue)}:e,qU=(e,t)=>e.stype===dn.Value?t(e.svalue):e,KU=(e,t)=>e.stype===dn.Error?t(e.serror):e,EE=e=>({stype:dn.Value,svalue:e}),SE=e=>({stype:dn.Error,serror:e}),Je={fromResult:e=>e.fold(SE,EE),toResult:e=>Kf(e,Ct.error,Ct.value),svalue:EE,partition:VU,serror:SE,bind:qU,bindError:KU,map:jU,mapError:WU,fold:Kf},Gf=e=>Ot(e)&&Xt(e).length>100?" removed due to size":JSON.stringify(e,null,2),GU=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:F("... (only showing first ten failures)")}]):e;return Ee(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},Yi=(e,t)=>Je.serror([{path:e,getErrorInfo:t}]),YU=(e,t,n)=>Yi(e,()=>'Could not find valid *required* value for "'+t+'" in '+Gf(n)),XU=(e,t)=>Yi(e,()=>'Choice schema did not contain choice key: "'+t+'"'),QU=(e,t,n)=>Yi(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+Gf(t)),ZU=(e,t)=>Yi(e,F(t)),JU=(e,t,n,s)=>Te(n,s).fold(()=>QU(e,n,s),r=>r.extract(e.concat(["branch: "+s]),t)),ez=(e,t)=>({extract:(o,r)=>Te(r,e).fold(()=>XU(o,e),i=>JU(o,r,t,i)),toString:()=>"chooseOn("+e+"). Possible values: "+Xt(t)}),tz=(e,t)=>t,nz=(e,t)=>Md(e)&&Md(t)?Xi(e,t):t,wE=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const r in o)fe(o,r)&&(n[r]=e(n[r],o[r]))}return n},Xi=wE(nz),sz=wE(tz),kE=()=>({tag:"required",process:{}}),oz=e=>({tag:"defaultedThunk",process:e}),xE=e=>oz(F(e)),rz=()=>({tag:"option",process:{}}),az=(e,t)=>e.length>0?Je.svalue(Xi(t,sz.apply(void 0,e))):Je.svalue(t),NE=e=>ws(Je.serror,Wd)(e),iz={consolidateObj:(e,t)=>{const n=Je.partition(e);return n.errors.length>0?NE(n.errors):az(n.values,t)},consolidateArr:e=>{const t=Je.partition(e);return t.errors.length>0?NE(t.errors):Je.svalue(t.values)}},lz=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),cz=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),_E=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},Yf=e=>{const t=(s,o)=>Je.bindError(e(o),r=>ZU(s,r)),n=F("val");return{extract:t,toString:n}},uz=Yf(Je.svalue),fz=(e,t,n,s)=>Te(t,n).fold(()=>YU(e,n,t),s),AE=(e,t,n,s)=>{const o=Te(e,t).getOrThunk(()=>n(e));return s(o)},dz=(e,t,n)=>n(Te(e,t)),mz=(e,t,n,s)=>{const o=Te(e,t).map(r=>r===!0?n(e):r);return s(o)},gz=(e,t,n,s,o)=>{const r=i=>o.extract(t.concat([s]),i),a=i=>i.fold(()=>Je.svalue(d.none()),l=>{const c=o.extract(t.concat([s]),l);return Je.map(c,d.some)});switch(e.tag){case"required":return fz(t,n,s,r);case"defaultedThunk":return AE(n,s,e.process,r);case"option":return dz(n,s,a);case"defaultedOptionThunk":return mz(n,s,e.process,a);case"mergeWithThunk":return AE(n,s,F({}),i=>{const l=Xi(e.process(n),i);return r(l)})}},pz=(e,t,n)=>{const s={},o=[];for(const r of n)_E(r,(a,i,l,c)=>{const u=gz(l,e,t,a,c);Je.fold(u,f=>{o.push(...f)},f=>{s[i]=f})},(a,i)=>{s[a]=i(t)});return o.length>0?Je.serror(o):Je.svalue(s)},Xf=e=>({extract:(s,o)=>pz(s,o,e),toString:()=>{const s=Ee(e,o=>_E(o,(r,a,i,l)=>r+" -> "+l.toString(),(r,a)=>"state("+r+")"));return`obj{
`+s.join(`
`)+"}"}}),RE=e=>({extract:(s,o)=>{const r=Ee(o,(a,i)=>e.extract(s.concat(["["+i+"]"]),a));return iz.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),hz=e=>Yf(t=>e(t).fold(Je.serror,Je.svalue)),bz=(e,t,n)=>{const s=t.extract([e],n);return Je.mapError(s,o=>({input:n,errors:o}))},Cz=(e,t,n)=>Je.toResult(bz(e,t,n)),yz=e=>`Errors: 
`+GU(e.errors).join(`
`)+`

Input object: `+Gf(e.input),TE=(e,t)=>ez(e,ir(t,Xf)),vz=F(uz),Qi=(e,t)=>Yf(n=>{const s=typeof n;return e(n)?Je.svalue(n):Je.serror(`Expected type: ${t} but got: ${s}`)}),Ez=Qi(yn,"number"),Zi=Qi(ne,"string"),Sz=Qi(Ss,"boolean"),Qf=Qi(_e,"function"),ca=lz,PE=cz,wz=e=>hz(t=>De(e,t)?Ct.value(t):Ct.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),DE=(e,t)=>ca(e,e,kE(),t),BE=e=>DE(e,Zi),OE=e=>DE(e,Qf),kz=(e,t)=>ca(e,e,kE(),RE(t)),Zf=(e,t)=>ca(e,e,rz(),t),Ji=e=>Zf(e,Zi),xz=e=>Zf(e,Qf),Nz=(e,t)=>ca(e,e,xE(t),vz()),Ko=(e,t,n)=>ca(e,e,xE(t),n),$E=(e,t)=>Ko(e,t,Ez),_z=(e,t)=>Ko(e,t,Zi),LE=(e,t,n)=>Ko(e,t,wz(n)),Jf=(e,t)=>Ko(e,t,Sz),ed=(e,t)=>Ko(e,t,Qf),Az=(e,t,n)=>Ko(e,t,RE(n)),Rz=BE("type"),Tz=OE("fetch"),td=OE("onAction"),Pz=ed("onSetup",()=>me),Dz=Ji("text"),Bz=Ji("icon"),Oz=Ji("tooltip"),$z=Ji("label"),Lz=Jf("active",!1),Iz=Jf("enabled",!0),IE=Jf("primary",!1),Fz=e=>Nz("columns",e),ua=e=>_z("type",e),Mz=Xf([Rz,BE("ch"),$E("minChars",1),Fz(1),$E("maxResults",10),xz("matches"),Tz,td,Az("highlightOn",[],Zi)]),Uz=e=>Cz("Autocompleter",Mz,e),nd=[Iz,Oz,Bz,Dz,Pz],FE=[Lz].concat(nd),zz=[ed("predicate",Le),LE("scope","node",["node","editor"]),LE("position","selection",["node","selection","line"])],Hz=nd.concat([ua("contextformbutton"),IE,td,PE("original",bt)]),Vz=FE.concat([ua("contextformbutton"),IE,td,PE("original",bt)]),Wz=nd.concat([ua("contextformbutton")]),jz=FE.concat([ua("contextformtogglebutton")]),qz=TE("type",{contextformbutton:Hz,contextformtogglebutton:Vz});Xf([ua("contextform"),ed("initValue",F("")),$z,kz("commands",qz),Zf("launch",TE("type",{contextformbutton:Wz,contextformtogglebutton:jz}))].concat(zz));const Kz=e=>{const t=e.ui.registry.getAll().popups,n=ir(t,a=>Uz(a).fold(i=>{throw new Error(yz(i))},bt)),s=qd(Ol(n,a=>a.ch)),o=$l(n);return{dataset:n,triggerChars:s,lookupByChar:a=>re(o,i=>i.ch===a)}},Gz=(e,t)=>{const n=bc(t.load,50);e.on("keypress compositionend",s=>{s.which!==27&&n.throttle()}),e.on("keydown",s=>{const o=s.which;o===8?n.throttle():o===27&&t.cancelIfNecessary()}),e.on("remove",n.cancel)},Yz=e=>{const t=cs(),n=Qe(!1),s=t.isSet,o=()=>{s()&&(Y$(e),cR(e),n.set(!1),t.clear())},r=c=>{s()||(G$(e,c.range),t.set({triggerChar:c.triggerChar,matchLength:c.text.length}))},a=ks(()=>Kz(e)),i=c=>t.get().map(u=>bE(e.dom,e.selection.getRng(),u.triggerChar).bind(f=>vE(e,a,f,c))).getOrThunk(()=>HU(e,a)),l=c=>{i(c).fold(o,u=>{r(u.context),u.lookupData.then(f=>{t.get().map(m=>{const g=u.context;m.triggerChar===g.triggerChar&&(g.text.length-m.matchLength>=10?o():(t.set({...m,matchLength:g.text.length}),n.get()?lR(e,{lookupData:f}):(n.set(!0),iR(e,{lookupData:f}))))})})})};e.addCommand("mceAutocompleterReload",(c,u)=>{const f=Ot(u)?u.fetchOptions:{};l(f)}),e.addCommand("mceAutocompleterClose",o),Gz(e,{cancelIfNecessary:o,load:l})},ME=e=>(t,n,s={})=>{const o=t.getBody(),r={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:me,inputType:n},a=Ag(new InputEvent(e));return t.dispatch(e,{...a,...r,...s})},sd=ME("input"),od=ME("beforeinput"),Xz=(e,t,n)=>{const s=n.keyCode===G.BACKSPACE?"deleteContentBackward":"deleteContentForward";Yv([{keyCode:G.BACKSPACE,action:ie($v,e)},{keyCode:G.BACKSPACE,action:ie(_f,e,!1)},{keyCode:G.DELETE,action:ie(_f,e,!0)},{keyCode:G.BACKSPACE,action:ie(kf,e,!1)},{keyCode:G.DELETE,action:ie(kf,e,!0)},{keyCode:G.BACKSPACE,action:ie(Lf,e,t,!1)},{keyCode:G.DELETE,action:ie(Lf,e,t,!0)},{keyCode:G.BACKSPACE,action:ie(Du,e,!1)},{keyCode:G.DELETE,action:ie(Du,e,!0)},{keyCode:G.BACKSPACE,action:ie(Af,e,!1)},{keyCode:G.DELETE,action:ie(Af,e,!0)},{keyCode:G.BACKSPACE,action:ie(Mf,e,!1)},{keyCode:G.DELETE,action:ie(Mf,e,!0)},{keyCode:G.BACKSPACE,action:ie(Sf,e,!1)},{keyCode:G.DELETE,action:ie(Sf,e,!0)},{keyCode:G.BACKSPACE,action:ie(Ef,e,!1)},{keyCode:G.DELETE,action:ie(Ef,e,!0)},{keyCode:G.BACKSPACE,action:ie(If,e,!1)},{keyCode:G.DELETE,action:ie(If,e,!0)}],n).each(o=>{n.preventDefault(),od(e,s).isDefaultPrevented()||(o(),sd(e,s))})},Qz=(e,t)=>{ia([{keyCode:G.BACKSPACE,action:ie(Zy,e)},{keyCode:G.DELETE,action:ie(Zy,e)}],t)},Zz=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()===!1&&Xz(e,t,n)}),e.on("keyup",n=>{n.isDefaultPrevented()===!1&&Qz(e,n)})},Jz=e=>{for(;e;){if(e.nodeType===1||e.nodeType===3&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}},fa=(e,t)=>{let n,s=t;const o=e.dom,r=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const i=Jz(t.firstChild);i&&/^(UL|OL|DL)$/.test(i.nodeName)&&t.insertBefore(o.doc.createTextNode(it),t.firstChild)}const a=o.createRng();if(t.normalize(),t.hasChildNodes()){const i=new Ve(t,t);for(;n=i.current();){if(M(n)){a.setStart(n,0),a.setEnd(n,0);break}if(r[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}s=n,n=i.next()}n||(a.setStart(s,0),a.setEnd(s,0))}else Ue(t)?t.nextSibling&&o.isBlock(t.nextSibling)?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)):(a.setStart(t,0),a.setEnd(t,0));e.selection.setRng(a),qr(e,a)},e2=(e,t)=>{const n=e.getRoot();let s,o;for(s=t;s!==n&&e.getContentEditable(s)!=="false";)e.getContentEditable(s)==="true"&&(o=s),s=s.parentNode;return s!==n?o:n},rd=e=>d.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),t2=e=>rd(e).fold(F(""),t=>t.nodeName.toUpperCase()),n2=e=>rd(e).filter(t=>Sr(C.fromDom(t))).isSome(),s2=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,o2=e=>{var t;return((t=e.parentNode)===null||t===void 0?void 0:t.firstChild)===e},UE=(e,t)=>e&&e.parentNode&&e.parentNode.nodeName===t,zE=e=>e&&/^(OL|UL|LI)$/.test(e.nodeName),r2=e=>zE(e)&&zE(e.parentNode),el=e=>{const t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},tl=(e,t,n)=>{let s=e[n?"firstChild":"lastChild"];for(;s&&!Z(s);)s=s[n?"nextSibling":"previousSibling"];return s===t},a2=(e,t,n,s,o)=>{const r=e.dom,a=e.selection.getRng();if(n===e.getBody())return;r2(n)&&(o="LI");let i=t(o);if(tl(n,s,!0)&&tl(n,s,!1))if(UE(n,"LI")){const l=el(n);r.insertAfter(i,l),o2(n)?r.remove(l):r.remove(n)}else r.replace(i,n);else if(tl(n,s,!0))UE(n,"LI")?(r.insertAfter(i,el(n)),i.appendChild(r.doc.createTextNode(" ")),i.appendChild(n)):n.parentNode.insertBefore(i,n),r.remove(s);else if(tl(n,s,!1))r.insertAfter(i,el(n)),r.remove(s);else{n=el(n);const l=a.cloneRange();l.setStartAfter(s),l.setEndAfter(n);const c=l.extractContents();o==="LI"&&s2(c,"LI")?(i=c.firstChild,r.insertAfter(c,n)):(r.insertAfter(c,n),r.insertAfter(i,n)),r.remove(s)}fa(e,i)},i2=e=>{B(Dg(C.fromDom(e),Ut),t=>{const n=t.dom;n.nodeValue=rs(n.nodeValue)})},l2=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),c2=e=>e&&/^(TD|TH|CAPTION)$/.test(e.nodeName),ad=e=>{e.innerHTML='<br data-mce-bogus="1">'},id=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,HE=(e,t)=>t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.getContentEditable(t)!=="true",u2=(e,t,n)=>{let s=n;const o=[];let r;if(!!s){for(;s=s.firstChild;){if(e.isBlock(s))return;Z(s)&&!t[s.nodeName.toLowerCase()]&&o.push(s)}for(r=o.length;r--;)s=o[r],(!s.hasChildNodes()||s.firstChild===s.lastChild&&s.firstChild.nodeValue===""||l2(e,s))&&e.remove(s)}},ld=(e,t,n)=>M(t)===!1?n:e?n===1&&t.data.charAt(n-1)===tt?0:n:n===t.data.length-1&&t.data.charAt(n)===tt?t.data.length:n,f2=e=>{const t=e.cloneRange();return t.setStart(e.startContainer,ld(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,ld(!1,e.endContainer,e.endOffset)),t},d2=e=>{do M(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild;while(e)},VE=(e,t)=>{const n=e.getRoot();let s,o;for(s=t;s!==n&&e.getContentEditable(s)!=="false";)e.getContentEditable(s)==="true"&&(o=s),s=s.parentNode;return s!==n?o:n},m2=(e,t,n)=>{const s=e.dom;d.from(n.style).map(s.parseStyle).each(l=>{const u={...Gm(C.fromDom(t)),...l};s.setStyles(t,u)});const o=d.from(n.class).map(l=>l.split(/\s+/)),r=d.from(t.className).map(l=>re(l.split(/\s+/),c=>c!==""));_t(o,r,(l,c)=>{const u=re(c,m=>!De(l,m)),f=[...l,...u];s.setAttrib(t,"class",f.join(" "))});const a=["style","class"],i=lr(n,(l,c)=>!De(a,c));s.setAttribs(t,i)},da=(e,t)=>{if(Rt(e).toLowerCase()===t.tagName.toLowerCase()){const s=zs(e);m2(e,t,s)}},g2=(e,t,n,s,o)=>{let r,a,i,l,c,u;const f=e.dom,m=VE(f,s);if(a=f.getParent(s,f.isBlock),!a||!HE(f,a)){if(a=a||m,a===e.getBody()||c2(a)?u=a.nodeName.toLowerCase():u=a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return r=f.create(t),da(e,r),a.appendChild(r),n.setStart(r,0),n.setEnd(r,0),r;for(l=s;l.parentNode!==a;)l=l.parentNode;for(;l&&!f.isBlock(l);)i=l,l=l.previousSibling;if(i&&e.schema.isValidChild(u,t.toLowerCase())){for(r=f.create(t),da(e,r),i.parentNode.insertBefore(r,i),l=i;l&&!f.isBlock(l);)c=l.nextSibling,r.appendChild(l),l=c;n.setStart(s,o),n.setEnd(s,o)}}return s},p2=(e,t)=>{t.normalize();const n=t.lastChild;(!n||/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},h2=(e,t)=>{const n=ON(e);return xt(t)?!1:ne(n)?De(D.explode(n),t.nodeName.toLowerCase()):n},WE={insert:(e,t)=>{let n,s,o,r,a,i,l,c,u;const f=e.dom,m=e.schema,g=m.getNonEmptyElements(),h=e.selection.getRng(),p=Rt(e),b=A=>{let T=s,$,L,Q;const q=m.getTextInlineElements();if(A||c==="TABLE"||c==="HR"?$=f.create(A||p):$=r.cloneNode(!1),Q=$,BN(e)===!1)f.setAttrib($,"style",null),f.setAttrib($,"class",null);else do if(q[T.nodeName]){if(Dn(T)||jt(T))continue;L=T.cloneNode(!1),f.setAttrib(L,"id",""),$.hasChildNodes()?(L.appendChild($.firstChild),$.appendChild(L)):(Q=L,$.appendChild(L))}while((T=T.parentNode)&&T!==_);return da(e,$),ad(Q),$},y=A=>{let T,$;const L=ld(A,s,o);if(M(s)&&(A?L>0:L<s.nodeValue.length))return!1;if(s.parentNode===r&&u&&!A||A&&Z(s)&&s===r.firstChild)return!0;if(id(s,"TABLE")||id(s,"HR"))return u&&!A||!u&&A;const Q=new Ve(s,r);for(M(s)&&(A&&L===0?Q.prev():!A&&L===s.nodeValue.length&&Q.next());T=Q.current();){if(Z(T)){if(!T.getAttribute("data-mce-bogus")&&($=T.nodeName.toLowerCase(),g[$]&&$!=="br"))return!1}else if(M(T)&&!Os(T.nodeValue))return!1;A?Q.prev():Q.next()}return!0},E=()=>{/^(H[1-6]|PRE|FIGURE)$/.test(c)&&j!=="HGROUP"?a=b(p):a=b(),h2(e,l)&&HE(f,l)&&f.isEmpty(r)?a=f.split(l,r):f.insertAfter(a,r),fa(e,a)};ci(f,h).each(A=>{h.setStart(A.startContainer,A.startOffset),h.setEnd(A.endContainer,A.endOffset)}),s=h.startContainer,o=h.startOffset;const S=!!(t&&t.shiftKey),x=!!(t&&t.ctrlKey);Z(s)&&s.hasChildNodes()&&(u=o>s.childNodes.length-1,s=s.childNodes[Math.min(o,s.childNodes.length-1)]||s,u&&M(s)?o=s.nodeValue.length:o=0);const _=VE(f,s);if(!_)return;S||(s=g2(e,p,h,s,o)),r=f.getParent(s,f.isBlock),l=r?f.getParent(r.parentNode,f.isBlock):null,c=r?r.nodeName.toUpperCase():"";const j=l?l.nodeName.toUpperCase():"";if(j==="LI"&&!x&&(r=l,l=l.parentNode,c=j),/^(LI|DT|DD)$/.test(c)&&f.isEmpty(r)){a2(e,b,l,r,p);return}r!==e.getBody()&&(So(r)?(a=oc(r),f.isEmpty(r)&&ad(r),da(e,a),fa(e,a)):y()?E():y(!0)?(a=r.parentNode.insertBefore(b(),r),fa(e,id(r,"HR")?a:r)):(n=f2(h).cloneRange(),n.setEndAfter(r),i=n.extractContents(),i2(i),d2(i),a=i.firstChild,f.insertAfter(i,r),u2(f,g,a),p2(f,r),f.isEmpty(r)&&ad(r),a.normalize(),f.isEmpty(a)?(f.remove(a),E()):(da(e,a),fa(e,a))),f.setAttrib(a,"id",""),e.dispatch("NewBlock",{newBlock:a}))},fakeEventName:"insertParagraph"},b2=(e,t,n)=>{const s=new Ve(t,n);let o;const r=e.getNonEmptyElements();for(;o=s.next();)if(r[o.nodeName.toLowerCase()]||o.length>0)return!0},jE=(e,t,n)=>{const s=e.dom.createRng();n?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)),e.selection.setRng(s),qr(e,s)},C2=(e,t)=>{const n=e.selection,s=e.dom,o=n.getRng();let r,a;ci(s,o).each(g=>{o.setStart(g.startContainer,g.startOffset),o.setEnd(g.endContainer,g.endOffset)});let i=o.startOffset,l=o.startContainer;if(l.nodeType===1&&l.hasChildNodes()){const g=i>l.childNodes.length-1;l=l.childNodes[Math.min(i,l.childNodes.length-1)]||l,g&&l.nodeType===3?i=l.nodeValue.length:i=0}let c=s.getParent(l,s.isBlock);const u=c?s.getParent(c.parentNode,s.isBlock):null,f=u?u.nodeName.toUpperCase():"",m=!!(t&&t.ctrlKey);f==="LI"&&!m&&(c=u),l&&l.nodeType===3&&i>=l.nodeValue.length&&(b2(e.schema,l,c)||(r=s.create("br"),o.insertNode(r),o.setStartAfter(r),o.setEndAfter(r),a=!0)),r=s.create("br"),Sc(s,o,r),jE(e,r,a),e.undoManager.add()},y2=(e,t)=>{const n=C.fromTag("br");Jt(C.fromDom(t),n),e.undoManager.add()},v2=(e,t)=>{S2(e.getBody(),t)||ss(C.fromDom(t),C.fromTag("br"));const n=C.fromTag("br");ss(C.fromDom(t),n),jE(e,n.dom,!1),e.undoManager.add()},E2=e=>Ue(e.getNode()),S2=(e,t)=>E2(N.after(t))?!0:Wt(e,N.after(t)).map(n=>Ue(n.getNode())).getOr(!1),qE=e=>e&&e.nodeName==="A"&&"href"in e,w2=e=>e.fold(Le,qE,qE,Le),k2=e=>{const t=V(Ys,e),n=N.fromRangeStart(e.selection.getRng());return Ln(t,e.getBody(),n).filter(w2)},x2=(e,t)=>{t.fold(me,V(y2,e),V(v2,e),me)},KE={insert:(e,t)=>{const n=k2(e);n.isSome()?n.each(V(x2,e)):C2(e,t)},fakeEventName:"insertLineBreak"},GE=(e,t)=>rd(e).filter(n=>t.length>0&&wn(C.fromDom(n),t)).isSome(),N2=e=>GE(e,PN(e)),_2=e=>GE(e,DN(e)),nn=_n.generate([{br:[]},{block:[]},{none:[]}]),A2=(e,t)=>_2(e),YE=e=>(t,n)=>n2(t)===e,XE=(e,t)=>(n,s)=>t2(n)===e.toUpperCase()===t,nl=e=>XE("pre",e),R2=()=>XE("summary",!0),sl=e=>(t,n)=>RN(t)===e,T2=(e,t)=>N2(e),ol=(e,t)=>t,P2=e=>{const t=Rt(e),n=e2(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t)},mn=(e,t)=>(n,s)=>$t(e,(r,a)=>r&&a(n,s),!0)?d.some(t):d.none(),D2=(e,t)=>ov([mn([A2],nn.none()),mn([R2()],nn.br()),mn([nl(!0),sl(!1),ol],nn.br()),mn([nl(!0),sl(!1)],nn.block()),mn([nl(!0),sl(!0),ol],nn.block()),mn([nl(!0),sl(!0)],nn.br()),mn([YE(!0),ol],nn.br()),mn([YE(!0)],nn.block()),mn([T2],nn.br()),mn([ol],nn.br()),mn([P2],nn.block())],[e,!!(t&&t.shiftKey)]).getOr(nn.none()),rl=(e,t,n)=>{t.selection.isCollapsed()||ku(t),!(oe(n)&&od(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,n),oe(n)&&sd(t,e.fakeEventName))},QE=(e,t)=>{const n=()=>rl(KE,e,t),s=()=>rl(WE,e,t),o=D2(e,t);switch(TN(e)){case"linebreak":o.fold(n,n,me);break;case"block":o.fold(s,s,me);break;case"invert":o.fold(s,n,me);break;default:o.fold(n,s,me);break}},B2=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),a$(e.undoManager),e.undoManager.transact(()=>{QE(e,t)}))},O2=e=>{e.on("keydown",t=>{t.keyCode===G.ENTER&&B2(e,t)})},$2=(e,t,n)=>{const s=Se.os.isMacOS()||Se.os.isiOS();ia([{keyCode:G.END,action:ie(jv,e,!0)},{keyCode:G.HOME,action:ie(jv,e,!1)},...s?[]:[{keyCode:G.HOME,action:ie(qi,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:G.END,action:ie(qi,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:G.END,action:ie(Zv,e,!0)},{keyCode:G.HOME,action:ie(Zv,e,!1)},{keyCode:G.END,action:ie(ji,e,!0,t)},{keyCode:G.HOME,action:ie(ji,e,!1,t)}],n).each(o=>{n.preventDefault()})},L2=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()===!1&&$2(e,t,n)})},I2=e=>{e.on("input",t=>{t.isComposing===!1&&U1(e)})},F2=xs(),M2=(e,t,n)=>{ia([{keyCode:G.PAGE_UP,action:ie(ji,e,!1,t)},{keyCode:G.PAGE_DOWN,action:ie(ji,e,!0,t)}],n)},ZE=e=>e.stopImmediatePropagation(),JE=e=>e.keyCode===G.PAGE_UP||e.keyCode===G.PAGE_DOWN,eS=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",ZE,!0):!n&&e.get()&&t.off("NodeChange",ZE),e.set(n)},U2=(e,t)=>{if(F2.os.isMacOS())return;const n=Qe(!1);e.on("keydown",s=>{JE(s)&&eS(n,e,!0)}),e.on("keyup",s=>{s.isDefaultPrevented()===!1&&M2(e,t,s),JE(s)&&n.get()&&(eS(n,e,!1),e.nodeChanged())})},tS=(e,t)=>{const n=t.container(),s=t.offset();return M(n)?(n.insertData(s,e),d.some(N(n,s+e.length))):Ga(t).map(o=>{const r=C.fromText(e);return t.isAtEnd()?ss(o,r):Jt(o,r),N(r.dom,e.length)})},z2=V(tS,it),H2=V(tS," "),V2=e=>t=>t.fold(n=>an(e.dom,N.before(n)),n=>yt(n),n=>Pn(n),n=>Wt(e.dom,N.after(n))),W2=(e,t)=>n=>D1(e,n)?z2(t):H2(t),j2=e=>t=>(e.selection.setRng(t.toRange()),e.nodeChanged(),!0),q2=e=>{const t=N.fromRangeStart(e.selection.getRng()),n=C.fromDom(e.getBody());if(e.selection.isCollapsed()){const s=V(Ys,e),o=N.fromRangeStart(e.selection.getRng());return Ln(s,e.getBody(),o).bind(V2(n)).map(r=>()=>W2(n,t)(r).each(j2(e)))}else return d.none()},K2=(e,t)=>{Yv([{keyCode:G.SPACEBAR,action:ie(q2,e)}],t).each(n=>{t.preventDefault(),od(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),sd(e,"insertText",{data:" "}))})},G2=e=>{e.on("keydown",t=>{t.isDefaultPrevented()===!1&&K2(e,t)})},Y2=e=>L_(e)?[{keyCode:G.TAB,action:ie(mE,e,!0)},{keyCode:G.TAB,shiftKey:!0,action:ie(mE,e,!1)}]:[],X2=(e,t)=>{ia([...Y2(e)],t).each(n=>{t.preventDefault()})},Q2=e=>{e.on("keydown",t=>{t.isDefaultPrevented()===!1&&X2(e,t)})},Z2=e=>{if(e.addShortcut("Meta+P","","mcePrint"),Yz(e),Gn(e))return Qe(null);{const t=tM(e);return $M(e),PU(e,t),Zz(e,t),O2(e),G2(e),I2(e),Q2(e),L2(e,t),U2(e,t),t}};class J2{constructor(t){this.lastPath=[],this.editor=t;let n;const s=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",o=>{const r=t.selection.getRng(),a={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};(o.type==="nodechange"||!nu(a,n))&&t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{const o=t.selection.getStart(!0);!o||ri(t)&&!s.isSameElementPath(o)&&t.dom.isChildOf(o,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",o=>{!o.isDefaultPrevented()&&ri(t)&&(t.selection.getNode().nodeName==="IMG"?qt.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t){const n=this.editor.selection;let s,o,r;this.editor.initialized&&n&&!l_(this.editor)&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),s=n.getStart(!0)||r,(s.ownerDocument!==this.editor.getDoc()||!this.editor.dom.isChildOf(s,r))&&(s=r),o=[],this.editor.dom.getParent(s,a=>{if(a===r)return!0;o.push(a)}),t=t||{},t.element=s,t.parents=o,this.editor.dispatch("NodeChange",t))}isSameElementPath(t){let n;const s=this.editor,o=rr(s.dom.getParents(t,je,s.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=o,!0}return this.lastPath=o,!1}}const nS="x-tinymce/html",al=F(nS),cd="<!-- "+nS+" -->",eH=e=>cd+e,tH=e=>e.replace(cd,""),sS=e=>e.indexOf(cd)!==-1,nH=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),sH=(e,t)=>{let n="<"+e;const s=Ol(t,(o,r)=>r+'="'+as.encodeAllRaw(o)+'"');return s.length&&(n+=" "+s.join(" ")),n+">"},oH=(e,t,n)=>{const s=e.split(/\n\n/),o=sH(t,n),r="</"+t+">",a=Ee(s,l=>l.split(/\n/).join("<br />")),i=l=>o+l+r;return a.length===1?a[0]:Ee(a,i).join("")},oS="%MCEPASTEBIN%",rH=(e,t)=>{const{dom:n,selection:s}=e,o=e.getBody();t.set(s.getRng());const r=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},oS);Se.browser.isFirefox()&&n.setStyle(r,"left",n.getStyle(o,"direction",!0)==="rtl"?65535:-65535),n.bind(r,"beforedeactivate focusin focusout",a=>{a.stopPropagation()}),r.focus(),s.select(r,!0)},aH=(e,t)=>{const n=e.dom;if(ud(e)){let s;const o=t.get();for(;s=ud(e);)n.remove(s),n.unbind(s);o&&e.selection.setRng(o)}t.set(null)},ud=e=>e.dom.get("mcepastebin"),iH=e=>e&&e.id==="mcepastebin",lH=e=>{const t=e.dom,n=(a,i)=>{a.appendChild(i),t.remove(i,!0)},[s,...o]=re(e.getBody().childNodes,iH);B(o,a=>{n(s,a)});const r=t.select("div[id=mcepastebin]",s);for(let a=r.length-1;a>=0;a--){const i=t.create("div");s.insertBefore(i,r[a]),n(i,r[a])}return s?s.innerHTML:""},rS=e=>e===oS,cH=e=>{const t=Qe(null);return{create:()=>rH(e,t),remove:()=>aH(e,t),getEl:()=>ud(e),getHtml:()=>lH(e),getLastRng:t.get}},aS=(e,t)=>(D.each(t,n=>{ba(n,RegExp)?e=e.replace(n,""):e=e.replace(n[0],n[1])}),e),uH=e=>{const t=ls(),n=Ho({},t);let s="";const o=t.getVoidElements(),r=D.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=l=>{const c=l.name,u=l;if(c==="br"){s+=`
`;return}if(c!=="wbr"){if(o[c]&&(s+=" "),r[c]){s+=" ";return}if(l.type===3&&(s+=l.value),!(l.name in t.getVoidElements())&&(l=l.firstChild))do i(l);while(l=l.next);a[c]&&u.next&&(s+=`
`,c==="p"&&(s+=`
`))}};return e=aS(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),s},iS=e=>(e=aS(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(n,s,o)=>!s&&!o?" ":it],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e),fH=e=>{let t=0;return()=>e+t++},dH=e=>{const t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return D.hasOwn(n,t)?"image/"+n[t]:"image/"+t},mH=(e,t)=>{const n=Ho({},e.schema);n.addNodeFilter("meta",o=>{D.each(o,r=>{r.remove()})});const s=n.parse(t,{forced_root_block:!1,isRootContent:!0});return ms({validate:!0},e.schema).serialize(s)},lS=(e,t)=>({content:e,cancelled:t}),gH=(e,t,n)=>{const s=e.dom.create("div",{style:"display:none"},t),o=fR(e,s,n);return lS(o.node.innerHTML,o.isDefaultPrevented())},pH=(e,t,n)=>{const s=uR(e,t,n),o=mH(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?gH(e,o,n):lS(o,s.isDefaultPrevented())},hH=(e,t,n)=>pH(e,t,n),fd=(e,t)=>(e.insertContent(t,{merge:N_(e),paste:!0}),!0),dd=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),bH=(e,t)=>dd(t)&&Me(Dp(e),n=>Zd(t.toLowerCase(),`.${n.toLowerCase()}`)),CH=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),yH=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),vH=(e,t,n)=>!e.selection.isCollapsed()&&dd(t)?yH(e,t,n):!1,EH=(e,t,n)=>bH(e,t)?CH(e,t,n):!1,SH=(e,t)=>{D.each([vH,EH,fd],n=>n(e,t,fd)!==!0)},wH=(e,t,n)=>{n||!__(e)?fd(e,t):SH(e,t)},kH=fH("mceclip"),cS=(e,t,n,s)=>{const o=hH(e,t,n);o.cancelled===!1&&wH(e,o.content,s)},il=(e,t,n)=>{const s=n||sS(t);cS(e,tH(t),s,!1)},md=(e,t)=>{const n=e.dom.encode(t).replace(/\r\n/g,`
`),s=yg(n,R_(e)),o=oH(s,Rt(e),zs(e));cS(e,o,!1,!0)},uS=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const s=e.types[n];try{t[s]=e.getData(s)}catch{t[s]=""}}return t},Go=(e,t)=>t in e&&e[t].length>0,fS=e=>Go(e,"text/html")||Go(e,"text/plain"),xH=(e,t)=>{const n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return oe(n)?e.dom.encode(n[1]):null},NH=(e,t,n,s)=>{const o=kH(),r=Ep(e)&&oe(n.name),a=r?xH(e,n.name):o,i=r?n.name:void 0,l=t.create(o,n,s,a,i);return t.add(l),l},_H=(e,t)=>{lf(t.uri).each(({data:n,type:s,base64Encoded:o})=>{const r=o?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,l=i.getByData(r,s),c=l!=null?l:NH(e,i,a,r);il(e,`<img src="${c.blobUri()}">`,!1)})},AH=e=>e.type==="paste",RH=e=>Promise.all(Ee(e,t=>KC(t).then(n=>({file:t,uri:n})))),TH=e=>{const t=Dp(e);return n=>st(n.type,"image/")&&Me(t,s=>dH(s)===n.type)},PH=(e,t)=>{const n=t.items?Un(Nt(t.items),o=>o.kind==="file"?[o.getAsFile()]:[]):[],s=t.files?Nt(t.files):[];return re(n.length>0?n:s,TH(e))},dS=(e,t,n)=>{const s=AH(t)?t.clipboardData:t.dataTransfer;if(qa(e)&&s){const o=PH(e,s);if(o.length>0)return t.preventDefault(),RH(o).then(r=>{n&&e.selection.setRng(n),B(r,a=>{_H(e,a)})}),!0}return!1},DH=e=>{var t,n;return Se.os.isAndroid()&&((n=(t=e.clipboardData)===null||t===void 0?void 0:t.items)===null||n===void 0?void 0:n.length)===0},BH=e=>G.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45,mS=(e,t,n,s)=>{let o=iS(n);const r=Go(t,al())||sS(n),a=!r&&nH(o),i=dd(o);(rS(o)||!o.length||a&&!i)&&(s=!0),(s||i)&&(Go(t,"text/plain")&&a?o=t["text/plain"]:o=uH(o)),!rS(o)&&(s?md(e,o):il(e,o,r))},OH=(e,t,n)=>{let s;const o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",r=>{BH(r)&&!r.isDefaultPrevented()&&(s=r.shiftKey&&r.keyCode===86)}),e.on("paste",r=>{if(r.isDefaultPrevented()||DH(r))return;const a=n.get()==="text"||s;s=!1;const i=uS(r.clipboardData);!fS(i)&&dS(e,r,o())||(Go(i,"text/html")?(r.preventDefault(),mS(e,i,i["text/html"],a)):(t.create(),qt.setEditorTimeout(e,()=>{const l=t.getHtml();t.remove(),mS(e,i,l,a)},0)))})},$H=e=>{const t=o=>st(o,"webkit-fake-url"),n=o=>st(o,"data:"),s=o=>{var r;return((r=o.data)===null||r===void 0?void 0:r.paste)===!0};e.parser.addNodeFilter("img",(o,r,a)=>{if(!qa(e)&&s(a))for(const i of o){const l=i.attr("src");ne(l)&&!i.attr("data-mce-object")&&l!==Se.transparentSrc&&(t(l)||!T_(e)&&n(l))&&i.remove()}})},LH=(e,t,n)=>{OH(e,t,n),$H(e)},IH=(e,t)=>{t.get()==="text"?(t.set("html"),Oh(e,!1)):(t.set("text"),Oh(e,!0)),e.focus()},FH=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{IH(e,t)}),e.addCommand("mceInsertClipboardContent",(n,s)=>{s.html&&il(e,s.html,s.internal),s.text&&md(e,s.text)})},MH=(e,t,n)=>{try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(al(),t),!0}catch{return!1}},gS=(e,t,n,s)=>{MH(e.clipboardData,t.html,t.text)?(e.preventDefault(),s()):n(t.html,s)},pS=e=>(t,n)=>{const{dom:s,selection:o}=e,r=s.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=s.create("div",{contenteditable:"true"},t);s.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(a),s.add(e.getBody(),r);const i=o.getRng();a.focus();const l=s.createRng();l.selectNodeContents(a),o.setRng(l),qt.setEditorTimeout(e,()=>{o.setRng(i),s.remove(r),n()},0)},hS=e=>({html:eH(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),UH=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),bS=e=>!e.selection.isCollapsed()||UH(e),zH=e=>t=>{!t.isDefaultPrevented()&&bS(e)&&gS(t,hS(e),pS(e),()=>{if(Se.browser.isChromium()||Se.browser.isFirefox()){const n=e.selection.getRng();qt.setEditorTimeout(e,()=>{e.selection.setRng(n),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},HH=e=>t=>{!t.isDefaultPrevented()&&bS(e)&&gS(t,hS(e),pS(e),me)},VH=e=>{e.on("cut",zH(e)),e.on("copy",HH(e))},CS=(e,t)=>{var n,s;return Mo.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(s=t.clientY)!==null&&s!==void 0?s:0,e.getDoc())},WH=e=>{const t=e["text/plain"];return t?t.indexOf("file://")===0:!1},yS=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},jH=e=>Me(e.files,t=>/^image\//.test(t.type)),qH=(e,t)=>{E_(e)&&e.on("dragend dragover draggesture dragdrop drop drag",n=>{n.preventDefault(),n.stopPropagation()}),qa(e)||e.on("drop",n=>{const s=n.dataTransfer;s&&jH(s)&&n.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented()||t.get())return;const s=CS(e,n);if(xt(s))return;const o=uS(n.dataTransfer),r=Go(o,al());if((!fS(o)||WH(o))&&dS(e,n,s))return;const a=o[al()],i=a||o["text/html"]||o["text/plain"];i&&(n.preventDefault(),qt.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{a&&e.execCommand("Delete"),yS(e,s);const l=iS(i);o["text/html"]?il(e,l,r):md(e,l)})}))}),e.on("dragstart",n=>{t.set(!0)}),e.on("dragover dragend",n=>{qa(e)&&t.get()===!1&&(n.preventDefault(),yS(e,CS(e,n))),n.type==="dragend"&&t.set(!1)})},KH=e=>{const t=o=>r=>{o(e,r)},n=S_(e);_e(n)&&e.on("PastePreProcess",t(n));const s=w_(e);_e(s)&&e.on("PastePostProcess",t(s))},GH=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},YH=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,vS=e=>D.trim(e).replace(YH,ei).toLowerCase(),XH=(e,t,n)=>{const s=k_(e);if(n||s==="all"||!x_(e))return t;const o=s?s.split(/[, ]/):[];if(o&&s!=="none"){const r=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,u)=>{const f=r.parseStyle(r.decode(c)),m={};for(let h=0;h<o.length;h++){const p=f[o[h]];let b=p,y=r.getStyle(a,o[h],!0);/color/.test(o[h])&&(b=vS(b),y=vS(y)),y!==b&&(m[o[h]]=p)}const g=r.serializeStyle(m,"span");return g?l+' style="'+g+'"'+u:l+u})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(r,a,i,l)=>a+' style="'+i+'"'+l),t},QH=e=>{(Se.browser.isChromium()||Se.browser.isSafari())&&GH(e,XH)},ZH=e=>{const t=Qe(!1),n=Qe(A_(e)?"text":"html"),s=cH(e);QH(e),FH(e,n),KH(e),e.on("PreInit",()=>{VH(e),qH(e,t),LH(e,s,n)})},JH=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},e3=e=>{e.parser.addNodeFilter("details",t=>{B(t,n=>{n.attr("data-mce-open",n.attr("open")),n.attr("open","open")})}),e.serializer.addNodeFilter("details",t=>{B(t,n=>{const s=n.attr("data-mce-open");n.attr("open",ne(s)?s:null),n.attr("data-mce-open",null)})})},t3=e=>{JH(e),e3(e)},n3=Ue,ES=M,s3=e=>Oe(e.dom),o3=e=>xn(e.dom),SS=e=>t=>Ae(C.fromDom(e),t),r3=(e,t)=>yo(C.fromDom(e),n=>o3(n)||sn(n),SS(t)).getOr(C.fromDom(t)).dom,wS=(e,t)=>yo(C.fromDom(e),s3,SS(t)),kS=(e,t,n)=>{const s=new Ve(e,t),o=n?s.next.bind(s):s.prev.bind(s);let r=e;for(let a=n?e:o();a&&!n3(a);a=o())tn(a)&&(r=a);return r},a3=(e,t)=>{const s=N.fromRangeStart(e).getNode(),o=r3(s,t),r=kS(s,o,!1),a=kS(s,o,!0),i=document.createRange();return wS(r,o).fold(()=>{ES(r)?i.setStart(r,0):i.setStartBefore(r)},l=>i.setStartBefore(l.dom)),wS(a,o).fold(()=>{ES(a)?i.setEnd(a,a.data.length):i.setEndAfter(a)},l=>i.setEndAfter(l.dom)),i},i3=e=>{const t=a3(e.selection.getRng(),e.getBody());e.selection.setRng(Iu(t))},l3=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),i3(e))})};var ma;(function(e){e.Before="before",e.After="after"})(ma||(ma={}));const c3=(e,t)=>Math.abs(e.left-t),u3=(e,t)=>Math.abs(e.right-t),f3=(e,t)=>e>=t.top&&e<=t.bottom,d3=(e,t)=>e.top<t.bottom&&e.bottom>t.top,m3=(e,t)=>{const n=Hx(e,t)/Math.min(e.height,t.height);return d3(e,t)&&n>.5},g3=(e,t)=>{const n=re(e,s=>f3(t,s));return zx(n).fold(()=>[[],e],s=>{const{pass:o,fail:r}=sr(e,a=>m3(a,s));return[o,r]})},p3=(e,t)=>({node:e.node,position:c3(e,t)<u3(e,t)?ma.Before:ma.After}),h3=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),gd=(e,t,n)=>{const s=u=>tn(u.node)?d.some(u):Z(u.node)?gd(Nt(u.node.childNodes),t,n):d.none(),o=(u,f)=>{if(u.length>=2){const m=s(u[0]).getOr(u[0]),g=s(u[1]).getOr(u[1]);if(Math.abs(f(m,t,n)-f(g,t,n))<2){if(M(m.node))return d.some(m);if(M(g.node))return d.some(g)}}return d.none()},r=(u,f)=>{const m=ar(u,(g,h)=>f(g,t,n)-f(h,t,n));return o(m,f).orThunk(()=>co(m,s))},[a,i]=g3(bv(e),n),{pass:l,fail:c}=sr(i,u=>u.top<n);return r(a,h3).orThunk(()=>r(c,jg)).orThunk(()=>r(l,jg))},b3=(e,t,n,s)=>{const o=(r,a)=>a.fold(()=>gd(Nt(r.dom.childNodes),n,s),i=>{const l=re(Nt(r.dom.childNodes),c=>c!==i.dom);return gd(l,n,s)}).orThunk(()=>(Ae(r,e)?d.none():Dw(r)).bind(l=>o(l,d.some(r))));return o(t,d.none())},C3=(e,t,n)=>{const s=C.fromDom(e),o=ns(s),a=C.fromPoint(o,t,n).filter(i=>Vn(s,i)).getOr(s);return b3(s,a,t,n)},y3=(e,t,n)=>C3(e,t,n).filter(s=>Lr(s.node)).map(s=>p3(s,t)),xS=e=>{const t=e.getBoundingClientRect(),n=e.ownerDocument,s=n.documentElement,o=n.defaultView;return{top:t.top+o.pageYOffset-s.clientTop,left:t.left+o.pageXOffset-s.clientLeft}},v3=e=>e.inline?xS(e.getBody()):{left:0,top:0},E3=e=>{const t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},S3=e=>{const t=e.getBody(),n=e.getDoc().documentElement,s={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?s:o},w3=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){const n=xS(e.getContentAreaContainer()),s=S3(e);return{left:t.pageX-n.left+s.left,top:t.pageY-n.top+s.top}}return{left:t.pageX,top:t.pageY}},k3=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),x3=(e,t)=>k3(v3(e),E3(e),w3(e,t)),pd=Oe,N3=xn,_3=(e,t)=>pd(t)&&t!==e,A3=(e,t,n)=>t===n||e.dom.isChildOf(t,n)?!1:!pd(t),R3=e=>{const t=e.cloneNode(!0);return t.removeAttribute("data-mce-selected"),t},T3=(e,t,n,s)=>{const o=e.dom,r=t.cloneNode(!0);o.setStyles(r,{width:n,height:s}),o.setAttrib(r,"data-mce-selected",null);const a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:s}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),a.appendChild(r),a},P3=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},D3=(e,t,n,s,o,r)=>{let a=0,i=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(a=t.pageX+n-o),t.pageY+s>r&&(i=t.pageY+s-r),e.style.width=n-a+"px",e.style.height=s-i+"px"},NS=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},B3=e=>e.button===0,O3=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),$3=(e,t)=>n=>{if(B3(n)){const s=Ye(t.dom.getParents(n.target),qx(pd,N3)).getOr(null);if(_3(t.getBody(),s)){const o=t.dom.getPos(s),r=t.getBody(),a=t.getDoc().documentElement;e.set({element:s,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?r.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?r.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:s.offsetWidth,height:s.offsetHeight,ghost:T3(t,s,s.offsetWidth,s.offsetHeight)})}}},L3=(e,t)=>{const n=Ua((s,o)=>{t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(s,o)},0);return t.on("remove",n.cancel),s=>e.on(o=>{const r=Math.max(Math.abs(s.screenX-o.screenX),Math.abs(s.screenY-o.screenY));if(!o.dragging&&r>10){if(t.dispatch("dragstart",{target:o.element}).isDefaultPrevented())return;o.dragging=!0,t.focus()}if(o.dragging){const a=O3(o,x3(t,s));P3(o.ghost,t.getBody()),D3(o.ghost,a,o.width,o.height,o.maxX,o.maxY),n.throttle(s.clientX,s.clientY)}})},I3=e=>{const n=e.getSel().getRangeAt(0).startContainer;return n.nodeType===3?n.parentNode:n},F3=(e,t)=>n=>{e.on(s=>{if(s.dragging){if(A3(t,I3(t.selection),s.element)){const o=R3(s.element);t.dispatch("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||t.undoManager.transact(()=>{NS(s.element),t.insertContent(t.dom.getOuterHTML(o)),t._selectionOverrides.hideFakeCaret()})}t.dispatch("dragend")}}),_S(e)},M3=(e,t)=>()=>{e.on(n=>{n.dragging&&t.dispatch("dragend")}),_S(e)},_S=e=>{e.on(t=>{NS(t.ghost)}),e.clear()},U3=e=>{const t=cs(),n=Re.DOM,s=document,o=$3(t,e),r=L3(t,e),a=F3(t,e),i=M3(t,e);e.on("mousedown",o),e.on("mousemove",r),e.on("mouseup",a),n.bind(s,"mousemove",r),n.bind(s,"mouseup",i),e.on("remove",()=>{n.unbind(s,"mousemove",r),n.unbind(s,"mouseup",i)}),e.on("keydown",l=>{l.keyCode===G.ESC&&i()})},z3=e=>{const t=o=>{if(!o.isDefaultPrevented()){const r=o.dataTransfer;r&&(De(r.types,"Files")||r.files.length>0)&&(o.preventDefault(),o.type==="drop"&&Ii(e,"Dropped file type is not supported"))}},n=o=>{di(e,o.target)&&t(o)},s=()=>{const o=Re.DOM,r=e.dom,a=document,i=e.inline?e.getBody():e.getDoc(),l=["drop","dragover"];B(l,c=>{o.bind(a,c,n),r.bind(i,c,t)}),e.on("remove",()=>{B(l,c=>{o.unbind(a,c,n),r.unbind(i,c,t)})})};e.on("init",()=>{qt.setEditorTimeout(e,s,0)})},H3=e=>{U3(e),f_(e)&&z3(e)},V3=e=>{const t=Ua(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){const n=e.selection.getRng();if(n.collapsed){const s=wf(e,n,!1);e.selection.setRng(s)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},W3=e=>{e.on("init",()=>{e.on("focusin",t=>{const n=t.target;if(Nn(n)){const s=Qr(e.getBody(),n),o=Oe(s)?s:n;e.selection.getNode()!==o&&sa(e,o).each(r=>e.selection.setRng(r))}})})},Yo=Oe,hd=(e,t)=>Qr(e.getBody(),t),j3=e=>{const t=e.selection,n=e.dom,s=n.isBlock,o=e.getBody(),r=G_(e,o,s,()=>qs(e)),a="sel-"+n.uniqueId(),i="data-mce-selected";let l;const c=T=>n.hasClass(T,"mce-offscreen-selection"),u=T=>T!==o&&(Yo(T)||Nn(T))&&n.isChildOf(T,o),f=T=>{T&&t.setRng(T)},m=(T,$,L,Q=!0)=>e.dispatch("ShowCaret",{target:$,direction:T,before:L}).isDefaultPrevented()?null:(Q&&t.scrollIntoView($,T===-1),r.show(L,$)),g=T=>{T.hasAttribute("data-mce-caret")&&(oc(T),t.scrollIntoView(T))},h=()=>{e.on("click",$=>{const L=hd(e,$.target);L&&Yo(L)&&($.preventDefault(),e.focus())}),e.on("blur NewBlock",_),e.on("ResizeWindow FullscreenStateChanged",r.reposition),e.on("tap",$=>{const L=$.target,Q=hd(e,L);Yo(Q)?($.preventDefault(),sa(e,Q).each(x)):u(L)&&sa(e,L).each(x)},!0),e.on("mousedown",$=>{const L=$.target;if(L!==o&&L.nodeName!=="HTML"&&!n.isChildOf(L,o)||zL(e,$.clientX,$.clientY)===!1)return;_(),A();const Q=hd(e,L);Yo(Q)?($.preventDefault(),sa(e,Q).each(x)):y3(o,$.clientX,$.clientY).each(q=>{$.preventDefault();const z=m(1,q.node,q.position===ma.Before,!1);f(z),Z(Q)?Q.focus():e.getBody().focus()})}),e.on("keypress",$=>{G.modifierPressed($)||Yo(t.getNode())&&$.preventDefault()}),e.on("GetSelectionRange",$=>{let L=$.range;if(l){if(!l.parentNode){l=null;return}L=L.cloneRange(),L.selectNode(l),$.range=L}}),e.on("SetSelectionRange",$=>{$.range=y($.range);const L=x($.range,$.forward);L&&($.range=L)});const T=$=>$.id==="mcepastebin";e.on("AfterSetSelectionRange",$=>{const L=$.range,Q=L.startContainer.parentNode;!b(L)&&!T(Q)&&A(),c(Q)||_()}),H3(e),V3(e),W3(e)},p=T=>Ht(T)||Ba(T)||Oa(T),b=T=>p(T.startContainer)||p(T.endContainer),y=T=>{const $=e.schema.getVoidElements(),L=n.createRng(),Q=T.startContainer,q=T.startOffset,z=T.endContainer,pe=T.endOffset;return fe($,Q.nodeName.toLowerCase())?q===0?L.setStartBefore(Q):L.setStartAfter(Q):L.setStart(Q,q),fe($,z.nodeName.toLowerCase())?pe===0?L.setEndBefore(z):L.setEndAfter(z):L.setEnd(z,pe),L},E=(T,$)=>{const L=C.fromDom(e.getBody()),Q=e.getDoc(),q=Er(L,"#"+a).getOrThunk(()=>{const Ce=C.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',Q);return ot(Ce,"id",a),qe(L,Ce),Ce}),z=n.createRng();Cr(q),Rs(q,[C.fromText(it,Q),C.fromDom($),C.fromText(it,Q)]),z.setStart(q.dom.firstChild,1),z.setEnd(q.dom.lastChild,0),ka(q,{top:n.getPos(T,e.getBody()).y+"px"}),eb(q);const pe=t.getSel();return pe.removeAllRanges(),pe.addRange(z),z},S=T=>{const $=T.cloneNode(!0),L=e.dispatch("ObjectSelected",{target:T,targetClone:$});if(L.isDefaultPrevented())return null;const Q=E(T,L.targetClone),q=C.fromDom(T);return B(At(C.fromDom(e.getBody()),`*[${i}]`),z=>{Ae(q,z)||rt(z,i)}),n.getAttrib(T,i)||T.setAttribute(i,"1"),l=T,A(),Q},x=(T,$)=>{if(!T)return null;if(T.collapsed){if(!b(T)){const z=$?1:-1,pe=Ur(z,o,T),Ce=pe.getNode(!$);if(Lr(Ce))return m(z,Ce,$?!pe.isAtEnd():!1,!1);const ke=pe.getNode($);if(Lr(ke))return m(z,ke,$?!1:!pe.isAtEnd(),!1)}return null}let L=T.startContainer,Q=T.startOffset;const q=T.endOffset;if(L.nodeType===3&&Q===0&&Yo(L.parentNode)&&(L=L.parentNode,Q=n.nodeIndex(L),L=L.parentNode),L.nodeType!==1)return null;if(q===Q+1&&L===T.endContainer){const z=L.childNodes[Q];if(u(z))return S(z)}return null},_=()=>{l&&l.removeAttribute(i),Er(C.fromDom(e.getBody()),"#"+a).each(Fe),l=null},j=()=>{r.destroy(),l=null},A=()=>{r.hide()};return Gn(e)||h(),{showCaret:m,showBlockCaretContainer:g,hideFakeCaret:A,destroy:j}},AS=(e,t,n)=>{if(M(t)&&(n<0||n>t.data.length))return[];const s=[n];let o=t;for(;o!==e&&o.parentNode;){const r=o.parentNode;for(let a=0;a<r.childNodes.length;a++)if(r.childNodes[a]===o){s.push(a);break}o=r}return o===e?s.reverse():[]},bd=(e,t,n,s,o)=>{const r=AS(e,t,n),a=AS(e,s,o);return{start:r,end:a}},RS=(e,t)=>{const n=t.slice(),s=n.pop();return $t(n,(r,a)=>r.bind(i=>d.from(i.childNodes[a])),d.some(e)).bind(r=>M(r)&&(s<0||s>r.data.length)?d.none():d.some({node:r,offset:s}))},TS=(e,t)=>RS(e,t.start).bind(({node:n,offset:s})=>RS(e,t.end).map(({node:o,offset:r})=>{const a=document.createRange();return a.setStart(n,s),a.setEnd(o,r),a})),q3=(e,t)=>bd(e,t.startContainer,t.startOffset,t.endContainer,t.endOffset),Xo=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const s=t.parentNode;e.remove(t),Xo(e,s,n)}},ll=(e,t,n,s=!0)=>{const o=t.startContainer.parentNode,r=t.endContainer.parentNode;t.deleteContents(),s&&!n(t.startContainer)&&(M(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),M(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),Xo(e,o,n),o!==r&&Xo(e,r,n))},Cd=(e,t)=>d.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),PS=(e,t,n)=>{BU(t,0,t).each(o=>{const r=o.container;gE(r,n.start.length,t).each(a=>{const i=e.createRng();i.setStart(r,0),i.setEnd(a.container,a.offset),ll(e,i,l=>l===t)})})},K3=(e,t)=>{const n=e.dom,s=t.pattern,o=TS(n.getRoot(),t.range).getOrDie("Unable to resolve path range"),r=(a,i)=>{const l=i.get(a);return Ge(l)&&Lt(l).exists(c=>fe(c,"block"))};return Cd(e,o).each(a=>{s.type==="block-format"?r(s.format,e.formatter)&&e.undoManager.transact(()=>{PS(e.dom,a,s),e.formatter.apply(s.format)}):s.type==="block-command"&&e.undoManager.transact(()=>{PS(e.dom,a,s),e.execCommand(s.cmd,!1,s.value)})}),!0},G3=(e,t)=>{const n=t.replace(it," ");return Ye(e,s=>t.indexOf(s.start)===0||n.indexOf(s.start)===0)},Y3=(e,t)=>{const n=e.dom,s=e.selection.getRng();return Cd(e,s).filter(o=>{const r=Rt(e),a=n.is(o,r);return o!==null&&a}).bind(o=>{const r=o.textContent;return G3(t,r).map(i=>D.trim(r).length===i.start.length?[]:[{pattern:i,range:bd(n.getRoot(),o,0,o,0)}])}).getOr([])},X3=(e,t)=>{if(t.length===0)return;const n=e.selection.getBookmark();B(t,s=>K3(e,s)),e.selection.moveToBookmark(n)},DS=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),cl=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},BS=(e,t,n)=>{const s=TS(e.getRoot(),n).getOrDie("Unable to resolve path range"),o=s.startContainer,r=s.endContainer,a=s.endOffset===0?r:r.splitText(s.endOffset),i=s.startOffset===0?o:o.splitText(s.startOffset);return{prefix:t,end:a.parentNode.insertBefore(DS(e,t+"-end"),a),start:i.parentNode.insertBefore(DS(e,t+"-start"),i)}},OS=(e,t,n)=>{Xo(e,e.get(t.prefix+"-end"),n),Xo(e,e.get(t.prefix+"-start"),n)},yd=e=>e.start.length===0,Q3=e=>(t,n)=>{const o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),a=o.lastIndexOf(e);return a!==-1?a+e.length:r!==-1?r+1:-1},$S=(e,t,n,s)=>{const o=t.start;return jf(e,s.container,s.offset,Q3(o),n).bind(a=>{if(a.offset>=o.length){const i=e.createRng();return i.setStart(a.container,a.offset-o.length),i.setEnd(a.container,a.offset),d.some(i)}else{const i=a.offset-o.length;return Wf(a.container,i,n).map(l=>{const c=e.createRng();return c.setStart(l.container,l.offset),c.setEnd(a.container,a.offset),c}).filter(l=>l.toString()===o).orThunk(()=>$S(e,t,n,fn(a.container,0)))}})},Z3=(e,t,n,s,o,r=!1)=>{if(t.start.length===0&&!r){const a=e.createRng();return a.setStart(n,s),a.setEnd(n,s),d.some(a)}return Vf(n,s,o).bind(a=>$S(e,t,o,a).bind(l=>{if(r){if(l.endContainer===a.container&&l.endOffset===a.offset)return d.none();if(a.offset===0&&l.endContainer.textContent.length===l.endOffset)return d.none()}return d.some(l)}))},J3=(e,t,n)=>{const s=e.dom,o=s.getRoot(),r=n.pattern,a=n.position.container,i=n.position.offset;return Wf(a,i-n.pattern.end.length,t).bind(l=>{const c=bd(o,l.container,l.offset,a,i);if(yd(r))return d.some({matches:[{pattern:r,startRng:c,endRng:c}],position:l});{const u=LS(e,n.remainingPatterns,l.container,l.offset,t),f=u.getOr({matches:[],position:l}),m=f.position;return Z3(s,r,m.container,m.offset,t,u.isNone()).map(h=>{const p=q3(o,h);return{matches:f.matches.concat([{pattern:r,startRng:p,endRng:c}]),position:fn(h.startContainer,h.startOffset)}})}})},LS=(e,t,n,s,o)=>{const r=e.dom;return Vf(n,s,r.getRoot()).bind(a=>{const i=r.createRng();i.setStart(o,0),i.setEnd(n,s);const l=i.toString();for(let c=0;c<t.length;c++){const u=t[c];if(!Zd(l,u.end))continue;const f=t.slice();f.splice(c,1);const m=J3(e,o,{pattern:u,remainingPatterns:f,position:a});if(m.isSome())return m}return d.none()})},IS=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?B(t.format,s=>{e.formatter.apply(s)}):e.execCommand(t.cmd,!1,t.value)},eV=(e,t,n,s)=>{const o=cl(e.dom,n);ll(e.dom,o,s),IS(e,t,o)},tV=(e,t,n,s,o)=>{const r=e.dom,a=cl(r,s),i=cl(r,n);ll(r,i,o),ll(r,a,o);const l={prefix:n.prefix,start:n.end,end:s.start},c=cl(r,l);IS(e,t,c)},nV=(e,t)=>{const n=Mg("mce_textpattern"),s=Ca(t,(o,r)=>{const a=BS(e,n+`_end${o.length}`,r.endRng);return o.concat([{...r,endMarker:a}])},[]);return Ca(s,(o,r)=>{const a=s.length-o.length-1,i=yd(r.pattern)?r.endMarker:BS(e,n+`_start${a}`,r.startRng);return o.concat([{...r,startMarker:i}])},[])},FS=(e,t,n)=>{const s=e.selection.getRng();return s.collapsed===!1?[]:Cd(e,s).bind(o=>{const r=Math.max(0,s.startOffset-(n?1:0));return LS(e,t,s.startContainer,r,o)}).fold(()=>[],o=>o.matches)},MS=(e,t)=>{if(t.length===0)return;const n=e.dom,s=e.selection.getBookmark(),o=nV(n,t);B(o,r=>{const a=n.getParent(r.startMarker.start,n.isBlock),i=l=>l===a;yd(r.pattern)?eV(e,r.pattern,r.endMarker,i):tV(e,r.pattern,r.startMarker,r.endMarker,i),OS(n,r.endMarker,i),OS(n,r.startMarker,i)}),e.selection.moveToBookmark(s)},sV=e=>e.inlinePatterns.length>0||e.blockPatterns.length>0,oV=(e,t)=>{if(!e.selection.isCollapsed()||!sV(t))return!1;const n=FS(e,t.inlinePatterns,!1),s=Y3(e,t.blockPatterns);return s.length>0||n.length>0?(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{e.insertContent(wr),MS(e,n),X3(e,s);const o=e.selection.getRng(),r=Vf(o.startContainer,o.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),r.each(a=>{const i=a.container;i.data.charAt(a.offset-1)===wr&&(i.deleteData(a.offset-1,1),Xo(e.dom,i.parentNode,l=>l===e.dom.getRoot()))})}),!0):!1},US=(e,t)=>{if(t.length>0){const n=FS(e,t,!0);n.length>0&&e.undoManager.transact(()=>{MS(e,n)})}},zS=(e,t,n)=>{for(let s=0;s<e.length;s++)if(n(e[s],t))return!0;return!1},rV=(e,t)=>zS(e,t,(n,s)=>n===s.keyCode&&G.modifierPressed(s)===!1),aV=(e,t)=>zS(e,t,(n,s)=>n.charCodeAt(0)===s.charCode),iV=e=>{const t=[",",".",";",":","!","?"],n=[32],s=()=>yN(Tp(e)),o=()=>pp(Tp(e));e.on("keydown",r=>{r.keyCode===13&&!G.modifierPressed(r)&&oV(e,s())&&r.preventDefault()},!0),e.on("keyup",r=>{rV(n,r)&&US(e,o())}),e.on("keypress",r=>{aV(t,r)&&qt.setEditorTimeout(e,()=>{US(e,o())})})},lV=e=>{iV(e)},cV=e=>{const t=D.each,n=G.BACKSPACE,s=G.DELETE,o=e.dom,r=e.selection,a=e.parser,i=Se.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),u=Se.deviceType.isiPhone()||Se.deviceType.isiPad(),f=Se.os.isMacOS()||Se.os.isiOS(),m=(U,J)=>{try{e.getDoc().execCommand(U,!1,J)}catch{}},g=U=>U.isDefaultPrevented(),h=()=>{const U=K=>{const I=o.create("body"),ce=K.cloneContents();return I.appendChild(ce),r.serializer.serialize(I,{format:"html"})},J=K=>{const I=U(K),ce=o.createRng();ce.selectNode(e.getBody());const ge=U(ce);return I===ge};e.on("keydown",K=>{const I=K.keyCode;let ce,ge;if(!g(K)&&(I===s||I===n)){if(ce=e.selection.isCollapsed(),ge=e.getBody(),ce&&!o.isEmpty(ge)||!ce&&!J(e.selection.getRng()))return;K.preventDefault(),e.setContent(""),ge.firstChild&&o.isBlock(ge.firstChild)?e.selection.setCursorLocation(ge.firstChild,0):e.selection.setCursorLocation(ge,0),e.nodeChanged()}})},p=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},b=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",U=>{let J;if(U.target===e.getDoc().documentElement)if(J=r.getRng(),e.getBody().focus(),U.type==="mousedown"){if(Ht(J.startContainer))return;r.placeCaretAt(U.clientX,U.clientY)}else r.setRng(J)})},y=()=>{e.on("keydown",U=>{if(!g(U)&&U.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(r.isCollapsed()&&r.getRng().startOffset===0){const J=r.getNode(),K=J.previousSibling;if(J.nodeName==="HR"){o.remove(J),U.preventDefault();return}K&&K.nodeName&&K.nodeName.toLowerCase()==="hr"&&(o.remove(K),U.preventDefault())}}})},E=()=>{Range.prototype.getClientRects||e.on("mousedown",U=>{if(!g(U)&&U.target.nodeName==="HTML"){const J=e.getBody();J.blur(),qt.setEditorTimeout(e,()=>{J.focus()})}})},S=()=>{const U=Rp(e);e.on("click",J=>{const K=J.target;/^(IMG|HR)$/.test(K.nodeName)&&o.getContentEditableParent(K)!=="false"&&(J.preventDefault(),e.selection.select(K),e.nodeChanged()),K.nodeName==="A"&&o.hasClass(K,U)&&K.childNodes.length===0&&(J.preventDefault(),r.select(K))})},x=()=>{const U=()=>{const K=o.getAttribs(r.getStart().cloneNode(!1));return()=>{const I=r.getStart();I!==e.getBody()&&(o.setAttrib(I,"style",null),t(K,ce=>{I.setAttributeNode(ce.cloneNode(!0))}))}},J=()=>!r.isCollapsed()&&o.getParent(r.getStart(),o.isBlock)!==o.getParent(r.getEnd(),o.isBlock);e.on("keypress",K=>{let I;if(!g(K)&&(K.keyCode===8||K.keyCode===46)&&J())return I=U(),e.getDoc().execCommand("delete",!1,null),I(),K.preventDefault(),!1}),o.bind(e.getDoc(),"cut",K=>{let I;!g(K)&&J()&&(I=U(),qt.setEditorTimeout(e,()=>{I()}))})},_=()=>{e.on("keydown",U=>{if(!g(U)&&U.keyCode===n&&r.isCollapsed()&&r.getRng().startOffset===0){const J=r.getNode().previousSibling;if(J&&J.nodeName&&J.nodeName.toLowerCase()==="table")return U.preventDefault(),!1}})},j=()=>{e.on("keydown",U=>{let J,K;if(g(U)||U.keyCode!==G.BACKSPACE)return;J=r.getRng();const I=J.startContainer,ce=J.startOffset,ge=o.getRoot();if(K=I,!(!J.collapsed||ce!==0)){for(;K&&K.parentNode&&K.parentNode.firstChild===K&&K.parentNode!==ge;)K=K.parentNode;K.tagName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",null,K),J=o.createRng(),J.setStart(I,0),J.setEnd(I,0),r.setRng(J))}})},A=()=>{const U=()=>{m("StyleWithCSS",!1),m("enableInlineTableEditing",!1),Np(e)||m("enableObjectResizing",!1)};Ap(e)||e.on("BeforeExecCommand mousedown",U)},T=()=>{const U=()=>{t(o.select("a"),J=>{let K=J.parentNode;const I=o.getRoot();if(K.lastChild===J){for(;K&&!o.isBlock(K);){if(K.parentNode.lastChild!==K||K===I)return;K=K.parentNode}o.add(K,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",J=>{(J.type==="setcontent"||J.command==="mceInsertLink")&&U()})},$=()=>{e.on("init",()=>{m("DefaultParagraphSeparator",Rt(e))})},L=U=>{const J=U.getBody(),K=U.selection.getRng();return K.startContainer===K.endContainer&&K.startContainer===J&&K.startOffset===0&&K.endOffset===J.childNodes.length},Q=()=>{e.on("keyup focusin mouseup",U=>{!G.modifierPressed(U)&&!L(e)&&r.normalize()},!0)},q=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},z=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},pe=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",U=>{let J;U.target.nodeName==="HTML"&&(J=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(J),e.selection.normalize(),e.nodeChanged())}))},Ce=()=>{f&&e.on("keydown",U=>{G.metaKeyPressed(U)&&!U.shiftKey&&(U.keyCode===37||U.keyCode===39)&&(U.preventDefault(),e.selection.getSel().modify("move",U.keyCode===37?"backward":"forward","lineboundary"))})},ke=()=>{e.on("click",U=>{let J=U.target;do if(J.tagName==="A"){U.preventDefault();return}while(J=J.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},ze=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",U=>{U.preventDefault()})})},O=()=>{a.addNodeFilter("br",U=>{let J=U.length;for(;J--;)U[J].attr("class")==="Apple-interchange-newline"&&U[J].remove()})},Y=me,ue=()=>{if(!l||e.removed)return!1;const U=e.selection.getSel();return!U||!U.rangeCount||U.rangeCount===0},le=()=>{c&&(b(),S(),ze(),p(),u&&(z(),pe(),ke())),l&&(E(),A(),q(),Ce())},We=()=>{j(),h(),Se.windowsPhone||Q(),c&&(b(),S(),$(),ze(),_(),O(),u?(z(),pe(),ke()):p()),l&&(y(),E(),x(),A(),T(),q(),Ce(),_())};return Gn(e)?le():We(),{refreshContentEditable:Y,isHidden:ue}},vd=Re.DOM,uV=(e,t)=>{const n=C.fromDom(e.getBody()),s=ql(As(n)),o=C.fromTag("style");ot(o,"type","text/css"),qe(o,C.fromText(t)),qe(s,o),e.on("remove",()=>{Fe(o)})},fV=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,Ed=e=>lr(e,t=>kt(t)===!1),HS=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return Ed({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),remove_trailing_brs:t("remove_trailing_brs"),inline_styles:t("inline_styles"),root_name:fV(e),validate:!0,blob_cache:n,document:e.getDoc()})},VS=e=>{const t=e.options.get;return Ed({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},dV=e=>{const t=e.options.get;return{...HS(e),...VS(e),...Ed({url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},mV=e=>{const t=Ho(HS(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(n,s)=>{let o=n.length,r,a;const i=e.dom,l="data-mce-"+s;for(;o--;)if(r=n[o],a=r.attr(s),a&&!r.attr(l)){if(a.indexOf("data:")===0||a.indexOf("blob:")===0)continue;s==="style"?(a=i.serializeStyle(i.parseStyle(a),r.name),a.length||(a=null),r.attr(l,a),r.attr(s,a)):s==="tabindex"?(r.attr(l,a),r.attr(s,null)):r.attr(l,e.convertURL(a,s,r.name))}}),t.addNodeFilter("script",n=>{let s=n.length;for(;s--;){const o=n[s],r=o.attr("type")||"no/type";r.indexOf("mce-")!==0&&o.attr("type","mce-"+r)}}),e.options.get("preserve_cdata")&&t.addNodeFilter("#cdata",n=>{let s=n.length;for(;s--;){const o=n[s];o.type=8,o.name="#comment",o.value="[CDATA["+e.dom.encode(o.value)+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",n=>{let s=n.length;const o=e.schema.getNonEmptyElements();for(;s--;){const r=n[s];r.isEmpty(o)&&r.getAll("br").length===0&&r.append(new vt("br",1))}}),t},gV=e=>{const t=C_(e);t&&qt.setEditorTimeout(e,()=>{let n;t===!0?n=e:n=e.editorManager.get(t),n.destroyed||n.focus()},100)},pV=e=>{const t=e.dom.getRoot();!e.inline&&(!ri(e)||e.selection.getStart(!0)===t)&&yt(t).each(n=>{const s=n.getNode(),o=yr(s)?yt(s).getOr(n):n;e.selection.setRng(o.toRange())})},hV=e=>{e.bindPendingEventDelegates(),e.initialized=!0,sR(e),e.focus(!0),pV(e),e.nodeChanged({initial:!0});const t=h_(e);_e(t)&&t.call(e,e),gV(e)},WS=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,bV=(e,t,n)=>{const s=[WS(e).loadAll(t)];return e.inline?s:s.concat([e.ui.styleSheetLoader.loadAll(n)])},jS=e=>{const t=WS(e),n=xp(e),s=e.contentCSS,o=()=>{t.unloadAll(s),e.inline||e.ui.styleSheetLoader.unloadAll(n)},r=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let l="";D.each(e.contentStyles,c=>{l+=c+`\r
`}),e.dom.addStyle(l)}const a=Promise.all(bV(e,s,n)).then(r).catch(r),i=jN(e);return i&&uV(e,i),a},CV=e=>{const t=e.getDoc(),n=e.getBody();tR(e),y_(e)||(t.body.spellcheck=!1,vd.setAttrib(n,"spellcheck","false")),e.quirks=cV(e),nR(e);const s=qN(e);s!==void 0&&(n.dir=s);const o=v_(e);o&&e.on("BeforeSetContent",r=>{D.each(o,a=>{r.content=r.content.replace(a,i=>"<!--mce:protected "+escape(i)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",r=>{e.composing=r.type==="compositionstart"})},yV=e=>{Gn(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},Sd=e=>{e.removed!==!0&&(yV(e),hV(e))},qS=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(vd.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const s=e.getBody();s.disabled=!0,e.readonly=Ap(e),e.readonly||(e.inline&&vd.getStyle(s,"position",!0)==="static"&&(s.style.position="relative"),s.contentEditable="true"),s.disabled=!1,e.editorUpload=mI(e),e.schema=ls(VS(e)),e.dom=Re(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:()=>e.inline,schema:e.schema,contentCssCors:zN(e),referrerPolicy:_c(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)}}),e.parser=mV(e),e.serializer=ky(dV(e),e),e.selection=wy(e.dom,e.getWin(),e.serializer,e),e.annotator=Ah(e),e.formatter=Ly(e),e.undoManager=Fy(e),e._nodeChangeDispatcher=new J2(e),e._selectionOverrides=j3(e),kM(e),t3(e),DM(e),Gn(e)||(l3(e),lV(e));const o=Z2(e);EM(e,o),RM(e),AI(e),ZH(e);const r=S$(e);CV(e),r.fold(()=>{jS(e).then(()=>Sd(e))},a=>{e.setProgressState(!0),jS(e).then(()=>{a().then(i=>{e.setProgressState(!1),Sd(e),Cy(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),Sd(e),Cy(e)})})})},KS=(e,t)=>{if(e.inline||(e.getElement().style.visibility=e.orgVisibility),!t&&!e.inline){const n=e.iframeElement,s=oI(C.fromDom(n),"load",()=>{s.unbind(),e.contentDocument=n.contentDocument,qS(e)});n.srcdoc=e.iframeHTML}else qS(e)},ul=Re.DOM,vV=(e,t,n,s)=>{const o=C.fromTag("iframe");return s.each(r=>ot(o,"tabindex",r)),Sn(o,n),Sn(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),gr(o,"tox-edit-area__iframe"),o},EV=e=>{let t=NN(e)+"<html><head>";Cp(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const n=_N(e),s=AN(e),o=e.translate(g_(e));return yp(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+yp(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${s}" data-id="${e.id}" aria-label="${o}"><br></body></html>`,t},SV=(e,t)=>{const n=e.translate("Rich Text Area"),s=po(C.fromDom(e.getElement()),"tabindex").bind(nw),o=vV(e.id,n,xN(e),s).dom;o.onload=()=>{o.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=o,e.iframeHTML=EV(e),ul.add(t.iframeContainer,o)},wV=(e,t)=>{SV(e,t),t.editorContainer&&(ul.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=ul.isHidden(t.editorContainer)),e.getElement().style.display="none",ul.setAttrib(e.id,"aria-hidden","true"),KS(e)},GS=Re.DOM,kV=(e,t,n)=>{const s=Wo.get(n),o=Wo.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=D.trim(n),s&&D.inArray(t,n)===-1){if(e.plugins[n])return;try{const r=s(e,o)||{};e.plugins[n]=r,_e(r.init)&&(r.init(e,o),t.push(n))}catch(r){ZL(e,n,r)}}},xV=e=>e.replace(/^\-/,""),NV=e=>{const t=[];B(ja(e),n=>{kV(e,t,xV(n))})},_V=e=>{const t=D.trim(Sp(e)),n=e.ui.registry.getAll().icons,s={...Li.get("default").icons,...Li.get(t).icons};Pe(s,(o,r)=>{fe(n,r)||e.ui.registry.addIcon(r,o)})},AV=e=>{const t=To(e);if(ne(t)){const n=Zs.get(t);e.theme=n(e,Zs.urls[t])||{},_e(e.theme.init)&&e.theme.init(e,Zs.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},RV=e=>{const t=Ac(e),n=Vo.get(t);e.model=n(e,Vo.urls[t])},TV=e=>e.theme.renderUI(),PV=e=>{const t=e.getElement(),s=To(e)(e,t);return s.editorContainer.nodeType&&(s.editorContainer.id=s.editorContainer.id||e.id+"_parent"),s.iframeContainer&&s.iframeContainer.nodeType&&(s.iframeContainer.id=s.iframeContainer.id||e.id+"_iframecontainer"),s.height=s.iframeHeight?s.iframeHeight:t.offsetHeight,s},YS=e=>({editorContainer:e,iframeContainer:e,api:{}}),DV=e=>{const t=GS.create("div");return GS.insertAfter(t,e),YS(t)},BV=e=>{const t=e.getElement();return e.inline?YS(null):DV(t)},OV=e=>{const t=e.getElement();return e.orgDisplay=t.style.display,ne(To(e))?TV(e):_e(To(e))?PV(e):BV(e)},$V=(e,t)=>{const n={show:d.from(t.show).getOr(me),hide:d.from(t.hide).getOr(me),isEnabled:d.from(t.isEnabled).getOr(je),setEnabled:s=>{e.mode.isReadOnly()||d.from(t.setEnabled).each(o=>o(s))}};e.ui={...e.ui,...n}},LV=e=>{e.dispatch("ScriptsLoaded"),_V(e),AV(e),RV(e),NV(e);const t=OV(e);$V(e,d.from(t.api).getOr({}));const n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};return e.editorContainer=n.editorContainer?n.editorContainer:null,nI(e),e.inline?KS(e):wV(e,n)},Js=Re.DOM,XS=e=>e.charAt(0)==="-",IV=(e,t)=>{const n=wp(t),s=HN(t);if(on.hasCode(n)===!1&&n!=="en"){const o=zn(s)?s:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(o).catch(()=>{YL(t,o,n)})}},FV=(e,t)=>{const n=To(e);if(ne(n)&&!XS(n)&&!fe(Zs.urls,n)){const s=QN(e),o=s?e.documentBaseURI.toAbsolute(s):`themes/${n}/theme${t}.js`;Zs.load(n,o).catch(()=>{XL(e,o,n)})}},MV=(e,t)=>{const n=Ac(e);if(n!=="plugin"&&!fe(Vo.urls,n)){const s=ZN(e),o=ne(s)?e.documentBaseURI.toAbsolute(s):`models/${n}/model${t}.js`;Vo.load(n,o).catch(()=>{QL(e,o,n)})}},UV=e=>d.from(LN(e)).filter(zn).map(t=>({url:t,name:d.none()})),QS=(e,t,n)=>d.from(t).filter(s=>zn(s)&&!Li.has(s)).map(s=>({url:`${e.editorManager.baseURL}/icons/${s}/icons${n}.js`,name:d.some(s)})),zV=(e,t,n)=>{const s=QS(t,"default",n),o=UV(t).orThunk(()=>QS(t,Sp(t),""));B(hw([s,o]),r=>{e.add(r.url).catch(()=>{GL(t,r.url,r.name.getOrUndefined())})})},HV=(e,t)=>{const n=(s,o)=>{Wo.load(s,o).catch(()=>{KL(e,o,s)})};Pe(u_(e),(s,o)=>{n(o,s),e.options.set("plugins",ja(e).concat(o))}),B(ja(e),s=>{s=D.trim(s),s&&!Wo.urls[s]&&!XS(s)&&n(s,`plugins/${s}/plugin${t}.js`)})},VV=e=>{const t=To(e);return!ne(t)||oe(Zs.get(t))},WV=e=>{const t=Ac(e);return oe(Vo.get(t))},jV=(e,t)=>{const n=Wn.ScriptLoader,s=()=>{!e.removed&&VV(e)&&WV(e)&&LV(e)};FV(e,t),MV(e,t),IV(n,e),zV(n,e,t),HV(e,t),n.loadQueue().then(s,s)},qV=(e,t)=>ug.forElement(e,{contentCssCors:c_(t),referrerPolicy:_c(t)}),KV=e=>{const t=e.id;on.setCode(wp(e));const n=()=>{Js.unbind(window,"ready",n),e.render()};if(!Ls.Event.domLoaded){Js.bind(window,"ready",n);return}if(!e.getElement())return;const s=C.fromDom(e.getElement()),o=Rm(s);e.on("remove",()=>{Hd(s.dom.attributes,a=>rt(s,a.name)),Sn(s,o)}),e.ui.styleSheetLoader=qV(s,e),Rc(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const r=e.getElement().form||Js.getParent(t,"form");r&&(e.formElement=r,s_(e)&&!Xl(e.getElement())&&(Js.insertAfter(Js.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=a=>{e.dispatch(a.type,a)},Js.bind(r,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),o_(e)&&!r.submit.nodeType&&!r.submit.length&&!r._mceOldSubmit&&(r._mceOldSubmit=r.submit,r.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),r._mceOldSubmit(r)))),e.windowManager=Ay(e),e.notificationManager=_y(e),$_(e)&&e.on("GetContent",a=>{a.save&&(a.content=Js.encode(a.content))}),r_(e)&&e.on("submit",()=>{e.initialized&&e.save()}),a_(e)&&(e._beforeUnload=()=>{e.initialized&&!e.destroyed&&!e.isHidden()&&e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),jV(e,e.suffix)},GV=(e,t)=>({sections:F(e),options:F(t)}),ZS=xs().deviceType,JS=ZS.isPhone(),YV=ZS.isTablet(),ga=e=>{if(xt(e))return[];{const t=Ge(e)?e:e.split(/[ ,]/),n=Ee(t,mo);return re(n,zn)}},XV=(e,t)=>{const n=H0(t,(s,o)=>De(e,o));return GV(n.t,n.f)},QV=(e,t,n={})=>{const s=e.sections(),o=Te(s,t).getOr({});return D.extend({},n,o)},wd=(e,t)=>fe(e.sections(),t),ZV=(e,t)=>wd(e,t)?e.sections()[t]:{},JV=(e,t)=>({...{table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:Te(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},...t?{menubar:!1}:{}}),eW=(e,t)=>{var n;const s=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?D.extend({},e.external_plugins,s):s},tW=(e,t)=>[].concat(ga(e)).concat(ga(t)),nW=(e,t,n,s)=>e&&wd(t,"mobile")?s:n,sW=(e,t,n,s)=>{const o=ga(n.forced_plugins),r=ga(s.plugins),a=ZV(t,"mobile"),i=a.plugins?ga(a.plugins):r,l=nW(e,t,r,i),c=tW(o,l);return D.extend(s,{forced_plugins:o,plugins:c})},oW=(e,t)=>e&&wd(t,"mobile"),rW=(e,t,n,s,o)=>{var r;const a=e?{mobile:JV((r=o.mobile)!==null&&r!==void 0?r:{},t)}:{},i=XV(["mobile"],Xi(a,o)),l=D.extend(n,s,i.options(),oW(e,i)?QV(i,"mobile"):{},{external_plugins:eW(s,i.options())});return sW(e,i,s,l)},aW=(e,t)=>rW(JS||YV,JS,t,e,t),iW=(e,t)=>K$(e,t),lW=e=>{const t=(s,o)=>{e.formatter.toggle(s,o),e.nodeChanged()},n=s=>()=>{B("left,center,right,justify".split(","),o=>{s!==o&&e.formatter.remove("align"+o)}),s!=="none"&&t("align"+s)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},cW=e=>{const t=n=>()=>{const s=e.selection,o=s.isCollapsed()?[e.dom.getParent(s.getNode(),e.dom.isBlock)]:s.getSelectedBlocks();return Me(o,r=>oe(e.formatter.matchNode(r,n)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},uW=e=>{lW(e),cW(e)},fW=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{const n=e.getDoc();let s;try{n.execCommand(t)}catch{s=!0}if(t==="paste"&&!n.queryCommandEnabled(t)&&(s=!0),s||!n.queryCommandSupported(t)){let o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Se.os.isMacOS()||Se.os.isiOS())&&(o=o.replace(/Ctrl\+/g,"\u2318+")),e.notificationManager.open({text:o,type:"error"})}}})},dW=(e,t,n)=>{const s=C.fromDom(e.getRoot());return pi(s,N.fromRangeStart(t))?n=n.replace(/^ /,"&nbsp;"):n=n.replace(/^&nbsp;/," "),hi(s,N.fromRangeEnd(t))?n=n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n=n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},mW=e=>{if(typeof e!="string"){const t=D.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},gW=(e,t)=>{const n=e.selection,s=e.dom;return/^ | $/.test(t)?dW(s,n.getRng(),t):t},fl=(e,t)=>{const{content:n,details:s}=mW(t);uf(e,{content:gW(e,n),format:"html",set:!1,selection:!0,paste:s.paste}).each(o=>{const r=j$(e,o.content,s);ff(e,r,o),e.addVisual()})},pW=e=>{e.editorCommands.addCommands({mceCleanup:()=>{const t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,s)=>{fl(e,e.dom.createHTML("img",{src:s}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,s)=>{fl(e,e.dom.encode(s))},insertHTML:(t,n,s)=>{fl(e,s)},mceInsertContent:(t,n,s)=>{fl(e,s)},mceSetContent:(t,n,s)=>{e.setContent(s)},mceReplaceContent:(t,n,s)=>{e.execCommand("mceInsertContent",!1,s.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent("")}})},hW={"font-size":"size","font-family":"face"},bW=(e,t,n)=>{const s=r=>xa(r,e).orThunk(()=>Be(r)==="font"?Te(hW,e).bind(a=>po(r,a)):d.none()),o=r=>Ae(C.fromDom(t),r);return zu(C.fromDom(n),r=>s(r),o)},CW=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),yW=(e,t)=>d.from(Re.DOM.getStyle(t,e,!0)),e0=e=>(t,n)=>d.from(n).map(C.fromDom).filter(Qt).bind(s=>bW(e,t,s.dom).or(yW(e,s.dom))).getOr(""),vW=e0("font-size"),EW=ws(CW,e0("font-family")),SW=e=>yt(e.getBody()).map(t=>{const n=t.container();return M(n)?n.parentNode:n}),wW=e=>d.from(e.selection.getRng()).bind(t=>{const n=e.getBody();return t.startContainer===n&&t.startOffset===0?d.none():d.from(e.selection.getStart(!0))}),kW=(e,t)=>wW(e).orThunk(V(SW,e)).map(C.fromDom).filter(Qt).bind(t),kd=(e,t)=>kW(e,Ud(d.some,t)),t0=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const s=B_(e),o=O_(e);return o?o[n-1]||t:s[n-1]||t}else return t}else return t},xW=e=>{const t=e.split(/\s*,\s*/);return Ee(t,n=>n.indexOf(" ")!==-1&&!(st(n,'"')||st(n,"'"))?`'${n}'`:n).join(",")},NW=(e,t)=>{const n=t0(e,t);e.formatter.toggle("fontname",{value:xW(n)}),e.nodeChanged()},_W=e=>kd(e,t=>EW(e.getBody(),t.dom)).getOr(""),AW=(e,t)=>{e.formatter.toggle("fontsize",{value:t0(e,t)}),e.nodeChanged()},RW=e=>kd(e,t=>vW(e.getBody(),t.dom)).getOr(""),TW=e=>kd(e,t=>{const n=C.fromDom(e.getBody()),s=zu(t,r=>xa(r,"line-height"),V(Ae,n)),o=()=>{const r=parseFloat(kn(t,"line-height")),a=parseFloat(kn(t,"font-size"));return String(r/a)};return s.getOrThunk(o)}).getOr(""),PW=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},DW=e=>{const t=(n,s)=>{e.formatter.toggle(n,s),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>{t(n)},"ForeColor,HiliteColor":(n,s,o)=>{t(n,{value:o})},BackColor:(n,s,o)=>{t("hilitecolor",{value:o})},FontName:(n,s,o)=>{NW(e,o)},FontSize:(n,s,o)=>{AW(e,o)},LineHeight:(n,s,o)=>{PW(e,o)},Lang:(n,s,o)=>{t(n,{value:o.code,customValue:o.customCode})},RemoveFormat:n=>{e.formatter.remove(n)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(n,s,o)=>{t(ne(o)?o:"p")},mceToggleFormat:(n,s,o)=>{t(o)}})},BW=e=>{const t=n=>e.formatter.match(n);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>t(n),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>_W(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>RW(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>TW(e))},OW=e=>{DW(e),BW(e)},$W=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},LW=e=>{e.editorCommands.addCommands({Indent:()=>{CM(e)},Outdent:()=>{Ov(e)}}),e.editorCommands.addCommands({Outdent:()=>Tv(e)},"state")},IW=e=>{const t=(n,s,o)=>{const r=ne(o)?{href:o}:o,a=e.dom.getParent(e.selection.getNode(),"a");Ot(r)&&ne(r.href)&&(r.href=r.href.replace(/ /g,"%20"),(!a||!r.href)&&e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isCollapsed()){const n=e.dom.getParent(e.selection.getStart(),"a");n&&e.dom.remove(n,!0);return}e.formatter.remove("link")},mceInsertLink:t,createLink:t})},FW=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{e.getDoc().execCommand(t);const n=e.dom.getParent(e.selection.getNode(),"ol,ul");if(n){const s=n.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(s.nodeName)){const o=e.selection.getBookmark();e.dom.split(s,n),e.selection.moveToBookmark(o)}}}})},MW=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{const n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&(t==="insertunorderedlist"&&n.tagName==="UL"||t==="insertorderedlist"&&n.tagName==="OL")}},"state")},UW=e=>{FW(e),MW(e)},zW=e=>{e.editorCommands.addCommands({insertParagraph:()=>{rl(WE,e)},mceInsertNewLine:(t,n,s)=>{QE(e,s)},InsertLineBreak:(t,n,s)=>{rl(KE,e)}})},HW=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,s)=>{let o=0;e.dom.getParent(e.selection.getNode(),r=>{if(r.nodeType===1&&o++===s)return e.selection.select(r),!1},e.getBody())},mceSelectNode:(t,n,s)=>{e.selection.select(s)},selectAll:()=>{const t=e.dom.getParent(e.selection.getStart(),xn);if(t){const n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},VW=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,s)=>{const o=s!=null?s:e.selection.getNode();if(o!==e.getBody()){const r=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(r)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,s)=>{MT(e,s)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},WW=e=>{uW(e),fW(e),$W(e),HW(e),pW(e),IW(e),LW(e),zW(e),UW(e),OW(e),VW(e)};class n0{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n,s,o){const r=this.editor,a=t.toLowerCase(),i=o==null?void 0:o.skip_focus;if(r.removed||(a!=="mcefocus"&&(!/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)&&!i?r.focus():hT(r)),r.dispatch("BeforeExecCommand",{command:t,ui:n,value:s}).isDefaultPrevented()))return!1;const c=this.commands.exec[a];return _e(c)?(c(a,n,s),r.dispatch("ExecCommand",{command:t,ui:n,value:s}),!0):!1}queryCommandState(t){if(this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=t.toLowerCase(),s=this.commands.state[n];return _e(s)?s(n):!1}queryCommandValue(t){if(this.editor.quirks.isHidden()||this.editor.removed)return"";const n=t.toLowerCase(),s=this.commands.value[n];return _e(s)?s(n):""}addCommands(t,n="exec"){const s=this.commands;Pe(t,(o,r)=>{B(r.toLowerCase().split(","),a=>{s[n][a]=o})})}addCommand(t,n,s){const o=t.toLowerCase();this.commands.exec[o]=(r,a,i)=>n.call(s!=null?s:this.editor,a,i)}queryCommandSupported(t){const n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,s){this.commands.state[t.toLowerCase()]=()=>n.call(s!=null?s:this.editor)}addQueryValueHandler(t,n,s){this.commands.value[t.toLowerCase()]=()=>n.call(s!=null?s:this.editor)}}const eo="data-mce-contenteditable",jW=(e,t,n)=>{Wl(e,t)&&n===!1?Sa(e,t):n&&gr(e,t)},xd=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},dl=(e,t)=>{e.dom.contentEditable=t?"true":"false"},qW=e=>{B(At(e,'*[contenteditable="true"]'),t=>{ot(t,eo,"true"),dl(t,!1)})},KW=e=>{B(At(e,`*[${eo}="true"]`),t=>{rt(t,eo),dl(t,!0)})},GW=e=>{d.from(e.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})},YW=e=>{e.selection.setRng(e.selection.getRng())},XW=(e,t)=>{const n=C.fromDom(e.getBody());jW(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),GW(e),e.readonly=!0,dl(n,!1),qW(n)):(e.readonly=!1,dl(n,!0),KW(n),xd(e,"StyleWithCSS",!1),xd(e,"enableInlineTableEditing",!1),xd(e,"enableObjectResizing",!1),IT(e)&&e.focus(),YW(e),e.nodeChanged())},to=e=>e.readonly,s0=e=>{e.parser.addAttributeFilter("contenteditable",t=>{to(e)&&B(t,n=>{n.attr(eo,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(eo,t=>{to(e)&&B(t,n=>{n.attr("contenteditable",n.attr(eo))})}),e.serializer.addTempAttr(eo)},QW=e=>{e.serializer?s0(e):e.on("PreInit",()=>{s0(e)})},ZW=e=>e.type==="click",JW=["copy"],e8=e=>De(JW,e.type),t8=(e,t)=>Bs(t,"a",s=>Ae(s,C.fromDom(e.getBody()))).bind(s=>po(s,"href")),n8=(e,t)=>{if(ZW(t)&&!G.metaKeyPressed(t)){const n=C.fromDom(t.target);t8(e,n).each(s=>{if(t.preventDefault(),/^#/.test(s)){const o=e.dom.select(`${s},[name="${J0(s,"#")}"]`);o.length&&e.selection.scrollIntoView(o[0],!0)}else window.open(s,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else e8(t)&&e.dispatch(t.type,t)},s8=e=>{e.on("ShowCaret",t=>{to(e)&&t.preventDefault()}),e.on("ObjectSelected",t=>{to(e)&&t.preventDefault()})},o8=D.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class Nd{constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||Le}static isNative(t){return!!o8[t.toLowerCase()]}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){const s=t.toLowerCase(),o=dc(s,n!=null?n:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const r=this.bindings[s];if(r)for(let a=0,i=r.length;a<i;a++){const l=r[a];if(!l.removed){if(l.once&&this.off(s,l.func),o.isImmediatePropagationStopped())return o;if(l.func.call(this.scope,o)===!1)return o.preventDefault(),o}}return o}on(t,n,s,o){if(n===!1&&(n=Le),n){const r={func:n,removed:!1};o&&D.extend(r,o);const a=t.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),s?c=[r,...c]:c=[...c,r],this.bindings[l]=c}}return this}off(t,n){if(t){const s=t.toLowerCase().split(" ");let o=s.length;for(;o--;){const r=s[o];let a=this.bindings[r];if(!r)return Pe(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(!n)a.length=0;else{const i=sr(a,l=>l.func===n);a=i.fail,this.bindings[r]=a,B(i.pass,l=>{l.removed=!0})}a.length||(this.toggleEvent(t,!1),delete this.bindings[r])}}}else Pe(this.bindings,(s,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(t,n,s){return this.on(t,n,s,{once:!0})}has(t){return t=t.toLowerCase(),!(!this.bindings[t]||this.bindings[t].length===0)}}const pa=e=>(e._eventDispatcher||(e._eventDispatcher=new Nd({scope:e,toggleEvent:(t,n)=>{Nd.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),_d={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){const s=this;if(s.removed&&e!=="remove"&&e!=="detach")return dc(e.toLowerCase(),t!=null?t:{},s);const o=pa(s).dispatch(e,t);if(n!==!1&&s.parent){let r=s.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(e,o,!1),r=r.parent()}return o},on(e,t,n){return pa(this).on(e,t,n)},off(e,t){return pa(this).off(e,t)},once(e,t){return pa(this).once(e,t)},hasEventListeners(e){return pa(this).has(e)}},ml=Re.DOM;let no;const gl=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;const n=_p(e);return n?(e.eventRoot||(e.eventRoot=ml.select(n)[0]),e.eventRoot):e.getBody()},r8=e=>!e.hidden&&!to(e),o0=(e,t,n)=>{r8(e)?e.dispatch(t,n):to(e)&&n8(e,n)},r0=(e,t)=>{let n;if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const s=gl(e,t);if(_p(e)){if(no||(no={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||no&&(Pe(no,(o,r)=>{e.dom.unbind(gl(e,r))}),no=null)})),no[t])return;n=o=>{const r=o.target,a=e.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===r||ml.isChildOf(r,l))&&o0(a[i],t,o)}},no[t]=n,ml.bind(s,t,n)}else n=o=>{o0(e,t,o)},ml.bind(s,t,n),e.delegates[t]=n},a0={..._d,bindPendingEventDelegates(){const e=this;D.each(e._pendingNativeEvents,t=>{r0(e,t)})},toggleNativeEvent(e,t){const n=this;e==="focus"||e==="blur"||n.removed||(t?n.initialized?r0(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&(n.dom.unbind(gl(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Pe(e.delegates,(s,o)=>{e.dom.unbind(gl(e,o),o,s)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},a8=e=>ne(e)?{value:e.split(/[ ,]/),valid:!0}:ao(e,ne)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},i8=e=>{const t=(()=>{switch(e){case"array":return Ge;case"boolean":return Ss;case"function":return _e;case"number":return yn;case"object":return Ot;case"string":return ne;case"string[]":return a8;case"object[]":return n=>ao(n,Ot);case"regexp":return n=>ba(n,RegExp)}})();return n=>Ad(n,t,`The value must be a ${e}.`)},l8=e=>ne(e.processor),i0=(e,t)=>{const n=va(t.message)?"":`. ${t.message}`;return e+n},l0=e=>e.valid,Ad=(e,t,n="")=>{const s=t(e);return Ss(s)?s?{value:e,valid:!0}:{valid:!1,message:n}:s},c8=(e,t,n)=>{if(!kt(t)){const s=Ad(t,n);if(l0(s))return s.value;console.error(i0(`Invalid default value passed for the "${e}" option`,s))}},u8=(e,t)=>{const n={},s={},o=(f,m,g)=>{const h=Ad(m,g);return l0(h)?(s[f]=h.value,!0):(console.warn(i0(`Invalid value passed for the ${f} option`,h)),!1)},r=(f,m)=>{const g=l8(m)?i8(m.processor):m.processor,h=c8(f,m.default,g);n[f]={...m,default:h,processor:g},Te(s,f).orThunk(()=>Te(t,f)).each(b=>o(f,b,g))},a=f=>fe(n,f);return{register:r,isRegistered:a,get:f=>Te(s,f).orThunk(()=>Te(n,f).map(m=>m.default)).getOrUndefined(),set:(f,m)=>{if(a(f)){const g=n[f];return g.immutable?(console.error(`"${f}" is an immutable option and cannot be updated`),!1):o(f,m,g.processor)}else return console.warn(`"${f}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:f=>{const m=a(f);return m&&delete s[f],m},isSet:f=>fe(s,f)}},f8=["design","readonly"],c0=(e,t,n,s)=>{const o=n[t.get()],r=n[s];try{r.activate()}catch(a){console.error(`problem while activating editor mode ${s}:`,a);return}o.deactivate(),o.editorReadOnly!==r.editorReadOnly&&XW(e,r.editorReadOnly),t.set(s),ZA(e,s)},d8=(e,t,n,s)=>{if(s!==n.get()){if(!fe(t,s))throw new Error(`Editor mode '${s}' is invalid`);e.initialized?c0(e,n,t,s):e.on("init",()=>c0(e,n,t,s))}},m8=(e,t,n)=>{if(De(f8,t))throw new Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(s){console.error(`problem while deactivating editor mode ${t}:`,s)}}}}},g8=e=>{const t=Qe("design"),n=Qe({design:{activate:me,deactivate:me,editorReadOnly:!1},readonly:{activate:me,deactivate:me,editorReadOnly:!0}});return QW(e),s8(e),{isReadOnly:()=>to(e),set:s=>d8(e,n.get(),t,s),get:()=>t.get(),register:(s,o)=>{n.set(m8(n.get(),s,o))}}},Rd=D.each,Td=D.explode,p8={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},u0=D.makeMap("alt,ctrl,shift,meta,access"),h8=e=>{let t;const n={},s=Se.os.isMacOS()||Se.os.isiOS();Rd(Td(e.toLowerCase(),"+"),r=>{r in u0?n[r]=!0:/^[0-9]{2,}$/.test(r)?n.keyCode=parseInt(r,10):(n.charCode=r.charCodeAt(0),n.keyCode=p8[r]||r.toUpperCase().charCodeAt(0))});const o=[n.keyCode];for(t in u0)n[t]?o.push(t):n[t]=!1;return n.id=o.join(","),n.access&&(n.alt=!0,s?n.ctrl=!0:n.shift=!0),n.meta&&(s?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n};class f0{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;const n=this;t.on("keyup keypress keydown",s=>{(n.hasModifier(s)||n.isFunctionKey(s))&&!s.isDefaultPrevented()&&(Rd(n.shortcuts,o=>{if(n.matchShortcut(s,o))return n.pendingPatterns=o.subpatterns.slice(0),s.type==="keydown"&&n.executeShortcutAction(o),!0}),n.matchShortcut(s,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&s.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,s,o){const r=this,a=r.normalizeCommandFunc(s);return Rd(Td(D.trim(t)),i=>{const l=r.createShortcut(i,n,a,o);r.shortcuts[l.id]=l}),!0}remove(t){const n=this.createShortcut(t);return this.shortcuts[n.id]?(delete this.shortcuts[n.id],!0):!1}normalizeCommandFunc(t){const n=this,s=t;return typeof s=="string"?()=>{n.editor.execCommand(s,!1,null)}:D.isArray(s)?()=>{n.editor.execCommand(s[0],s[1],s[2])}:s}createShortcut(t,n,s,o){const r=D.map(Td(t,">"),h8);return r[r.length-1]=D.extend(r[r.length-1],{func:s,scope:o||this.editor}),D.extend(r[0],{desc:this.editor.translate(n),subpatterns:r.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!n||n.ctrl!==t.ctrlKey||n.meta!==t.metaKey||n.alt!==t.altKey||n.shift!==t.shiftKey?!1:t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode?(t.preventDefault(),!0):!1}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}const b8=()=>{const e={},t={},n={},s={},o={},r={},a={},i=(c,u)=>(f,m)=>c[f.toLowerCase()]={...m,type:u},l=(c,u)=>s[c.toLowerCase()]=u;return{addButton:i(e,"button"),addGroupToolbarButton:i(e,"grouptoolbarbutton"),addToggleButton:i(e,"togglebutton"),addMenuButton:i(e,"menubutton"),addSplitButton:i(e,"splitbutton"),addMenuItem:i(t,"menuitem"),addNestedMenuItem:i(t,"nestedmenuitem"),addToggleMenuItem:i(t,"togglemenuitem"),addAutocompleter:i(n,"autocompleter"),addContextMenu:i(o,"contextmenu"),addContextToolbar:i(r,"contexttoolbar"),addContextForm:i(r,"contextform"),addSidebar:i(a,"sidebar"),addIcon:l,getAll:()=>({buttons:e,menuItems:t,icons:s,popups:n,contextMenus:o,contextToolbars:r,sidebars:a})}},C8=()=>{const e=b8();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}},so=Re.DOM,d0=D.extend,y8=D.each;class pl{constructor(t,n,s){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=s,this.documentBaseUrl=s.documentBaseURL,d0(this,a0);const o=this;this.id=t,this.hidden=!1;const r=aW(s.defaultOptions,n);this.options=u8(o,r),kN(o);const a=this.options.get;a("deprecation_warnings")&&AL(n,r);const i=a("suffix");i&&(s.suffix=i),this.suffix=s.suffix;const l=a("base_url");l&&s._setBaseUrl(l),this.baseUri=s.baseURI;const c=_c(o);c&&(Wn.ScriptLoader._setReferrerPolicy(c),Re.DOM.styleSheetLoader._setReferrerPolicy(c)),dt.languageLoad=a("language_load"),dt.baseURL=s.baseURL,this.setDirty(!1),this.documentBaseURI=new un(Cp(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Rc(o),this.shortcuts=new f0(this),this.editorCommands=new n0(this),WW(this);const u=a("cache_suffix");u&&(Se.cacheSuffix=u.replace(/^[\?\&]+/,"")),this.ui={registry:C8(),styleSheetLoader:void 0,show:me,hide:me,setEnabled:me,isEnabled:je},this.mode=g8(o),s.dispatch("SetupEditor",{editor:this});const f=p_(o);_e(f)&&f.call(o,o)}render(){KV(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return qs(this)}translate(t){return on.translate(t)}getParam(t,n,s){const o=this.options;return o.isRegistered(t)||(oe(s)?o.register(t,{processor:s,default:n}):o.register(t,{processor:je,default:n})),!o.isSet(t)&&!kt(n)?n:o.get(t)}hasPlugin(t,n){return De(ja(this),t)?n?Wo.get(t)!==void 0:!0:!1}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,s){this.editorCommands.addCommand(t,n,s)}addQueryStateHandler(t,n,s){this.editorCommands.addQueryStateHandler(t,n,s)}addQueryValueHandler(t,n,s){this.editorCommands.addQueryValueHandler(t,n,s)}addShortcut(t,n,s,o){this.shortcuts.add(t,n,s,o)}execCommand(t,n,s,o){return this.editorCommands.execCommand(t,n,s,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){const t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":(so.show(t.getContainer()),so.hide(t.id)),t.load(),t.dispatch("show"))}hide(){const t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(so.hide(t.getContainer()),so.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t){const n=this;let s=n.getElement(),o;if(n.removed)return"";if(s){t=t||{},t.load=!0;const r=Xl(s)?s.value:s.innerHTML;return o=n.setContent(r,t),t.element=s,t.no_events||n.dispatch("LoadContent",t),t.element=s=null,o}}save(t){const n=this;let s=n.getElement(),o,r;if(!(!s||!n.initialized||n.removed))return t=t||{},t.save=!0,t.element=s,o=t.content=n.getContent(t),t.no_events||n.dispatch("SaveContent",t),t.format==="raw"&&n.dispatch("RawSaveContent",t),o=t.content,Xl(s)?s.value=o:((t.is_removing||!n.inline)&&(s.innerHTML=o),(r=so.getParent(n.id,"form"))&&y8(r.elements,a=>{if(a.name===n.id)return a.value=o,!1})),t.element=s=null,t.set_dirty!==!1&&n.setDirty(!1),o}setContent(t,n){return yf(this,t,n)}getContent(t){return vL(this,t)}insertContent(t,n){n&&(t=d0({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?yf(this,this.startContent,{format:"raw"}):yf(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){const n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){const t=this;return t.container||(t.container=so.get(t.editorContainer||t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=so.get(this.id)),this.targetElm}getWin(){const t=this;let n;return t.contentWindow||(n=t.iframeElement,n&&(t.contentWindow=n.contentWindow)),t.contentWindow}getDoc(){const t=this;let n;return t.contentDocument||(n=t.getWin(),n&&(t.contentDocument=n.document)),t.contentDocument}getBody(){const t=this.getDoc();return this.bodyElement||(t?t.body:null)}convertURL(t,n,s){const o=this,r=o.options.get,a=b_(o);return _e(a)?a.call(o,t,s,!0,n):!r("convert_urls")||s&&s.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0?t:r("relative_urls")?o.documentBaseURI.toRelative(t):(t=o.documentBaseURI.toAbsolute(t,r("remove_script_host")),t)}addVisual(t){iW(this,t)}remove(){DL(this)}destroy(t){BL(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const Qo=Re.DOM,hl=D.each;let m0=!1,bl,Et=[];const Cl=e=>{const t=e.type;hl(ys.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e);break}})},g0=e=>{if(e!==m0){const t=Re.DOM;e?(t.bind(window,"resize",Cl),t.bind(window,"scroll",Cl)):(t.unbind(window,"resize",Cl),t.unbind(window,"scroll",Cl)),m0=e}},p0=e=>{const t=Et;return Et=re(Et,n=>e!==n),ys.activeEditor===e&&(ys.activeEditor=Et.length>0?Et[0]:null),ys.focusedEditor===e&&(ys.focusedEditor=null),t.length!==Et.length},v8=e=>(e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(p0(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0,e=null),e),E8=document.compatMode!=="CSS1Compat",ys={..._d,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"1.0",releaseDate:"2022-06-29",i18n:on,activeEditor:null,focusedEditor:null,setup(){const e=this;let t,n,s="";n=un.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));const o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,s=o.suffix;else{const r=document.getElementsByTagName("script");for(let a=0;a<r.length;a++){const i=r[a].src||"";if(i==="")continue;const l=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){l.indexOf(".min")!==-1&&(s=".min"),t=i.substring(0,i.lastIndexOf("/"));break}}if(!t&&document.currentScript){const a=document.currentScript.src;a.indexOf(".min")!==-1&&(s=".min"),t=a.substring(0,a.lastIndexOf("/"))}}e.baseURL=new un(n).toAbsolute(t),e.documentBaseURL=n,e.baseURI=new un(e.baseURL),e.suffix=s,RT(e)},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;e.suffix&&(this.suffix=n),this.defaultOptions=e;const s=e.plugin_base_urls;s!==void 0&&Pe(s,(o,r)=>{dt.PluginManager.urls[r]=o})},init(e){const t=this;let n;const s=D.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(u,f)=>u.inline&&f.tagName.toLowerCase()in s,r=u=>{let f=u.id;return f||(f=Te(u,"name").filter(m=>!Qo.get(m)).getOrThunk(Qo.uniqueId),u.setAttribute("id",f)),f},a=u=>{const f=e[u];if(!!f)return f.apply(t,[])},i=u=>Se.browser.isIE()||Se.browser.isEdge()?(Fi("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):E8?(Fi("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):ne(u.selector)?Qo.select(u.selector):oe(u.target)?[u.target]:[];let l=u=>{n=u};const c=()=>{let u=0;const f=[];let m;const g=(h,p,b)=>{const y=new pl(h,p,t);f.push(y),y.on("init",()=>{++u===m.length&&l(f)}),y.targetElm=y.targetElm||b,y.render()};Qo.unbind(window,"ready",c),a("onpageload"),m=M0(i(e)),D.each(m,h=>{v8(t.get(h.id))}),m=D.grep(m,h=>!t.get(h.id)),m.length===0?l([]):hl(m,h=>{o(e,h)?Fi("Could not initialize inline editor on invalid inline target element",h):g(r(h),e,h)})};return Qo.bind(window,"ready",c),new Promise(u=>{n?u(n):l=f=>{u(f)}})},get(e){return arguments.length===0?Et.slice(0):ne(e)?Ye(Et,t=>t.id===e).getOr(null):yn(e)&&Et[e]?Et[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(n===null&&Et.push(e),g0(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),bl||(bl=s=>{const o=t.dispatch("BeforeUnload");if(o.returnValue)return s.preventDefault(),s.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",bl))),e},createEditor(e,t){return this.add(new pl(e,t,this))},remove(e){const t=this;let n,s;if(!e){for(n=Et.length-1;n>=0;n--)t.remove(Et[n]);return}if(ne(e)){hl(Qo.select(e),o=>{s=t.get(o.id),s&&t.remove(s)});return}return s=e,tr(t.get(s.id))?null:(p0(s)&&t.dispatch("RemoveEditor",{editor:s}),Et.length===0&&window.removeEventListener("beforeunload",bl),s.remove(),g0(Et.length>0),s)},execCommand(e,t,n){var s;const o=this,r=Ot(n)?(s=n.id)!==null&&s!==void 0?s:n.index:n;switch(e){case"mceAddEditor":{if(!o.get(r)){const a=n.options;new pl(r,a,o).render()}return!0}case"mceRemoveEditor":{const a=o.get(r);return a&&a.remove(),!0}case"mceToggleEditor":{const a=o.get(r);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return o.activeEditor?o.activeEditor.execCommand(e,t,n):!1},triggerSave:()=>{hl(Et,e=>{e.save()})},addI18n:(e,t)=>{on.add(e,t)},translate:e=>on.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new un(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new un(this.baseURL)}};ys.setup();const S8=(()=>{const e=cs(),t=r=>({items:r,types:Xt(r),getType:a=>Te(r,a).getOrUndefined()}),n=r=>{e.set(r)},s=()=>e.get().getOrUndefined(),o=e.clear;return{FakeClipboardItem:t,write:n,read:s,clear:o}})(),h0=Math.min,Zo=Math.max,yl=Math.round,b0=(e,t,n)=>{let s=t.x,o=t.y;const r=e.w,a=e.h,i=t.w,l=t.h,c=(n||"").split("");return c[0]==="b"&&(o+=l),c[1]==="r"&&(s+=i),c[0]==="c"&&(o+=yl(l/2)),c[1]==="c"&&(s+=yl(i/2)),c[3]==="b"&&(o-=a),c[4]==="r"&&(s-=r),c[3]==="c"&&(o-=yl(a/2)),c[4]==="c"&&(s-=yl(r/2)),Jo(s,o,r,a)},w8=(e,t,n,s)=>{let o,r;for(r=0;r<s.length;r++)if(o=b0(e,t,s[r]),o.x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return s[r];return null},k8=(e,t,n)=>Jo(e.x-t,e.y-n,e.w+t*2,e.h+n*2),x8=(e,t)=>{const n=Zo(e.x,t.x),s=Zo(e.y,t.y),o=h0(e.x+e.w,t.x+t.w),r=h0(e.y+e.h,t.y+t.h);return o-n<0||r-s<0?null:Jo(n,s,o-n,r-s)},N8=(e,t,n)=>{let s=e.x,o=e.y,r=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,l=t.y+t.h,c=Zo(0,t.x-s),u=Zo(0,t.y-o),f=Zo(0,r-i),m=Zo(0,a-l);return s+=c,o+=u,n&&(r+=c,a+=u,s-=f,o-=m),r-=f,a-=m,Jo(s,o,r-s,a-o)},Jo=(e,t,n,s)=>({x:e,y:t,w:n,h:s}),_8={inflate:k8,relativePosition:b0,findBestRelativePosition:w8,intersect:x8,clamp:N8,create:Jo,fromClientRect:e=>Jo(e.left,e.top,e.width,e.height)},A8=(e,t,n=1e3)=>{let s=!1,o=null;const r=c=>(...u)=>{s||(s=!0,o!==null&&(clearTimeout(o),o=null),c.apply(null,u))},a=r(e),i=r(t);return{start:(...c)=>{!s&&o===null&&(o=setTimeout(()=>i.apply(null,c),n))},resolve:a,reject:i}},R8=(()=>{const e={},t={};return{load:(r,a)=>{const i=`Script at URL "${a}" failed to load`,l=`Script at URL "${a}" did not call \`tinymce.Resource.add('${r}', data)\` within 1 second`;if(e[r]!==void 0)return e[r];{const c=new Promise((u,f)=>{const m=A8(u,f);t[r]=m.resolve,Wn.ScriptLoader.loadScript(a).then(()=>m.start(l),()=>m.reject(i))});return e[r]=c,c}},add:(r,a)=>{t[r]!==void 0&&(t[r](a),delete t[r]),e[r]=Promise.resolve(a)},unload:r=>{delete e[r]}}})(),T8=()=>(()=>{let e={},t=[];const n={getItem:s=>{const o=e[s];return o||null},setItem:(s,o)=>{t.push(s),e[s]=String(o)},key:s=>t[s],removeItem:s=>{t=t.filter(o=>o===s),delete e[s]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})();let ha;try{const e="__storage_test__";ha=window.localStorage,ha.setItem(e,e),ha.removeItem(e)}catch{ha=T8()}var P8=ha;const D8={geom:{Rect:_8},util:{Delay:qt,Tools:D,VK:G,URI:un,EventDispatcher:Nd,Observable:_d,I18n:on,LocalStorage:P8,ImageUploader:dI},dom:{EventUtils:Ls,TreeWalker:Ve,TextSeeker:Fs,DOMUtils:Re,ScriptLoader:Wn,RangeUtils:Mo,Serializer:ky,StyleSheetLoader:cg,ControlSelection:Lh,BookmarkManager:Wr,Selection:wy,Event:Ls.Event},html:{Styles:fc,Entities:as,Node:vt,Schema:ls,DomParser:Ho,Writer:yb,Serializer:ms},Env:Se,AddOnManager:dt,Annotator:Ah,Formatter:Ly,UndoManager:Fy,EditorCommands:n0,WindowManager:Ay,NotificationManager:_y,EditorObservable:a0,Shortcuts:f0,Editor:pl,FocusManager:rb,EditorManager:ys,DOM:Re.DOM,ScriptLoader:Wn.ScriptLoader,PluginManager:Wo,ThemeManager:Zs,ModelManager:Vo,IconManager:Li,Resource:R8,FakeClipboard:S8,trim:D.trim,isArray:D.isArray,is:D.is,toArray:D.toArray,makeMap:D.makeMap,each:D.each,map:D.map,grep:D.grep,inArray:D.inArray,extend:D.extend,walk:D.walk,resolve:D.resolve,explode:D.explode,_addCacheSuffix:D._addCacheSuffix},C0=D.extend(ys,D8),B8=e=>{try{x0.exports=e}catch{}};(e=>{window.tinymce=e,window.tinyMCE=e})(C0),B8(C0)})()})(I8);export{w6 as c};
