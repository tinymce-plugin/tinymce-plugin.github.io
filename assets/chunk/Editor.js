import"./pinia.js";import{M,H as P,v as A,z as b,a4 as T,ah as B,ai as L,aj as U,O as S,G as _}from"./vue.js";var z=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],F=function(n){return z.map(function(t){return t.toLowerCase()}).indexOf(n.toLowerCase())!==-1},R=function(n,t,e){Object.keys(t).filter(F).forEach(function(o){var i=t[o];typeof i=="function"&&(o==="onInit"?i(n,e):e.on(o.substring(2),function(r){return i(r,e)}))})},K=function(n,t,e,o){var i=n.modelEvents?n.modelEvents:null,r=Array.isArray(i)?i.join(" "):i;e.on(r||"input  focus focusin click focusout drop ObjectResized keydown paste ExecCommand ObjectSelected",function(){t.emit("update:modelValue",typeof e.getTpContent=="function"?e.getTpContent({format:n.outputFormat}):e.getContent({format:n.outputFormat}))}),tinymce.tinymcePlugin&&q(function(c){typeof e.getTpContent=="function"&&(c(),t.emit("update:modelValue",e.getTpContent({format:n.outputFormat})),t.emit("update:modelValue",e.getTpContent({format:n.outputFormat})))},50)},N=function(n,t,e,o,i,r){o.setContent(r()),e.attrs["onUpdate:modelValue"]&&K(t,e,o),R(n,e.attrs,o)},E=0,w=function(n){var t=Date.now(),e=Math.floor(Math.random()*1e9);return E++,n+"_"+e+E+String(t)},k=function(n){return n!==null&&n.tagName.toLowerCase()==="textarea"},I=function(n){return typeof n=="undefined"||n===""?[]:Array.isArray(n)?n:n.split(" ")},G=function(n,t){return I(n).concat(I(t))},H=function(n){return n==null},q=function(n,t,e){!e&&(e=t*1e3);var o={id:null,outTime:e,outId:null};o.id=setInterval(function(i){n(function(){clearTimeout(i.outId),clearInterval(i.id)})},t,o),o.outId=setTimeout(function(){o.id&&clearInterval(o.id)},o.outTime)},O=function(){return{listeners:[],scriptId:w("tiny-script"),scriptLoaded:!1}},W=function(){var n=O(),t=function(i,r,c,d){var a=r.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=i,a.src=c;var s=function(){a.removeEventListener("load",s),d()};a.addEventListener("load",s),r.head&&r.head.appendChild(a)},e=function(i,r,c){n.scriptLoaded?c():(n.listeners.push(c),i.getElementById(n.scriptId)||t(n.scriptId,i,r,function(){n.listeners.forEach(function(d){return d()}),n.scriptLoaded=!0}))},o=function(){n=O()};return{load:e,reinitialize:o}},J=W(),Q=function(){return typeof window!="undefined"?window:global},f=function(){var n=Q();return n&&n.tinymce?n.tinymce:null},X={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(n){return n==="html"||n==="text"}}},m=globalThis&&globalThis.__assign||function(){return m=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},m.apply(this,arguments)},Y={min_height:300,plugins:["code hr"],toolbar:["code hr"],schema:"html5",table_default_attributes:{border:"1"},table_default_styles:{"border-collapse":"collapse",width:"100%"},table_header_type:"sectionCells",table_responsive_width:!0,file_picker_types:"file img media",fontsize_formats:"12px 14px 16px 18px 24px 36px 48px 56px 72px"},Z=function(n,t,e,o){return n(o||"div",{id:t,ref:e})},$=function(n,t,e){return n("textarea",{id:t,visibility:"hidden",ref:e})},tn=M({props:X,setup:function(n,t){var e=n.init?Object.assign(Y,n.init):{},o=P(n),i=o.disabled,r=o.modelValue,c=o.tagName,d=A(null),a=null,s=n.id||w("tiny-vue"),p=n.init&&n.init.inline||n.inline,h=!!t.attrs["onUpdate:modelValue"],C=!0,D=n.initialValue?n.initialValue:"",y="",V=function(u){return h?function(){return r!=null&&r.value?r.value:""}:function(){return u?D:y}},g=function(){var u=V(C),l=m(m({},e),{readonly:n.disabled,selector:"#"+s,plugins:G(e.plugins,n.plugins),toolbar:n.toolbar||e.toolbar,inline:p,setup:function(v){a=v,v.on("init",function(x){return N(x,n,t,v,r,u)}),typeof e.setup=="function"&&e.setup(v)}});k(d.value)&&(d.value.style.visibility=""),f().init(l),C=!1};b(i,function(u){var l;a!==null&&(typeof((l=a.mode)===null||l===void 0?void 0:l.set)=="function"?a.mode.set(u?"readonly":"design"):a.setMode(u?"readonly":"design"))}),b(c,function(u){var l;h||(y=a.getContent()),(l=f())===null||l===void 0||l.remove(a),_(function(){return g()})}),T(function(){if(f()!==null)g();else if(d.value&&d.value.ownerDocument){var u=n.cloudChannel?n.cloudChannel:"6",l=n.apiKey?n.apiKey:"no-api-key",v=H(n.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+l+"/tinymce/"+u+"/tinymce.min.js":n.tinymceScriptSrc;J.load(d.value.ownerDocument,v,g)}}),B(function(){f()!==null&&f().remove(a)}),p||(L(function(){C||g()}),U(function(){var u;h||(y=a.getContent()),(u=f())===null||u===void 0||u.remove(a)}));var j=function(u){var l;y=a.getContent(),(l=f())===null||l===void 0||l.remove(a),e=m(m({},e),u),_(function(){return g()})};return t.expose({rerender:j}),function(){return p?Z(S,s,d,n.tagName):$(S,s,d)}}});export{tn as E};
